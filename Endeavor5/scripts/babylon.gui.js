!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-gui",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-gui"]=t(require("babylonjs")):(n.BABYLON=n.BABYLON||{},n.BABYLON.GUI=t(n.BABYLON))}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,function(n){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=2)}([function(t){t.exports=n},function(n,t,i){"use strict";function e(n,t){function i(){this.constructor=n}ft(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function c(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u}var ft,bt,lt,g;i.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
ft=function(n,t){return(ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)};var k,r=i(0),f=function(){function n(t,i,r){void 0===i&&(i=n.UNITMODE_PIXEL);void 0===r&&(r=!0);this.unit=i;this.negativeValueAllowed=r;this._value=1;this.ignoreAdaptiveScaling=!1;this._value=t;this._originalUnit=i}return Object.defineProperty(n.prototype,"isPercentage",{get:function(){return this.unit===n.UNITMODE_PERCENTAGE},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isPixel",{get:function(){return this.unit===n.UNITMODE_PIXEL},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"internalValue",{get:function(){return this._value},enumerable:!0,configurable:!0}),n.prototype.getValueInPixel=function(n,t){return this.isPixel?this.getValue(n):this.getValue(n)*t},n.prototype.updateInPlace=function(t,i){return void 0===i&&(i=n.UNITMODE_PIXEL),this._value=t,this.unit=i,this},n.prototype.getValue=function(t){if(t&&!this.ignoreAdaptiveScaling&&this.unit!==n.UNITMODE_PERCENTAGE){var i=0,r=0;if(t.idealWidth&&(i=this._value*t.getSize().width/t.idealWidth),t.idealHeight&&(r=this._value*t.getSize().height/t.idealHeight),t.useSmallestIdeal&&t.idealWidth&&t.idealHeight)return window.innerWidth<window.innerHeight?i:r;if(t.idealWidth)return i;if(t.idealHeight)return r}return this._value},n.prototype.toString=function(t,i){var r,u;switch(this.unit){case n.UNITMODE_PERCENTAGE:return r=100*this.getValue(t),(i?r.toFixed(i):r)+"%";case n.UNITMODE_PIXEL:return u=this.getValue(t),(i?u.toFixed(i):u)+"px"}return this.unit.toString()},n.prototype.fromString=function(t){var r=n._Regex.exec(t.toString()),i,u;if(!r||0===r.length)return!1;if(i=parseFloat(r[1]),u=this._originalUnit,this.negativeValueAllowed||i<0&&(i=0),4===r.length)switch(r[3]){case"px":u=n.UNITMODE_PIXEL;break;case"%":u=n.UNITMODE_PERCENTAGE;i/=100}return(i!==this._value||u!==this.unit)&&(this._value=i,this.unit=u,!0)},Object.defineProperty(n,"UNITMODE_PERCENTAGE",{get:function(){return n._UNITMODE_PERCENTAGE},enumerable:!0,configurable:!0}),Object.defineProperty(n,"UNITMODE_PIXEL",{get:function(){return n._UNITMODE_PIXEL},enumerable:!0,configurable:!0}),n._Regex=/(^-?\d*(\.\d+)?)(%|px)?/,n._UNITMODE_PERCENTAGE=0,n._UNITMODE_PIXEL=1,n}(),s=function(){function n(n,t,i,r){this.left=n;this.top=t;this.width=i;this.height=r}return n.prototype.copyFrom=function(n){this.left=n.left;this.top=n.top;this.width=n.width;this.height=n.height},n.prototype.copyFromFloats=function(n,t,i,r){this.left=n;this.top=t;this.width=i;this.height=r},n.CombineToRef=function(n,t,i){var r=Math.min(n.left,t.left),u=Math.min(n.top,t.top),f=Math.max(n.left+n.width,t.left+t.width),e=Math.max(n.top+n.height,t.top+t.height);i.left=r;i.top=u;i.width=f-r;i.height=e-u},n.prototype.transformToRef=function(n,t){for(var f=r.Polygon.Rectangle(this.left,this.top,this.left+this.width,this.top+this.height),u=new r.Vector2(Number.MAX_VALUE,Number.MAX_VALUE),e=new r.Vector2(0,0),i=0;i<4;i++)n.transformCoordinates(f[i].x,f[i].y,f[i]),u.x=Math.floor(Math.min(u.x,f[i].x)),u.y=Math.floor(Math.min(u.y,f[i].y)),e.x=Math.ceil(Math.max(e.x,f[i].x)),e.y=Math.ceil(Math.max(e.y,f[i].y));t.left=u.x;t.top=u.y;t.width=e.x-u.x;t.height=e.y-u.y},n.prototype.isEqualsTo=function(n){return this.left===n.left&&this.top===n.top&&this.width===n.width&&this.height===n.height},n.Empty=function(){return new n(0,0,0,0)},n}(),nt=function(n){function t(t,i){void 0===i&&(i=0);var r=n.call(this,t.x,t.y)||this;return r.buttonIndex=i,r}return e(t,n),t}(r.Vector2),tt=function(){function n(n,t,i,r,u,f){this.m=new Float32Array(6);this.fromValues(n,t,i,r,u,f)}return n.prototype.fromValues=function(n,t,i,r,u,f){return this.m[0]=n,this.m[1]=t,this.m[2]=i,this.m[3]=r,this.m[4]=u,this.m[5]=f,this},n.prototype.determinant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]},n.prototype.invertToRef=function(n){var i=this.m[0],u=this.m[1],f=this.m[2],e=this.m[3],o=this.m[4],s=this.m[5],h=this.determinant();if(h<r.Epsilon*r.Epsilon)return n.m[0]=0,n.m[1]=0,n.m[2]=0,n.m[3]=0,n.m[4]=0,n.m[5]=0,this;var t=1/h,c=f*s-e*o,l=u*o-i*s;return n.m[0]=e*t,n.m[1]=-u*t,n.m[2]=-f*t,n.m[3]=i*t,n.m[4]=c*t,n.m[5]=l*t,this},n.prototype.multiplyToRef=function(n,t){var e=this.m[0],o=this.m[1],s=this.m[2],h=this.m[3],c=this.m[4],l=this.m[5],i=n.m[0],r=n.m[1],u=n.m[2],f=n.m[3],a=n.m[4],v=n.m[5];return t.m[0]=e*i+o*u,t.m[1]=e*r+o*f,t.m[2]=s*i+h*u,t.m[3]=s*r+h*f,t.m[4]=c*i+l*u+a,t.m[5]=c*r+l*f+v,this},n.prototype.transformCoordinates=function(n,t,i){return i.x=n*this.m[0]+t*this.m[2]+this.m[4],i.y=n*this.m[1]+t*this.m[3]+this.m[5],this},n.Identity=function(){return new n(1,0,0,1,0,0)},n.TranslationToRef=function(n,t,i){i.fromValues(1,0,0,1,n,t)},n.ScalingToRef=function(n,t,i){i.fromValues(n,0,0,t,0,0)},n.RotationToRef=function(n,t){var i=Math.sin(n),r=Math.cos(n);t.fromValues(r,i,-i,r,0,0)},n.ComposeToRef=function(t,i,r,u,f,e,o){n.TranslationToRef(t,i,n._TempPreTranslationMatrix);n.ScalingToRef(u,f,n._TempScalingMatrix);n.RotationToRef(r,n._TempRotationMatrix);n.TranslationToRef(-t,-i,n._TempPostTranslationMatrix);n._TempPreTranslationMatrix.multiplyToRef(n._TempScalingMatrix,n._TempCompose0);n._TempCompose0.multiplyToRef(n._TempRotationMatrix,n._TempCompose1);e?(n._TempCompose1.multiplyToRef(n._TempPostTranslationMatrix,n._TempCompose2),n._TempCompose2.multiplyToRef(e,o)):n._TempCompose1.multiplyToRef(n._TempPostTranslationMatrix,o)},n._TempPreTranslationMatrix=n.Identity(),n._TempPostTranslationMatrix=n.Identity(),n._TempRotationMatrix=n.Identity(),n._TempScalingMatrix=n.Identity(),n._TempCompose0=n.Identity(),n._TempCompose1=n.Identity(),n._TempCompose2=n.Identity(),n}(),u=function(){function n(t){this.name=t;this._alpha=1;this._alphaSet=!1;this._zIndex=0;this._currentMeasure=s.Empty();this._fontFamily="Arial";this._fontStyle="";this._fontWeight="";this._fontSize=new f(18,f.UNITMODE_PIXEL,!1);this._width=new f(1,f.UNITMODE_PERCENTAGE,!1);this._height=new f(1,f.UNITMODE_PERCENTAGE,!1);this._color="";this._style=null;this._horizontalAlignment=n.HORIZONTAL_ALIGNMENT_CENTER;this._verticalAlignment=n.VERTICAL_ALIGNMENT_CENTER;this._isDirty=!0;this._wasDirty=!1;this._tempParentMeasure=s.Empty();this._prevCurrentMeasureTransformedIntoGlobalSpace=s.Empty();this._cachedParentMeasure=s.Empty();this._paddingLeft=new f(0);this._paddingRight=new f(0);this._paddingTop=new f(0);this._paddingBottom=new f(0);this._left=new f(0);this._top=new f(0);this._scaleX=1;this._scaleY=1;this._rotation=0;this._transformCenterX=.5;this._transformCenterY=.5;this._transformMatrix=tt.Identity();this._invertTransformMatrix=tt.Identity();this._transformedPosition=r.Vector2.Zero();this._isMatrixDirty=!0;this._isVisible=!0;this._isHighlighted=!1;this._fontSet=!1;this._dummyVector2=r.Vector2.Zero();this._downCount=0;this._enterCount=-1;this._doNotRender=!1;this._downPointerIds={};this._isEnabled=!0;this._disabledColor="#9a9a9a";this._rebuildLayout=!1;this._isClipped=!1;this.metadata=null;this.isHitTestVisible=!0;this.isPointerBlocker=!1;this.isFocusInvisible=!1;this.clipChildren=!0;this.clipContent=!0;this.useBitmapCache=!1;this._shadowOffsetX=0;this._shadowOffsetY=0;this._shadowBlur=0;this._shadowColor="black";this.hoverCursor="";this._linkOffsetX=new f(0);this._linkOffsetY=new f(0);this.onPointerMoveObservable=new r.Observable;this.onPointerOutObservable=new r.Observable;this.onPointerDownObservable=new r.Observable;this.onPointerUpObservable=new r.Observable;this.onPointerClickObservable=new r.Observable;this.onPointerEnterObservable=new r.Observable;this.onDirtyObservable=new r.Observable;this.onBeforeDrawObservable=new r.Observable;this.onAfterDrawObservable=new r.Observable;this._tmpMeasureA=new s(0,0,0,0)}return Object.defineProperty(n.prototype,"shadowOffsetX",{get:function(){return this._shadowOffsetX},set:function(n){this._shadowOffsetX!==n&&(this._shadowOffsetX=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shadowOffsetY",{get:function(){return this._shadowOffsetY},set:function(n){this._shadowOffsetY!==n&&(this._shadowOffsetY=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shadowBlur",{get:function(){return this._shadowBlur},set:function(n){this._shadowBlur!==n&&(this._shadowBlur=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(n){this._shadowColor!==n&&(this._shadowColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!0,configurable:!0}),n.prototype.getClassName=function(){return this._getTypeName()},Object.defineProperty(n.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontOffset",{get:function(){return this._fontOffset},set:function(n){this._fontOffset=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(n){this._alpha!==n&&(this._alphaSet=!0,this._alpha=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(n){this._isHighlighted!==n&&(this._isHighlighted=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleX",{get:function(){return this._scaleX},set:function(n){this._scaleX!==n&&(this._scaleX=n,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleY",{get:function(){return this._scaleY},set:function(n){this._scaleY!==n&&(this._scaleY=n,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(n){this._rotation!==n&&(this._rotation=n,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"transformCenterY",{get:function(){return this._transformCenterY},set:function(n){this._transformCenterY!==n&&(this._transformCenterY=n,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"transformCenterX",{get:function(){return this._transformCenterX},set:function(n){this._transformCenterX!==n&&(this._transformCenterX=n,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalAlignment",{get:function(){return this._horizontalAlignment},set:function(n){this._horizontalAlignment!==n&&(this._horizontalAlignment=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlignment",{get:function(){return this._verticalAlignment},set:function(n){this._verticalAlignment!==n&&(this._verticalAlignment=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(n){this._width.toString(this._host)!==n&&this._width.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"widthInPixels",{get:function(){return this._width.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(n){isNaN(n)||(this.width=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(n){this._height.toString(this._host)!==n&&this._height.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"heightInPixels",{get:function(){return this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(n){isNaN(n)||(this.height=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontSet?this._fontFamily:""},set:function(n){this._fontFamily!==n&&(this._fontFamily=n,this._resetFontCache())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(n){this._fontStyle!==n&&(this._fontStyle=n,this._resetFontCache())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(n){this._fontWeight!==n&&(this._fontWeight=n,this._resetFontCache())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._style},set:function(n){var t=this;this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null);this._style=n;this._style&&(this._styleObserver=this._style.onChangedObservable.add(function(){t._markAsDirty();t._resetFontCache()}));this._markAsDirty();this._resetFontCache()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_isFontSizeInPercentage",{get:function(){return this._fontSize.isPercentage},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSizeInPixels",{get:function(){var n=this._style?this._style._fontSize:this._fontSize;return n.isPixel?n.getValue(this._host):n.getValueInPixel(this._host,this._tempParentMeasure.height||this._cachedParentMeasure.height)},set:function(n){isNaN(n)||(this.fontSize=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(n){this._fontSize.toString(this._host)!==n&&this._fontSize.fromString(n)&&(this._markAsDirty(),this._resetFontCache())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"color",{get:function(){return this._color},set:function(n){this._color!==n&&(this._color=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"zIndex",{get:function(){return this._zIndex},set:function(n){this.zIndex!==n&&(this._zIndex=n,this.parent&&this.parent._reOrderControl(this))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"notRenderable",{get:function(){return this._doNotRender},set:function(n){this._doNotRender!==n&&(this._doNotRender=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isVisible",{get:function(){return this._isVisible},set:function(n){this._isVisible!==n&&(this._isVisible=n,this._markAsDirty(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linkedMesh",{get:function(){return this._linkedMesh},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingLeft",{get:function(){return this._paddingLeft.toString(this._host)},set:function(n){this._paddingLeft.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingLeftInPixels",{get:function(){return this._paddingLeft.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(n){isNaN(n)||(this.paddingLeft=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingRight",{get:function(){return this._paddingRight.toString(this._host)},set:function(n){this._paddingRight.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingRightInPixels",{get:function(){return this._paddingRight.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(n){isNaN(n)||(this.paddingRight=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingTop",{get:function(){return this._paddingTop.toString(this._host)},set:function(n){this._paddingTop.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingTopInPixels",{get:function(){return this._paddingTop.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(n){isNaN(n)||(this.paddingTop=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingBottom",{get:function(){return this._paddingBottom.toString(this._host)},set:function(n){this._paddingBottom.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paddingBottomInPixels",{get:function(){return this._paddingBottom.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(n){isNaN(n)||(this.paddingBottom=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this._left.toString(this._host)},set:function(n){this._left.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftInPixels",{get:function(){return this._left.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(n){isNaN(n)||(this.left=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this._top.toString(this._host)},set:function(n){this._top.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topInPixels",{get:function(){return this._top.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(n){isNaN(n)||(this.top=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linkOffsetX",{get:function(){return this._linkOffsetX.toString(this._host)},set:function(n){this._linkOffsetX.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linkOffsetXInPixels",{get:function(){return this._linkOffsetX.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(n){isNaN(n)||(this.linkOffsetX=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linkOffsetY",{get:function(){return this._linkOffsetY.toString(this._host)},set:function(n){this._linkOffsetY.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linkOffsetYInPixels",{get:function(){return this._linkOffsetY.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(n){isNaN(n)||(this.linkOffsetY=n+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"centerX",{get:function(){return this._currentMeasure.left+this._currentMeasure.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"centerY",{get:function(){return this._currentMeasure.top+this._currentMeasure.height/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(n){this._isEnabled!==n&&(this._isEnabled=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"disabledColor",{get:function(){return this._disabledColor},set:function(n){this._disabledColor!==n&&(this._disabledColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),n.prototype._getTypeName=function(){return"Control"},n.prototype.getAscendantOfClass=function(n){return this.parent?this.parent.getClassName()===n?this.parent:this.parent.getAscendantOfClass(n):null},n.prototype._resetFontCache=function(){this._fontSet=!0;this._markAsDirty()},n.prototype.isAscendant=function(n){return!!this.parent&&(this.parent===n||this.parent.isAscendant(n))},n.prototype.getLocalCoordinates=function(n){var t=r.Vector2.Zero();return this.getLocalCoordinatesToRef(n,t),t},n.prototype.getLocalCoordinatesToRef=function(n,t){return t.x=n.x-this._currentMeasure.left,t.y=n.y-this._currentMeasure.top,this},n.prototype.getParentLocalCoordinates=function(n){var t=r.Vector2.Zero();return t.x=n.x-this._cachedParentMeasure.left,t.y=n.y-this._cachedParentMeasure.top,t},n.prototype.moveToVector3=function(t,i){if(this._host&&this.parent===this._host._rootContainer){this.horizontalAlignment=n.HORIZONTAL_ALIGNMENT_LEFT;this.verticalAlignment=n.VERTICAL_ALIGNMENT_TOP;var f=this._host._getGlobalViewport(i),u=r.Vector3.Project(t,r.Matrix.Identity(),i.getTransformMatrix(),f);this._moveToProjectedPosition(u);this.notRenderable=u.z<0||u.z>1?!0:!1}else r.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},n.prototype._getDescendants=function(n,t){void 0===t&&(t=!1)},n.prototype.getDescendants=function(n,t){var i=[];return this._getDescendants(i,n,t),i},n.prototype.linkWithMesh=function(t){if(!this._host||this.parent&&this.parent!==this._host._rootContainer)t&&r.Tools.Error("Cannot link a control to a mesh if the control is not at root level");else{var i=this._host._linkedControls.indexOf(this);if(-1!==i)return this._linkedMesh=t,void(t||this._host._linkedControls.splice(i,1));t&&(this.horizontalAlignment=n.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=n.VERTICAL_ALIGNMENT_TOP,this._linkedMesh=t,this._host._linkedControls.push(this))}},n.prototype._moveToProjectedPosition=function(n){var r=this._left.getValue(this._host),u=this._top.getValue(this._host),t=n.x+this._linkOffsetX.getValue(this._host)-this._currentMeasure.width/2,i=n.y+this._linkOffsetY.getValue(this._host)-this._currentMeasure.height/2;this._left.ignoreAdaptiveScaling&&this._top.ignoreAdaptiveScaling&&(Math.abs(t-r)<.5&&(t=r),Math.abs(i-u)<.5&&(i=u));this.left=t+"px";this.top=i+"px";this._left.ignoreAdaptiveScaling=!0;this._top.ignoreAdaptiveScaling=!0;this._markAsDirty()},n.prototype._offsetLeft=function(n){this._isDirty=!0;this._currentMeasure.left+=n},n.prototype._offsetTop=function(n){this._isDirty=!0;this._currentMeasure.top+=n},n.prototype._markMatrixAsDirty=function(){this._isMatrixDirty=!0;this._flagDescendantsAsMatrixDirty()},n.prototype._flagDescendantsAsMatrixDirty=function(){},n.prototype._intersectsRect=function(n){return this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),!(this._tmpMeasureA.left>=n.left+n.width)&&!(this._tmpMeasureA.top>=n.top+n.height)&&!(this._tmpMeasureA.left+this._tmpMeasureA.width<=n.left)&&!(this._tmpMeasureA.top+this._tmpMeasureA.height<=n.top)},n.prototype.invalidateRect=function(){if(this._transform(),this.host&&this.host.useInvalidateRectOptimization)if(this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),s.CombineToRef(this._tmpMeasureA,this._prevCurrentMeasureTransformedIntoGlobalSpace,this._tmpMeasureA),this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var t=this.shadowOffsetX,i=this.shadowOffsetY,n=this.shadowBlur,r=Math.min(Math.min(t,0)-2*n,0),u=Math.max(Math.max(t,0)+2*n,0),f=Math.min(Math.min(i,0)-2*n,0),e=Math.max(Math.max(i,0)+2*n,0);this.host.invalidateRect(Math.floor(this._tmpMeasureA.left+r),Math.floor(this._tmpMeasureA.top+f),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width+u),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height+e))}else this.host.invalidateRect(Math.floor(this._tmpMeasureA.left),Math.floor(this._tmpMeasureA.top),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height))},n.prototype._markAsDirty=function(n){void 0===n&&(n=!1);(this._isVisible||n)&&(this._isDirty=!0,this._host&&this._host.markAsDirty())},n.prototype._markAllAsDirty=function(){this._markAsDirty();this._font&&this._prepareFont()},n.prototype._link=function(n){this._host=n;this._host&&(this.uniqueId=this._host.getScene().getUniqueId())},n.prototype._transform=function(n){if(this._isMatrixDirty||1!==this._scaleX||1!==this._scaleY||0!==this._rotation){var t=this._currentMeasure.width*this._transformCenterX+this._currentMeasure.left,i=this._currentMeasure.height*this._transformCenterY+this._currentMeasure.top;n&&(n.translate(t,i),n.rotate(this._rotation),n.scale(this._scaleX,this._scaleY),n.translate(-t,-i));(this._isMatrixDirty||this._cachedOffsetX!==t||this._cachedOffsetY!==i)&&(this._cachedOffsetX=t,this._cachedOffsetY=i,this._isMatrixDirty=!1,this._flagDescendantsAsMatrixDirty(),tt.ComposeToRef(-t,-i,this._rotation,this._scaleX,this._scaleY,this.parent?this.parent._transformMatrix:null,this._transformMatrix),this._transformMatrix.invertToRef(this._invertTransformMatrix))}},n.prototype._renderHighlight=function(n){this.isHighlighted&&(n.save(),n.strokeStyle="#4affff",n.lineWidth=2,this._renderHighlightSpecific(n),n.restore())},n.prototype._renderHighlightSpecific=function(n){n.strokeRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)},n.prototype._applyStates=function(t){this._isFontSizeInPercentage&&(this._fontSet=!0);this._fontSet&&(this._prepareFont(),this._fontSet=!1);this._font&&(t.font=this._font);this._color&&(t.fillStyle=this._color);n.AllowAlphaInheritance?t.globalAlpha*=this._alpha:this._alphaSet&&(t.globalAlpha=this.parent?this.parent.alpha*this._alpha:this._alpha)},n.prototype._layout=function(n,t){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;if(this._isDirty||!this._cachedParentMeasure.isEqualsTo(n)){this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);t.save();this._applyStates(t);var i=0;do this._rebuildLayout=!1,this._processMeasures(n,t),i++;while(this._rebuildLayout&&i<3);i>=3&&r.Logger.Error("Layout cycle detected in GUI (Control name="+this.name+", uniqueId="+this.uniqueId+")");t.restore();this.invalidateRect();this._evaluateClippingState(n)}return this._wasDirty=this._isDirty,this._isDirty=!1,!0},n.prototype._processMeasures=function(n,t){this._currentMeasure.copyFrom(n);this._preMeasure(n,t);this._measure();this._computeAlignment(n,t);this._currentMeasure.left=0|this._currentMeasure.left;this._currentMeasure.top=0|this._currentMeasure.top;this._currentMeasure.width=0|this._currentMeasure.width;this._currentMeasure.height=0|this._currentMeasure.height;this._additionalProcessing(n,t);this._cachedParentMeasure.copyFrom(n);this.onDirtyObservable.hasObservers()&&this.onDirtyObservable.notifyObservers(this)},n.prototype._evaluateClippingState=function(n){if(this.parent&&this.parent.clipChildren&&(this._currentMeasure.left>n.left+n.width||this._currentMeasure.left+this._currentMeasure.width<n.left||this._currentMeasure.top>n.top+n.height||this._currentMeasure.top+this._currentMeasure.height<n.top))return void(this._isClipped=!0);this._isClipped=!1},n.prototype._measure=function(){this._width.isPixel?this._currentMeasure.width=this._width.getValue(this._host):this._currentMeasure.width*=this._width.getValue(this._host);this._height.isPixel?this._currentMeasure.height=this._height.getValue(this._host):this._currentMeasure.height*=this._height.getValue(this._host)},n.prototype._computeAlignment=function(t){var e=this._currentMeasure.width,o=this._currentMeasure.height,i=t.width,r=t.height,u=0,f=0;switch(this.horizontalAlignment){case n.HORIZONTAL_ALIGNMENT_LEFT:u=0;break;case n.HORIZONTAL_ALIGNMENT_RIGHT:u=i-e;break;case n.HORIZONTAL_ALIGNMENT_CENTER:u=(i-e)/2}switch(this.verticalAlignment){case n.VERTICAL_ALIGNMENT_TOP:f=0;break;case n.VERTICAL_ALIGNMENT_BOTTOM:f=r-o;break;case n.VERTICAL_ALIGNMENT_CENTER:f=(r-o)/2}this._paddingLeft.isPixel?(this._currentMeasure.left+=this._paddingLeft.getValue(this._host),this._currentMeasure.width-=this._paddingLeft.getValue(this._host)):(this._currentMeasure.left+=i*this._paddingLeft.getValue(this._host),this._currentMeasure.width-=i*this._paddingLeft.getValue(this._host));this._currentMeasure.width-=this._paddingRight.isPixel?this._paddingRight.getValue(this._host):i*this._paddingRight.getValue(this._host);this._paddingTop.isPixel?(this._currentMeasure.top+=this._paddingTop.getValue(this._host),this._currentMeasure.height-=this._paddingTop.getValue(this._host)):(this._currentMeasure.top+=r*this._paddingTop.getValue(this._host),this._currentMeasure.height-=r*this._paddingTop.getValue(this._host));this._currentMeasure.height-=this._paddingBottom.isPixel?this._paddingBottom.getValue(this._host):r*this._paddingBottom.getValue(this._host);this._currentMeasure.left+=this._left.isPixel?this._left.getValue(this._host):i*this._left.getValue(this._host);this._currentMeasure.top+=this._top.isPixel?this._top.getValue(this._host):r*this._top.getValue(this._host);this._currentMeasure.left+=u;this._currentMeasure.top+=f},n.prototype._preMeasure=function(){},n.prototype._additionalProcessing=function(){},n.prototype._clipForChildren=function(){},n.prototype._clip=function(t,i){var r;if((t.beginPath(),n._ClipMeasure.copyFrom(this._currentMeasure),i)&&(i.transformToRef(this._invertTransformMatrix,this._tmpMeasureA),r=new s(0,0,0,0),r.left=Math.max(this._tmpMeasureA.left,this._currentMeasure.left),r.top=Math.max(this._tmpMeasureA.top,this._currentMeasure.top),r.width=Math.min(this._tmpMeasureA.left+this._tmpMeasureA.width,this._currentMeasure.left+this._currentMeasure.width)-r.left,r.height=Math.min(this._tmpMeasureA.top+this._tmpMeasureA.height,this._currentMeasure.top+this._currentMeasure.height)-r.top,n._ClipMeasure.copyFrom(r)),this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var f=this.shadowOffsetX,e=this.shadowOffsetY,u=this.shadowBlur,o=Math.min(Math.min(f,0)-2*u,0),c=Math.max(Math.max(f,0)+2*u,0),h=Math.min(Math.min(e,0)-2*u,0),l=Math.max(Math.max(e,0)+2*u,0);t.rect(n._ClipMeasure.left+o,n._ClipMeasure.top+h,n._ClipMeasure.width+c-o,n._ClipMeasure.height+l-h)}else t.rect(n._ClipMeasure.left,n._ClipMeasure.top,n._ClipMeasure.width,n._ClipMeasure.height);t.clip()},n.prototype._render=function(n,t){return!this.isVisible||this.notRenderable||this._isClipped?(this._isDirty=!1,!1):(n.save(),this._applyStates(n),this._transform(n),this.clipContent&&this._clip(n,t),this.onBeforeDrawObservable.hasObservers()&&this.onBeforeDrawObservable.notifyObservers(this),this.useBitmapCache&&!this._wasDirty&&this._cacheData?n.putImageData(this._cacheData,this._currentMeasure.left,this._currentMeasure.top):this._draw(n,t),this.useBitmapCache&&this._wasDirty&&(this._cacheData=n.getImageData(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._renderHighlight(n),this.onAfterDrawObservable.hasObservers()&&this.onAfterDrawObservable.notifyObservers(this),n.restore(),!0)},n.prototype._draw=function(){},n.prototype.contains=function(n,t){return this._invertTransformMatrix.transformCoordinates(n,t,this._transformedPosition),n=this._transformedPosition.x,t=this._transformedPosition.y,!(n<this._currentMeasure.left)&&!(n>this._currentMeasure.left+this._currentMeasure.width)&&!(t<this._currentMeasure.top)&&!(t>this._currentMeasure.top+this._currentMeasure.height)&&(this.isPointerBlocker&&(this._host._shouldBlockPointer=!0),!0)},n.prototype._processPicking=function(n,t,i,r,u){return!!this._isEnabled&&!(!this.isHitTestVisible||!this.isVisible||this._doNotRender)&&!!this.contains(n,t)&&(this._processObservables(i,n,t,r,u),!0)},n.prototype._onPointerMove=function(n,t,i){this.onPointerMoveObservable.notifyObservers(t,-1,n,this)&&null!=this.parent&&this.parent._onPointerMove(n,t,i)},n.prototype._onPointerEnter=function(n){return!!this._isEnabled&&!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,n,this)&&null!=this.parent&&this.parent._onPointerEnter(n),!0)},n.prototype._onPointerOut=function(n,t){if(void 0===t&&(t=!1),t||this._isEnabled&&n!==this){this._enterCount=0;var i=!0;n.isAscendant(this)||(i=this.onPointerOutObservable.notifyObservers(this,-1,n,this));i&&null!=this.parent&&this.parent._onPointerOut(n,t)}},n.prototype._onPointerDown=function(n,t,i,r){return this._onPointerEnter(this),0===this._downCount&&(this._downCount++,this._downPointerIds[i]=!0,this.onPointerDownObservable.notifyObservers(new nt(t,r),-1,n,this)&&null!=this.parent&&this.parent._onPointerDown(n,t,i,r),!0)},n.prototype._onPointerUp=function(n,t,i,r,u){if(this._isEnabled){this._downCount=0;delete this._downPointerIds[i];var f=u;u&&(this._enterCount>0||-1===this._enterCount)&&(f=this.onPointerClickObservable.notifyObservers(new nt(t,r),-1,n,this));this.onPointerUpObservable.notifyObservers(new nt(t,r),-1,n,this)&&null!=this.parent&&this.parent._onPointerUp(n,t,i,r,f)}},n.prototype._forcePointerUp=function(n){if(void 0===n&&(n=null),null!==n)this._onPointerUp(this,r.Vector2.Zero(),n,0,!0);else for(var t in this._downPointerIds)this._onPointerUp(this,r.Vector2.Zero(),+t,0,!0)},n.prototype._processObservables=function(n,t,i,u,f){if(!this._isEnabled)return!1;if(this._dummyVector2.copyFromFloats(t,i),n===r.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,this._dummyVector2,u);var e=this._host._lastControlOver[u];return e&&e!==this&&e._onPointerOut(this),e!==this&&this._onPointerEnter(this),this._host._lastControlOver[u]=this,!0}return n===r.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,this._dummyVector2,u,f),this._host._registerLastControlDown(this,u),this._host._lastPickedControl=this,!0):n===r.PointerEventTypes.POINTERUP&&(this._host._lastControlDown[u]&&this._host._lastControlDown[u]._onPointerUp(this,this._dummyVector2,u,f,!0),delete this._host._lastControlDown[u],!0)},n.prototype._prepareFont=function(){(this._font||this._fontSet)&&(this._font=this._style?this._style.fontStyle+" "+this._style.fontWeight+" "+this.fontSizeInPixels+"px "+this._style.fontFamily:this._fontStyle+" "+this._fontWeight+" "+this.fontSizeInPixels+"px "+this._fontFamily,this._fontOffset=n._GetFontOffset(this._font))},n.prototype.dispose=function(){(this.onDirtyObservable.clear(),this.onBeforeDrawObservable.clear(),this.onAfterDrawObservable.clear(),this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this._styleObserver&&this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this.parent&&(this.parent.removeControl(this),this.parent=null),this._host)&&this._host._linkedControls.indexOf(this)>-1&&this.linkWithMesh(null)},Object.defineProperty(n,"HORIZONTAL_ALIGNMENT_LEFT",{get:function(){return n._HORIZONTAL_ALIGNMENT_LEFT},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HORIZONTAL_ALIGNMENT_RIGHT",{get:function(){return n._HORIZONTAL_ALIGNMENT_RIGHT},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HORIZONTAL_ALIGNMENT_CENTER",{get:function(){return n._HORIZONTAL_ALIGNMENT_CENTER},enumerable:!0,configurable:!0}),Object.defineProperty(n,"VERTICAL_ALIGNMENT_TOP",{get:function(){return n._VERTICAL_ALIGNMENT_TOP},enumerable:!0,configurable:!0}),Object.defineProperty(n,"VERTICAL_ALIGNMENT_BOTTOM",{get:function(){return n._VERTICAL_ALIGNMENT_BOTTOM},enumerable:!0,configurable:!0}),Object.defineProperty(n,"VERTICAL_ALIGNMENT_CENTER",{get:function(){return n._VERTICAL_ALIGNMENT_CENTER},enumerable:!0,configurable:!0}),n._GetFontOffset=function(t){var r,i,u,f,e,o;if(n._FontHeightSizes[t])return n._FontHeightSizes[t];r=document.createElement("span");r.innerHTML="Hg";r.style.font=t;i=document.createElement("div");i.style.display="inline-block";i.style.width="1px";i.style.height="0px";i.style.verticalAlign="bottom";u=document.createElement("div");u.appendChild(r);u.appendChild(i);document.body.appendChild(u);f=0;e=0;try{e=i.getBoundingClientRect().top-r.getBoundingClientRect().top;i.style.verticalAlign="baseline";f=i.getBoundingClientRect().top-r.getBoundingClientRect().top}finally{document.body.removeChild(u)}return o={ascent:f,height:e,descent:e-f},n._FontHeightSizes[t]=o,o},n.drawEllipse=function(n,t,i,r,u){u.translate(n,t);u.scale(i,r);u.beginPath();u.arc(0,0,1,0,2*Math.PI);u.closePath();u.scale(1/i,1/r);u.translate(-n,-t)},n.AllowAlphaInheritance=!1,n._ClipMeasure=new s(0,0,0,0),n._HORIZONTAL_ALIGNMENT_LEFT=0,n._HORIZONTAL_ALIGNMENT_RIGHT=1,n._HORIZONTAL_ALIGNMENT_CENTER=2,n._VERTICAL_ALIGNMENT_TOP=0,n._VERTICAL_ALIGNMENT_BOTTOM=1,n._VERTICAL_ALIGNMENT_CENTER=2,n._FontHeightSizes={},n.AddHeader=function(){},n}(),v=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._children=[],i._measureForChildren=s.Empty(),i._background="",i._adaptWidthToChildren=!1,i._adaptHeightToChildren=!1,i}return e(t,n),Object.defineProperty(t.prototype,"adaptHeightToChildren",{get:function(){return this._adaptHeightToChildren},set:function(n){this._adaptHeightToChildren!==n&&(this._adaptHeightToChildren=n,n&&(this.height="100%"),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adaptWidthToChildren",{get:function(){return this._adaptWidthToChildren},set:function(n){this._adaptWidthToChildren!==n&&(this._adaptWidthToChildren=n,n&&(this.width="100%"),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Container"},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var n=0,t=this.children;n<t.length;n++)t[n]._markMatrixAsDirty()},t.prototype.getChildByName=function(n){for(var r,t=0,i=this.children;t<i.length;t++)if(r=i[t],r.name===n)return r;return null},t.prototype.getChildByType=function(n,t){for(var u,i=0,r=this.children;i<r.length;i++)if(u=r[i],u.typeName===t)return u;return null},t.prototype.containsControl=function(n){return-1!==this.children.indexOf(n)},t.prototype.addControl=function(n){return n?-1!==this._children.indexOf(n)?this:(n._link(this._host),n._markAllAsDirty(),this._reOrderControl(n),this._markAsDirty(),this):this},t.prototype.clearControls=function(){for(var i,n=0,t=this.children.slice();n<t.length;n++)i=t[n],this.removeControl(i);return this},t.prototype.removeControl=function(n){var t=this._children.indexOf(n);return-1!==t&&(this._children.splice(t,1),n.parent=null),n.linkWithMesh(null),this._host&&this._host._cleanControlAfterRemoval(n),this._markAsDirty(),this},t.prototype._reOrderControl=function(n){this.removeControl(n);for(var i=!1,t=0;t<this._children.length;t++)if(this._children[t].zIndex>n.zIndex){this._children.splice(t,0,n);i=!0;break}i||this._children.push(n);n.parent=this;this._markAsDirty()},t.prototype._offsetLeft=function(t){n.prototype._offsetLeft.call(this,t);for(var i=0,r=this._children;i<r.length;i++)r[i]._offsetLeft(t)},t.prototype._offsetTop=function(t){n.prototype._offsetTop.call(this,t);for(var i=0,r=this._children;i<r.length;i++)r[i]._offsetTop(t)},t.prototype._markAllAsDirty=function(){n.prototype._markAllAsDirty.call(this);for(var t=0;t<this._children.length;t++)this._children[t]._markAllAsDirty()},t.prototype._localDraw=function(n){this._background&&(n.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),n.fillStyle=this._background,n.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),n.restore())},t.prototype._link=function(t){n.prototype._link.call(this,t);for(var i=0,r=this._children;i<r.length;i++)r[i]._link(t)},t.prototype._beforeLayout=function(){},t.prototype._processMeasures=function(t,i){!this._isDirty&&this._cachedParentMeasure.isEqualsTo(t)||(n.prototype._processMeasures.call(this,t,i),this._evaluateClippingState(t))},t.prototype._layout=function(n,t){var e,u,f,o,s,i;if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;this._isDirty&&this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);e=0;t.save();this._applyStates(t);this._beforeLayout();do{if(u=-1,f=-1,this._rebuildLayout=!1,this._processMeasures(n,t),!this._isClipped){for(o=0,s=this._children;o<s.length;o++)i=s[o],i._tempParentMeasure.copyFrom(this._measureForChildren),i._layout(this._measureForChildren,t)&&(this.adaptWidthToChildren&&i._width.isPixel&&(u=Math.max(u,i._currentMeasure.width)),this.adaptHeightToChildren&&i._height.isPixel&&(f=Math.max(f,i._currentMeasure.height)));this.adaptWidthToChildren&&u>=0&&this.width!==u+"px"&&(this.width=u+"px",this._rebuildLayout=!0);this.adaptHeightToChildren&&f>=0&&this.height!==f+"px"&&(this.height=f+"px",this._rebuildLayout=!0);this._postMeasure()}e++}while(this._rebuildLayout&&e<3);return e>=3&&r.Logger.Error("Layout cycle detected in GUI (Container name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this._isDirty&&(this.invalidateRect(),this._isDirty=!1),!0},t.prototype._postMeasure=function(){},t.prototype._draw=function(n,t){var i,r,u;for(this._localDraw(n),this.clipChildren&&this._clipForChildren(n),i=0,r=this._children;i<r.length;i++)u=r[i],t&&!u._intersectsRect(t)||u._render(n,t)},t.prototype._getDescendants=function(n,t,i){var r,u;if(void 0===t&&(t=!1),this.children)for(r=0;r<this.children.length;r++)u=this.children[r],i&&!i(u)||n.push(u),t||u._getDescendants(n,!1,i)},t.prototype._processPicking=function(t,i,r,u,f){var e,o;if(!this._isEnabled||!this.isVisible||this.notRenderable||!n.prototype.contains.call(this,t,i))return!1;for(e=this._children.length-1;e>=0;e--)if(o=this._children[e],o._processPicking(t,i,r,u,f))return o.hoverCursor&&this._host._changeCursor(o.hoverCursor),!0;return!!this.isHitTestVisible&&this._processObservables(r,t,i,u,f)},t.prototype._additionalProcessing=function(t,i){n.prototype._additionalProcessing.call(this,t,i);this._measureForChildren.copyFrom(this._currentMeasure)},t.prototype.dispose=function(){n.prototype.dispose.call(this);for(var t=this.children.length-1;t>=0;t--)this.children[t].dispose()},t}(u),a=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._thickness=1,i._cornerRadius=0,i}return e(t,n),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(n){this._thickness!==n&&(this._thickness=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(n){n<0&&(n=0);this._cornerRadius!==n&&(this._cornerRadius=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Rectangle"},t.prototype._localDraw=function(n){n.save();(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY);this._background&&(n.fillStyle=this._background,this._cornerRadius?(this._drawRoundedRect(n,this._thickness/2),n.fill()):n.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height));this._thickness&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),this.color&&(n.strokeStyle=this.color),n.lineWidth=this._thickness,this._cornerRadius?(this._drawRoundedRect(n,this._thickness/2),n.stroke()):n.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness));n.restore()},t.prototype._additionalProcessing=function(t,i){n.prototype._additionalProcessing.call(this,t,i);this._measureForChildren.width-=2*this._thickness;this._measureForChildren.height-=2*this._thickness;this._measureForChildren.left+=this._thickness;this._measureForChildren.top+=this._thickness},t.prototype._drawRoundedRect=function(n,t){void 0===t&&(t=0);var i=this._currentMeasure.left+t,r=this._currentMeasure.top+t,f=this._currentMeasure.width-2*t,e=this._currentMeasure.height-2*t,u=Math.min(e/2-2,Math.min(f/2-2,this._cornerRadius));n.beginPath();n.moveTo(i+u,r);n.lineTo(i+f-u,r);n.quadraticCurveTo(i+f,r,i+f,r+u);n.lineTo(i+f,r+e-u);n.quadraticCurveTo(i+f,r+e,i+f-u,r+e);n.lineTo(i+u,r+e);n.quadraticCurveTo(i,r+e,i,r+e-u);n.lineTo(i,r+u);n.quadraticCurveTo(i,r,i+u,r);n.closePath()},t.prototype._clipForChildren=function(n){this._cornerRadius&&(this._drawRoundedRect(n,this._thickness),n.clip())},t}(v);!function(n){n[n.Clip=0]="Clip";n[n.WordWrap=1]="WordWrap";n[n.Ellipsis=2]="Ellipsis"}(k||(k={}));var l=function(n){function t(t,i){void 0===i&&(i="");var e=n.call(this,t)||this;return e.name=t,e._text="",e._textWrapping=k.Clip,e._textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,e._textVerticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,e._resizeToFit=!1,e._lineSpacing=new f(0),e._outlineWidth=0,e._outlineColor="white",e.onTextChangedObservable=new r.Observable,e.onLinesReadyObservable=new r.Observable,e.text=i,e}return e(t,n),Object.defineProperty(t.prototype,"lines",{get:function(){return this._lines},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resizeToFit",{get:function(){return this._resizeToFit},set:function(n){this._resizeToFit!==n&&(this._resizeToFit=n,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textWrapping",{get:function(){return this._textWrapping},set:function(n){this._textWrapping!==n&&(this._textWrapping=+n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(n){this._text!==n&&(this._text=n,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textHorizontalAlignment",{get:function(){return this._textHorizontalAlignment},set:function(n){this._textHorizontalAlignment!==n&&(this._textHorizontalAlignment=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textVerticalAlignment",{get:function(){return this._textVerticalAlignment},set:function(n){this._textVerticalAlignment!==n&&(this._textVerticalAlignment=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineSpacing",{get:function(){return this._lineSpacing.toString(this._host)},set:function(n){this._lineSpacing.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(n){this._outlineWidth!==n&&(this._outlineWidth=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(n){this._outlineColor!==n&&(this._outlineColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"TextBlock"},t.prototype._processMeasures=function(t,i){var r,e,o,s,h;for(this._fontOffset||(this._fontOffset=u._GetFontOffset(i.font)),n.prototype._processMeasures.call(this,t,i),this._lines=this._breakLines(this._currentMeasure.width,i),this.onLinesReadyObservable.notifyObservers(this),r=0,e=0;e<this._lines.length;e++)o=this._lines[e],o.width>r&&(r=o.width);this._resizeToFit&&(this._textWrapping===k.Clip&&(s=this.paddingLeftInPixels+this.paddingRightInPixels+r,s!==this._width.internalValue&&(this._width.updateInPlace(s,f.UNITMODE_PIXEL),this._rebuildLayout=!0)),h=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length,h!==this._height.internalValue&&(this._height.updateInPlace(h,f.UNITMODE_PIXEL),this._rebuildLayout=!0))},t.prototype._drawText=function(n,t,i,r){var e=this._currentMeasure.width,f=0;switch(this._textHorizontalAlignment){case u.HORIZONTAL_ALIGNMENT_LEFT:f=0;break;case u.HORIZONTAL_ALIGNMENT_RIGHT:f=e-t;break;case u.HORIZONTAL_ALIGNMENT_CENTER:f=(e-t)/2}(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY);this.outlineWidth&&r.strokeText(n,this._currentMeasure.left+f,i);r.fillText(n,this._currentMeasure.left+f,i)},t.prototype._draw=function(n){n.save();this._applyStates(n);this._renderLines(n);n.restore()},t.prototype._applyStates=function(t){n.prototype._applyStates.call(this,t);this.outlineWidth&&(t.lineWidth=this.outlineWidth,t.strokeStyle=this.outlineColor)},t.prototype._breakLines=function(n,t){var r=[],o=this.text.split("\n"),u,s,i,f,h,e,c;if(this._textWrapping===k.Ellipsis)for(u=0,s=o;u<s.length;u++)i=s[u],r.push(this._parseLineEllipsis(i,n,t));else if(this._textWrapping===k.WordWrap)for(f=0,h=o;f<h.length;f++)i=h[f],r.push.apply(r,this._parseLineWordWrap(i,n,t));else for(e=0,c=o;e<c.length;e++)i=c[e],r.push(this._parseLine(i,t));return r},t.prototype._parseLine=function(n,t){return void 0===n&&(n=""),{text:n,width:t.measureText(n).width}},t.prototype._parseLineEllipsis=function(n,t,i){void 0===n&&(n="");var r=i.measureText(n).width;for(r>t&&(n+="…");n.length>2&&r>t;)n=n.slice(0,-2)+"…",r=i.measureText(n).width;return{text:n,width:r}},t.prototype._parseLineWordWrap=function(n,t,i){var o,s;void 0===n&&(n="");for(var e=[],u=n.split(" "),f=0,r=0;r<u.length;r++)o=r>0?n+" "+u[r]:u[0],s=i.measureText(o).width,s>t&&r>0?(e.push({text:n,width:f}),n=u[r],f=i.measureText(n).width):(f=s,n=o);return e.push({text:n,width:f}),e},t.prototype._renderLines=function(n){var f=this._currentMeasure.height,t=0,i,r;switch(this._textVerticalAlignment){case u.VERTICAL_ALIGNMENT_TOP:t=this._fontOffset.ascent;break;case u.VERTICAL_ALIGNMENT_BOTTOM:t=f-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case u.VERTICAL_ALIGNMENT_CENTER:t=this._fontOffset.ascent+(f-this._fontOffset.height*this._lines.length)/2}for(t+=this._currentMeasure.top,i=0;i<this._lines.length;i++)r=this._lines[i],0!==i&&0!==this._lineSpacing.internalValue&&(t+=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(r.text,r.width,t,n),t+=this._fontOffset.height},t.prototype.computeExpectedHeight=function(){var n,t;return this.text&&this.widthInPixels&&(n=document.createElement("canvas").getContext("2d"),n)?(this._applyStates(n),this._fontOffset||(this._fontOffset=u._GetFontOffset(n.font)),t=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,n),this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*t.length):0},t.prototype.dispose=function(){n.prototype.dispose.call(this);this.onTextChangedObservable.clear()},t}(u),b=function(n){function t(i,u){void 0===u&&(u=null);var f=n.call(this,i)||this;return f.name=i,f._loaded=!1,f._stretch=t.STRETCH_FILL,f._autoScale=!1,f._sourceLeft=0,f._sourceTop=0,f._sourceWidth=0,f._sourceHeight=0,f._cellWidth=0,f._cellHeight=0,f._cellId=-1,f._populateNinePatchSlicesFromImage=!1,f.onImageLoadedObservable=new r.Observable,f.source=u,f}return e(t,n),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._loaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"populateNinePatchSlicesFromImage",{get:function(){return this._populateNinePatchSlicesFromImage},set:function(n){this._populateNinePatchSlicesFromImage!==n&&(this._populateNinePatchSlicesFromImage=n,this._populateNinePatchSlicesFromImage&&this._loaded&&this._extractNinePatchSliceDataFromImage())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"detectPointerOnOpaqueOnly",{get:function(){return this._detectPointerOnOpaqueOnly},set:function(n){this._detectPointerOnOpaqueOnly!==n&&(this._detectPointerOnOpaqueOnly=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sliceLeft",{get:function(){return this._sliceLeft},set:function(n){this._sliceLeft!==n&&(this._sliceLeft=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sliceRight",{get:function(){return this._sliceRight},set:function(n){this._sliceRight!==n&&(this._sliceRight=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sliceTop",{get:function(){return this._sliceTop},set:function(n){this._sliceTop!==n&&(this._sliceTop=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sliceBottom",{get:function(){return this._sliceBottom},set:function(n){this._sliceBottom!==n&&(this._sliceBottom=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceLeft",{get:function(){return this._sourceLeft},set:function(n){this._sourceLeft!==n&&(this._sourceLeft=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceTop",{get:function(){return this._sourceTop},set:function(n){this._sourceTop!==n&&(this._sourceTop=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceWidth",{get:function(){return this._sourceWidth},set:function(n){this._sourceWidth!==n&&(this._sourceWidth=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceHeight",{get:function(){return this._sourceHeight},set:function(n){this._sourceHeight!==n&&(this._sourceHeight=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoScale",{get:function(){return this._autoScale},set:function(n){this._autoScale!==n&&(this._autoScale=n,n&&this._loaded&&this.synchronizeSizeWithContent())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stretch",{get:function(){return this._stretch},set:function(n){this._stretch!==n&&(this._stretch=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"domImage",{get:function(){return this._domImage},set:function(n){var t=this;this._domImage=n;this._loaded=!1;this._domImage.width?this._onImageLoaded():this._domImage.onload=function(){t._onImageLoaded()}},enumerable:!0,configurable:!0}),t.prototype._onImageLoaded=function(){this._imageWidth=this._domImage.width;this._imageHeight=this._domImage.height;this._loaded=!0;this._populateNinePatchSlicesFromImage&&this._extractNinePatchSliceDataFromImage();this._autoScale&&this.synchronizeSizeWithContent();this.onImageLoadedObservable.notifyObservers(this);this._markAsDirty()},t.prototype._extractNinePatchSliceDataFromImage=function(){var o,n,i,f;t._WorkingCanvas||(t._WorkingCanvas=document.createElement("canvas"));var e=t._WorkingCanvas,s=e.getContext("2d"),r=this._domImage.width,u=this._domImage.height;for(e.width=r,e.height=u,s.drawImage(this._domImage,0,0,r,u),o=s.getImageData(0,0,r,u),this._sliceLeft=-1,this._sliceRight=-1,n=0;n<r;n++)if((f=o.data[4*n+3])>127&&-1===this._sliceLeft)this._sliceLeft=n;else if(f<127&&this._sliceLeft>-1){this._sliceRight=n;break}for(this._sliceTop=-1,this._sliceBottom=-1,i=0;i<u;i++)if((f=o.data[i*r*4+3])>127&&-1===this._sliceTop)this._sliceTop=i;else if(f<127&&this._sliceTop>-1){this._sliceBottom=i;break}},Object.defineProperty(t.prototype,"source",{set:function(n){var t=this;this._source!==n&&(this._loaded=!1,this._source=n,this._domImage=document.createElement("img"),this._domImage.onload=function(){t._onImageLoaded()},n&&(r.Tools.SetCorsBehavior(n,this._domImage),this._domImage.src=n))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(n){this._cellWidth!==n&&(this._cellWidth=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(n){this._cellHeight!==n&&(this._cellHeight=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellId",{get:function(){return this._cellId},set:function(n){this._cellId!==n&&(this._cellId=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype.contains=function(i,r){if(!n.prototype.contains.call(this,i,r))return!1;if(!this._detectPointerOnOpaqueOnly||!t._WorkingCanvas)return!0;var u=t._WorkingCanvas.getContext("2d"),f=0|this._currentMeasure.width,e=0|this._currentMeasure.height;return u.getImageData(0,0,f,e).data[4*((i=i-this._currentMeasure.left|0)+(r=r-this._currentMeasure.top|0)*this._currentMeasure.width)+3]>0},t.prototype._getTypeName=function(){return"Image"},t.prototype.synchronizeSizeWithContent=function(){this._loaded&&(this.width=this._domImage.width+"px",this.height=this._domImage.height+"px")},t.prototype._processMeasures=function(i,r){if(this._loaded)switch(this._stretch){case t.STRETCH_EXTEND:this._autoScale&&this.synchronizeSizeWithContent();this.parent&&this.parent.parent&&(this.parent.adaptWidthToChildren=!0,this.parent.adaptHeightToChildren=!0)}n.prototype._processMeasures.call(this,i,r)},t.prototype._prepareWorkingCanvasForOpaqueDetection=function(){if(this._detectPointerOnOpaqueOnly){t._WorkingCanvas||(t._WorkingCanvas=document.createElement("canvas"));var n=t._WorkingCanvas,i=this._currentMeasure.width,r=this._currentMeasure.height,u=n.getContext("2d");n.width=i;n.height=r;u.clearRect(0,0,i,r)}},t.prototype._drawImage=function(n,i,r,u,f,e,o,s,h){(n.drawImage(this._domImage,i,r,u,f,e,o,s,h),this._detectPointerOnOpaqueOnly)&&(n=t._WorkingCanvas.getContext("2d")).drawImage(this._domImage,i,r,u,f,e-this._currentMeasure.left,o-this._currentMeasure.top,s,h)},t.prototype._draw=function(n){var u,f,i,r;if(n.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),-1==this.cellId)u=this._sourceLeft,f=this._sourceTop,i=this._sourceWidth?this._sourceWidth:this._imageWidth,r=this._sourceHeight?this._sourceHeight:this._imageHeight;else{var o=this._domImage.naturalWidth/this.cellWidth,s=this.cellId/o>>0,h=this.cellId%o;u=this.cellWidth*h;f=this.cellHeight*s;i=this.cellWidth;r=this.cellHeight}if(this._prepareWorkingCanvasForOpaqueDetection(),this._applyStates(n),this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:this._drawImage(n,u,f,i,r,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_UNIFORM:var c=this._currentMeasure.width/i,l=this._currentMeasure.height/r,e=Math.min(c,l),a=(this._currentMeasure.width-i*e)/2,v=(this._currentMeasure.height-r*e)/2;this._drawImage(n,u,f,i,r,this._currentMeasure.left+a,this._currentMeasure.top+v,i*e,r*e);break;case t.STRETCH_EXTEND:this._drawImage(n,u,f,i,r,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_NINE_PATCH:this._renderNinePatch(n)}n.restore()},t.prototype._renderCornerPatch=function(n,t,i,r,u,f,e){this._drawImage(n,t,i,r,u,this._currentMeasure.left+f,this._currentMeasure.top+e,r,u)},t.prototype._renderNinePatch=function(n){var f=this._imageHeight,i=this._sliceLeft,t=this._sliceTop,s=this._imageHeight-this._sliceBottom,r=this._imageWidth-this._sliceRight,e=0,o=0;this._populateNinePatchSlicesFromImage&&(e=1,o=1,f-=2,i-=1,t-=1,s-=1,r-=1);var h=this._sliceRight-this._sliceLeft+1,c=this._currentMeasure.width-r-this.sliceLeft+1,u=this._currentMeasure.height-f+this._sliceBottom;this._renderCornerPatch(n,e,o,i,t,0,0);this._renderCornerPatch(n,e,this._sliceBottom,i,f-this._sliceBottom,0,u);this._renderCornerPatch(n,this._sliceRight,o,r,t,this._currentMeasure.width-r,0);this._renderCornerPatch(n,this._sliceRight,this._sliceBottom,r,f-this._sliceBottom,this._currentMeasure.width-r,u);this._drawImage(n,this._sliceLeft,this._sliceTop,h,this._sliceBottom-this._sliceTop+1,this._currentMeasure.left+i,this._currentMeasure.top+t,c,u-t+1);this._drawImage(n,e,this._sliceTop,i,this._sliceBottom-this._sliceTop,this._currentMeasure.left,this._currentMeasure.top+t,i,u-t);this._drawImage(n,this._sliceRight,this._sliceTop,i,this._sliceBottom-this._sliceTop,this._currentMeasure.left+this._currentMeasure.width-r,this._currentMeasure.top+t,i,u-t);this._drawImage(n,this._sliceLeft,o,h,t,this._currentMeasure.left+i,this._currentMeasure.top,c,t);this._drawImage(n,this._sliceLeft,this._sliceBottom,h,s,this._currentMeasure.left+i,this._currentMeasure.top+u,c,s)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this.onImageLoadedObservable.clear()},t._WorkingCanvas=null,t.STRETCH_NONE=0,t.STRETCH_FILL=1,t.STRETCH_UNIFORM=2,t.STRETCH_EXTEND=3,t.STRETCH_NINE_PATCH=4,t}(u),y=function(n){function t(t){var i=n.call(this,t)||this,r;return i.name=t,i.thickness=1,i.isPointerBlocker=!0,r=null,i.pointerEnterAnimation=function(){r=i.alpha;i.alpha-=.1},i.pointerOutAnimation=function(){null!==r&&(i.alpha=r)},i.pointerDownAnimation=function(){i.scaleX-=.05;i.scaleY-=.05},i.pointerUpAnimation=function(){i.scaleX+=.05;i.scaleY+=.05},i}return e(t,n),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Button"},t.prototype._processPicking=function(t,i,r,u,f){return!(!(this._isEnabled&&this.isHitTestVisible&&this.isVisible)||this.notRenderable)&&!!n.prototype.contains.call(this,t,i)&&(this._processObservables(r,t,i,u,f),!0)},t.prototype._onPointerEnter=function(t){return!!n.prototype._onPointerEnter.call(this,t)&&(this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},t.prototype._onPointerOut=function(t,i){void 0===i&&(i=!1);this.pointerOutAnimation&&this.pointerOutAnimation();n.prototype._onPointerOut.call(this,t,i)},t.prototype._onPointerDown=function(t,i,r,u){return!!n.prototype._onPointerDown.call(this,t,i,r,u)&&(this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},t.prototype._onPointerUp=function(t,i,r,u,f){this.pointerUpAnimation&&this.pointerUpAnimation();n.prototype._onPointerUp.call(this,t,i,r,u,f)},t.CreateImageButton=function(n,i,r){var e=new t(n),o=new l(n+"_button",i),f;return o.textWrapping=!0,o.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,o.paddingLeft="20%",e.addControl(o),f=new b(n+"_icon",r),f.width="20%",f.stretch=b.STRETCH_UNIFORM,f.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,e.addControl(f),e._image=f,e._textBlock=o,e},t.CreateImageOnlyButton=function(n,i){var f=new t(n),r=new b(n+"_icon",i);return r.stretch=b.STRETCH_FILL,r.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,f.addControl(r),f._image=r,f},t.CreateSimpleButton=function(n,i){var f=new t(n),r=new l(n+"_button",i);return r.textWrapping=!0,r.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,f.addControl(r),f._textBlock=r,f},t.CreateImageWithCenterTextButton=function(n,i,r){var f=new t(n),o=new b(n+"_icon",r),e;return o.stretch=b.STRETCH_FILL,f.addControl(o),e=new l(n+"_button",i),e.textWrapping=!0,e.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,f.addControl(e),f._image=o,f._textBlock=e,f},t}(a),p=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._isVertical=!0,i._manualWidth=!1,i._manualHeight=!1,i._doNotTrackManualChanges=!1,i}return e(t,n),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(n){this._isVertical!==n&&(this._isVertical=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(n){this._doNotTrackManualChanges||(this._manualWidth=!0);this._width.toString(this._host)!==n&&this._width.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(n){this._doNotTrackManualChanges||(this._manualHeight=!0);this._height.toString(this._host)!==n&&this._height.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"StackPanel"},t.prototype._preMeasure=function(t,i){for(var e,r=0,f=this._children;r<f.length;r++)e=f[r],this._isVertical?e.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP:e.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;n.prototype._preMeasure.call(this,t,i)},t.prototype._additionalProcessing=function(t,i){n.prototype._additionalProcessing.call(this,t,i);this._measureForChildren.copyFrom(t);this._measureForChildren.left=this._currentMeasure.left;this._measureForChildren.top=this._currentMeasure.top;this.isVertical&&!this._manualWidth||(this._measureForChildren.width=this._currentMeasure.width);(this.isVertical||this._manualHeight)&&(this._measureForChildren.height=this._currentMeasure.height)},t.prototype._postMeasure=function(){for(var t,f,e,h,c,i=0,u=0,o=0,s=this._children;o<s.length;o++)t=s[o],t.isVisible&&!t.notRenderable&&(this._isVertical?(t.top!==u+"px"&&(t.top=u+"px",this._rebuildLayout=!0,t._top.ignoreAdaptiveScaling=!0),t._height.isPercentage?r.Tools.Warn("Control (Name:"+t.name+", UniqueId:"+t.uniqueId+") is using height in percentage mode inside a vertical StackPanel"):u+=t._currentMeasure.height+t.paddingTopInPixels+t.paddingBottomInPixels):(t.left!==i+"px"&&(t.left=i+"px",this._rebuildLayout=!0,t._left.ignoreAdaptiveScaling=!0),t._width.isPercentage?r.Tools.Warn("Control (Name:"+t.name+", UniqueId:"+t.uniqueId+") is using width in percentage mode inside a horizontal StackPanel"):i+=t._currentMeasure.width+t.paddingLeftInPixels+t.paddingRightInPixels));this._doNotTrackManualChanges=!0;f=!1;e=!1;!this._manualHeight&&this._isVertical&&(h=this.height,this.height=u+"px",e=h!==this.height||!this._height.ignoreAdaptiveScaling);this._manualWidth||this._isVertical||(c=this.width,this.width=i+"px",f=c!==this.width||!this._width.ignoreAdaptiveScaling);e&&(this._height.ignoreAdaptiveScaling=!0);f&&(this._width.ignoreAdaptiveScaling=!0);this._doNotTrackManualChanges=!1;(f||e)&&(this._rebuildLayout=!0);n.prototype._postMeasure.call(this)},t}(v),at=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._isChecked=!1,i._background="black",i._checkSizeRatio=.8,i._thickness=1,i.onIsCheckedChangedObservable=new r.Observable,i.isPointerBlocker=!0,i}return e(t,n),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(n){this._thickness!==n&&(this._thickness=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(n){n=Math.max(Math.min(1,n),0);this._checkSizeRatio!==n&&(this._checkSizeRatio=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(n){this._isChecked!==n&&(this._isChecked=n,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(n))},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Checkbox"},t.prototype._draw=function(n){var t,i,r,u;n.save();this._applyStates(n);t=this._currentMeasure.width-this._thickness;i=this._currentMeasure.height-this._thickness;((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),n.fillStyle=this._isEnabled?this._background:this._disabledColor,n.fillRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,t,i),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),this._isChecked)&&(n.fillStyle=this._isEnabled?this.color:this._disabledColor,r=t*this._checkSizeRatio,u=i*this._checkSizeRatio,n.fillRect(this._currentMeasure.left+this._thickness/2+(t-r)/2,this._currentMeasure.top+this._thickness/2+(i-u)/2,r,u));n.strokeStyle=this.color;n.lineWidth=this._thickness;n.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,t,i);n.restore()},t.prototype._onPointerDown=function(t,i,r,u){return!!n.prototype._onPointerDown.call(this,t,i,r,u)&&(this.isChecked=!this.isChecked,!0)},t.AddCheckBoxWithHeader=function(n,i){var e=new p,r,f;return e.isVertical=!1,e.height="30px",r=new t,r.width="20px",r.height="20px",r.isChecked=!0,r.color="green",r.onIsCheckedChangedObservable.add(i),e.addControl(r),f=new l,f.text=n,f.width="180px",f.paddingLeft="5px",f.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,f.color="white",e.addControl(f),e},t}(u),w=function(n){function t(t,i){void 0===i&&(i="");var u=n.call(this,t)||this;return u.name=t,u._text="",u._placeholderText="",u._background="#222222",u._focusedBackground="#000000",u._focusedColor="white",u._placeholderColor="gray",u._thickness=1,u._margin=new f(10,f.UNITMODE_PIXEL),u._autoStretchWidth=!0,u._maxWidth=new f(1,f.UNITMODE_PERCENTAGE,!1),u._isFocused=!1,u._blinkIsEven=!1,u._cursorOffset=0,u._deadKey=!1,u._addKey=!0,u._currentKey="",u._isTextHighlightOn=!1,u._textHighlightColor="#d5e0ff",u._highligherOpacity=.4,u._highlightedText="",u._startHighlightIndex=0,u._endHighlightIndex=0,u._cursorIndex=-1,u._onFocusSelectAll=!1,u._isPointerDown=!1,u.promptMessage="Please enter text:",u.onTextChangedObservable=new r.Observable,u.onBeforeKeyAddObservable=new r.Observable,u.onFocusObservable=new r.Observable,u.onBlurObservable=new r.Observable,u.onTextHighlightObservable=new r.Observable,u.onTextCopyObservable=new r.Observable,u.onTextCutObservable=new r.Observable,u.onTextPasteObservable=new r.Observable,u.onKeyboardEventProcessedObservable=new r.Observable,u.text=i,u.isPointerBlocker=!0,u}return e(t,n),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth.toString(this._host)},set:function(n){this._maxWidth.toString(this._host)!==n&&this._maxWidth.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidthInPixels",{get:function(){return this._maxWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highligherOpacity",{get:function(){return this._highligherOpacity},set:function(n){this._highligherOpacity!==n&&(this._highligherOpacity=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onFocusSelectAll",{get:function(){return this._onFocusSelectAll},set:function(n){this._onFocusSelectAll!==n&&(this._onFocusSelectAll=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textHighlightColor",{get:function(){return this._textHighlightColor},set:function(n){this._textHighlightColor!==n&&(this._textHighlightColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"margin",{get:function(){return this._margin.toString(this._host)},set:function(n){this._margin.toString(this._host)!==n&&this._margin.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginInPixels",{get:function(){return this._margin.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoStretchWidth",{get:function(){return this._autoStretchWidth},set:function(n){this._autoStretchWidth!==n&&(this._autoStretchWidth=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(n){this._thickness!==n&&(this._thickness=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusedBackground",{get:function(){return this._focusedBackground},set:function(n){this._focusedBackground!==n&&(this._focusedBackground=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusedColor",{get:function(){return this._focusedColor},set:function(n){this._focusedColor!==n&&(this._focusedColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholderColor",{get:function(){return this._placeholderColor},set:function(n){this._placeholderColor!==n&&(this._placeholderColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(n){this._placeholderText!==n&&(this._placeholderText=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deadKey",{get:function(){return this._deadKey},set:function(n){this._deadKey=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightedText",{get:function(){return this._highlightedText},set:function(n){this._highlightedText!==n&&(this._highlightedText=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addKey",{get:function(){return this._addKey},set:function(n){this._addKey=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentKey",{get:function(){return this._currentKey},set:function(n){this._currentKey=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(n){var t=n.toString();this._text!==t&&(this._text=t,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(n){this._width.toString(this._host)!==n&&(this._width.fromString(n)&&this._markAsDirty(),this.autoStretchWidth=!1)},enumerable:!0,configurable:!0}),t.prototype.onBlur=function(){this._isFocused=!1;this._scrollLeft=null;this._cursorOffset=0;clearTimeout(this._blinkTimeout);this._markAsDirty();this.onBlurObservable.notifyObservers(this);this._host.unRegisterClipboardEvents();this._onClipboardObserver&&this._host.onClipboardObservable.remove(this._onClipboardObserver);var n=this._host.getScene();this._onPointerDblTapObserver&&n&&n.onPointerObservable.remove(this._onPointerDblTapObserver)},t.prototype.onFocus=function(){var n=this,t,i;if(this._isEnabled){if(this._scrollLeft=null,this._isFocused=!0,this._blinkIsEven=!1,this._cursorOffset=0,this._markAsDirty(),this.onFocusObservable.notifyObservers(this),-1!==navigator.userAgent.indexOf("Mobile"))return t=prompt(this.promptMessage),null!==t&&(this.text=t),void(this._host.focusedControl=null);this._host.registerClipboardEvents();this._onClipboardObserver=this._host.onClipboardObservable.add(function(t){switch(t.type){case r.ClipboardEventTypes.COPY:n._onCopyText(t.event);n.onTextCopyObservable.notifyObservers(n);break;case r.ClipboardEventTypes.CUT:n._onCutText(t.event);n.onTextCutObservable.notifyObservers(n);break;case r.ClipboardEventTypes.PASTE:n._onPasteText(t.event);n.onTextPasteObservable.notifyObservers(n);break;default:return}});i=this._host.getScene();i&&(this._onPointerDblTapObserver=i.onPointerObservable.add(function(t){n._isFocused&&t.type===r.PointerEventTypes.POINTERDOUBLETAP&&n._processDblClick(t)}));this._onFocusSelectAll&&this._selectAllText()}},t.prototype._getTypeName=function(){return"InputText"},t.prototype.keepsFocusWith=function(){return this._connectedVirtualKeyboard?[this._connectedVirtualKeyboard]:null},t.prototype.processKey=function(n,t,i){var f,r,u;if(!i||!i.ctrlKey&&!i.metaKey||67!==n&&86!==n&&88!==n){if(i&&(i.ctrlKey||i.metaKey)&&65===n)return this._selectAllText(),void i.preventDefault();switch(n){case 32:t=" ";break;case 191:i&&i.preventDefault();break;case 8:if(this._text&&this._text.length>0){if(this._isTextHighlightOn)return this.text=this._text.slice(0,this._startHighlightIndex)+this._text.slice(this._endHighlightIndex),this._isTextHighlightOn=!1,this._cursorOffset=this.text.length-this._startHighlightIndex,this._blinkIsEven=!1,void(i&&i.preventDefault());0===this._cursorOffset?this.text=this._text.substr(0,this._text.length-1):(r=this._text.length-this._cursorOffset)>0&&(this.text=this._text.slice(0,r-1)+this._text.slice(r))}return void(i&&i.preventDefault());case 46:if(this._isTextHighlightOn){for(this.text=this._text.slice(0,this._startHighlightIndex)+this._text.slice(this._endHighlightIndex),f=this._endHighlightIndex-this._startHighlightIndex;f>0&&this._cursorOffset>0;)this._cursorOffset--;return this._isTextHighlightOn=!1,this._cursorOffset=this.text.length-this._startHighlightIndex,void(i&&i.preventDefault())}return this._text&&this._text.length>0&&this._cursorOffset>0&&(r=this._text.length-this._cursorOffset,this.text=this._text.slice(0,r)+this._text.slice(r+1),this._cursorOffset--),void(i&&i.preventDefault());case 13:return this._host.focusedControl=null,void(this._isTextHighlightOn=!1);case 35:return this._cursorOffset=0,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 36:return this._cursorOffset=this._text.length,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 37:if(this._cursorOffset++,this._cursorOffset>this._text.length&&(this._cursorOffset=this._text.length),i&&i.shiftKey){if(this._blinkIsEven=!1,i.ctrlKey||i.metaKey){if(!this._isTextHighlightOn){if(this._text.length===this._cursorOffset)return;this._endHighlightIndex=this._text.length-this._cursorOffset+1}return this._startHighlightIndex=0,this._cursorIndex=this._text.length-this._endHighlightIndex,this._cursorOffset=this._text.length,this._isTextHighlightOn=!0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._text.length-this._endHighlightIndex,this._cursorOffset=0===this._startHighlightIndex?this._text.length:this._text.length-this._startHighlightIndex+1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset>=this._text.length?this._text.length:this._cursorOffset-1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._text.length-this._cursorIndex,this._startHighlightIndex=this._text.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._text.length-this._cursorOffset,this._startHighlightIndex=this._text.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._text.length-this._startHighlightIndex,this._isTextHighlightOn=!1),i&&(i.ctrlKey||i.metaKey)&&(this._cursorOffset=this.text.length,i.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 39:if(this._cursorOffset--,this._cursorOffset<0&&(this._cursorOffset=0),i&&i.shiftKey){if(this._blinkIsEven=!1,i.ctrlKey||i.metaKey){if(!this._isTextHighlightOn){if(0===this._cursorOffset)return;this._startHighlightIndex=this._text.length-this._cursorOffset-1}return this._endHighlightIndex=this._text.length,this._isTextHighlightOn=!0,this._cursorIndex=this._text.length-this._startHighlightIndex,this._cursorOffset=0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._text.length-this._startHighlightIndex,this._cursorOffset=this._text.length===this._endHighlightIndex?0:this._text.length-this._endHighlightIndex-1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset<=0?0:this._cursorOffset+1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._text.length-this._cursorIndex,this._startHighlightIndex=this._text.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._text.length-this._cursorOffset,this._startHighlightIndex=this._text.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._text.length-this._endHighlightIndex,this._isTextHighlightOn=!1),i&&(i.ctrlKey||i.metaKey)&&(this._cursorOffset=0,i.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 222:i&&i.preventDefault();this._cursorIndex=-1;this.deadKey=!0}t&&(-1===n||32===n||n>47&&n<64||n>64&&n<91||n>159&&n<193||n>218&&n<223||n>95&&n<112)&&(this._currentKey=t,this.onBeforeKeyAddObservable.notifyObservers(this),t=this._currentKey,this._addKey)&&(this._isTextHighlightOn?(this.text=this._text.slice(0,this._startHighlightIndex)+t+this._text.slice(this._endHighlightIndex),this._cursorOffset=this.text.length-(this._startHighlightIndex+1),this._isTextHighlightOn=!1,this._blinkIsEven=!1,this._markAsDirty()):0===this._cursorOffset?this.text+=t:(u=this._text.length-this._cursorOffset,this.text=this._text.slice(0,u)+t+this._text.slice(u)))}},t.prototype._updateValueFromCursorIndex=function(n){if(this._blinkIsEven=!1,-1===this._cursorIndex)this._cursorIndex=n;else if(this._cursorIndex<this._cursorOffset)this._endHighlightIndex=this._text.length-this._cursorIndex,this._startHighlightIndex=this._text.length-this._cursorOffset;else{if(!(this._cursorIndex>this._cursorOffset))return this._isTextHighlightOn=!1,void this._markAsDirty();this._endHighlightIndex=this._text.length-this._cursorOffset;this._startHighlightIndex=this._text.length-this._cursorIndex}this._isTextHighlightOn=!0;this._markAsDirty()},t.prototype._processDblClick=function(){this._startHighlightIndex=this._text.length-this._cursorOffset;this._endHighlightIndex=this._startHighlightIndex;var n,t,i=/\w+/g;do t=this._endHighlightIndex<this._text.length&&-1!==this._text[this._endHighlightIndex].search(i)?++this._endHighlightIndex:0,n=this._startHighlightIndex>0&&-1!==this._text[this._startHighlightIndex-1].search(i)?--this._startHighlightIndex:0;while(n||t);this._cursorOffset=this.text.length-this._startHighlightIndex;this.onTextHighlightObservable.notifyObservers(this);this._isTextHighlightOn=!0;this._clickedCoordinate=null;this._blinkIsEven=!0;this._cursorIndex=-1;this._markAsDirty()},t.prototype._selectAllText=function(){this._blinkIsEven=!0;this._isTextHighlightOn=!0;this._startHighlightIndex=0;this._endHighlightIndex=this._text.length;this._cursorOffset=this._text.length;this._cursorIndex=-1;this._markAsDirty()},t.prototype.processKeyboard=function(n){this.processKey(n.keyCode,n.key,n);this.onKeyboardEventProcessedObservable.notifyObservers(n)},t.prototype._onCopyText=function(n){this._isTextHighlightOn=!1;try{n.clipboardData&&n.clipboardData.setData("text/plain",this._highlightedText)}catch(n){}this._host.clipboardData=this._highlightedText},t.prototype._onCutText=function(n){if(this._highlightedText){this.text=this._text.slice(0,this._startHighlightIndex)+this._text.slice(this._endHighlightIndex);this._isTextHighlightOn=!1;this._cursorOffset=this.text.length-this._startHighlightIndex;try{n.clipboardData&&n.clipboardData.setData("text/plain",this._highlightedText)}catch(n){}this._host.clipboardData=this._highlightedText;this._highlightedText=""}},t.prototype._onPasteText=function(n){var i="",t;i=n.clipboardData&&-1!==n.clipboardData.types.indexOf("text/plain")?n.clipboardData.getData("text/plain"):this._host.clipboardData;t=this._text.length-this._cursorOffset;this.text=this._text.slice(0,t)+i+this._text.slice(t)},t.prototype._draw=function(n){var c=this,t,i,l,v,r,y,s,e,a,p,o,h;if(n.save(),this._applyStates(n),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),this._isFocused?this._focusedBackground&&(n.fillStyle=this._isEnabled?this._focusedBackground:this._disabledColor,n.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)):this._background&&(n.fillStyle=this._isEnabled?this._background:this._disabledColor,n.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),this._fontOffset||(this._fontOffset=u._GetFontOffset(n.font)),t=this._currentMeasure.left+this._margin.getValueInPixel(this._host,this._tempParentMeasure.width),this.color&&(n.fillStyle=this.color),i=this._beforeRenderText(this._text),this._isFocused||this._text||!this._placeholderText||(i=this._placeholderText,this._placeholderColor&&(n.fillStyle=this._placeholderColor)),this._textWidth=n.measureText(i).width,l=2*this._margin.getValueInPixel(this._host,this._tempParentMeasure.width),this._autoStretchWidth&&(this.width=Math.min(this._maxWidth.getValueInPixel(this._host,this._tempParentMeasure.width),this._textWidth+l)+"px"),v=this._fontOffset.ascent+(this._currentMeasure.height-this._fontOffset.height)/2,r=this._width.getValueInPixel(this._host,this._tempParentMeasure.width)-l,(n.save(),n.beginPath(),n.rect(t,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,r+2,this._currentMeasure.height),n.clip(),this._isFocused&&this._textWidth>r)?(y=t-this._textWidth+r,this._scrollLeft||(this._scrollLeft=y)):this._scrollLeft=t,n.fillText(i,this._scrollLeft,this._currentMeasure.top+v),this._isFocused){if(this._clickedCoordinate){s=this._scrollLeft+this._textWidth-this._clickedCoordinate;e=0;this._cursorOffset=0;a=0;do this._cursorOffset&&(a=Math.abs(s-e)),this._cursorOffset++,e=n.measureText(i.substr(i.length-this._cursorOffset,this._cursorOffset)).width;while(e<s&&i.length>=this._cursorOffset);Math.abs(s-e)>a&&this._cursorOffset--;this._blinkIsEven=!1;this._clickedCoordinate=null}if(!this._blinkIsEven){var w=this.text.substr(this._text.length-this._cursorOffset),b=n.measureText(w).width,f=this._scrollLeft+this._textWidth-b;f<t?(this._scrollLeft+=t-f,f=t,this._markAsDirty()):f>t+r&&(this._scrollLeft+=t+r-f,f=t+r,this._markAsDirty());this._isTextHighlightOn||n.fillRect(f,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,2,this._fontOffset.height)}(clearTimeout(this._blinkTimeout),this._blinkTimeout=setTimeout(function(){c._blinkIsEven=!c._blinkIsEven;c._markAsDirty()},500),this._isTextHighlightOn)&&(clearTimeout(this._blinkTimeout),p=n.measureText(this.text.substring(this._startHighlightIndex)).width,o=this._scrollLeft+this._textWidth-p,this._highlightedText=this.text.substring(this._startHighlightIndex,this._endHighlightIndex),h=n.measureText(this.text.substring(this._startHighlightIndex,this._endHighlightIndex)).width,o<t&&((h-=t-o)||(h=n.measureText(this.text.charAt(this.text.length-this._cursorOffset)).width),o=t),n.globalAlpha=this._highligherOpacity,n.fillStyle=this._textHighlightColor,n.fillRect(o,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,h,this._fontOffset.height),n.globalAlpha=1)}n.restore();this._thickness&&(this._isFocused?this.focusedColor&&(n.strokeStyle=this.focusedColor):this.color&&(n.strokeStyle=this.color),n.lineWidth=this._thickness,n.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness));n.restore()},t.prototype._onPointerDown=function(t,i,r,u){return!!n.prototype._onPointerDown.call(this,t,i,r,u)&&(this._clickedCoordinate=i.x,this._isTextHighlightOn=!1,this._highlightedText="",this._cursorIndex=-1,this._isPointerDown=!0,this._host._capturingControl[r]=this,this._host.focusedControl===this?(clearTimeout(this._blinkTimeout),this._markAsDirty(),!0):!!this._isEnabled&&(this._host.focusedControl=this,!0))},t.prototype._onPointerMove=function(t,i,r){this._host.focusedControl===this&&this._isPointerDown&&(this._clickedCoordinate=i.x,this._markAsDirty(),this._updateValueFromCursorIndex(this._cursorOffset));n.prototype._onPointerMove.call(this,t,i,r)},t.prototype._onPointerUp=function(t,i,r,u,f){this._isPointerDown=!1;delete this._host._capturingControl[r];n.prototype._onPointerUp.call(this,t,i,r,u,f)},t.prototype._beforeRenderText=function(n){return n},t.prototype.dispose=function(){n.prototype.dispose.call(this);this.onBlurObservable.clear();this.onFocusObservable.clear();this.onTextChangedObservable.clear();this.onTextCopyObservable.clear();this.onTextCutObservable.clear();this.onTextPasteObservable.clear();this.onTextHighlightObservable.clear();this.onKeyboardEventProcessedObservable.clear()},t}(u),h=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._rowDefinitions=[],i._columnDefinitions=[],i._cells={},i._childControls=[],i}return e(t,n),Object.defineProperty(t.prototype,"columnCount",{get:function(){return this._columnDefinitions.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowCount",{get:function(){return this._rowDefinitions.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._childControls},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0}),t.prototype.getRowDefinition=function(n){return n<0||n>=this._rowDefinitions.length?null:this._rowDefinitions[n]},t.prototype.getColumnDefinition=function(n){return n<0||n>=this._columnDefinitions.length?null:this._columnDefinitions[n]},t.prototype.addRowDefinition=function(n,t){return void 0===t&&(t=!1),this._rowDefinitions.push(new f(n,t?f.UNITMODE_PIXEL:f.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},t.prototype.addColumnDefinition=function(n,t){return void 0===t&&(t=!1),this._columnDefinitions.push(new f(n,t?f.UNITMODE_PIXEL:f.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},t.prototype.setRowDefinition=function(n,t,i){if(void 0===i&&(i=!1),n<0||n>=this._rowDefinitions.length)return this;var r=this._rowDefinitions[n];return r&&r.isPixel===i&&r.internalValue===t?this:(this._rowDefinitions[n]=new f(t,i?f.UNITMODE_PIXEL:f.UNITMODE_PERCENTAGE),this._markAsDirty(),this)},t.prototype.setColumnDefinition=function(n,t,i){if(void 0===i&&(i=!1),n<0||n>=this._columnDefinitions.length)return this;var r=this._columnDefinitions[n];return r&&r.isPixel===i&&r.internalValue===t?this:(this._columnDefinitions[n]=new f(t,i?f.UNITMODE_PIXEL:f.UNITMODE_PERCENTAGE),this._markAsDirty(),this)},t.prototype.getChildrenAt=function(n,t){var i=this._cells[n+":"+t];return i?i.children:null},t.prototype.getChildCellInfo=function(n){return n._tag},t.prototype._removeCell=function(t,i){var r,u,e,f;if(t){for(n.prototype.removeControl.call(this,t),r=0,u=t.children;r<u.length;r++)e=u[r],f=this._childControls.indexOf(e),-1!==f&&this._childControls.splice(f,1);delete this._cells[i]}},t.prototype._offsetCell=function(n,t){if(this._cells[t]){this._cells[n]=this._cells[t];for(var i=0,r=this._cells[n].children;i<r.length;i++)r[i]._tag=n;delete this._cells[t]}},t.prototype.removeColumnDefinition=function(n){var t,i,u,r,f;if(n<0||n>=this._columnDefinitions.length)return this;for(t=0;t<this._rowDefinitions.length;t++)i=t+":"+n,u=this._cells[i],this._removeCell(u,i);for(t=0;t<this._rowDefinitions.length;t++)for(r=n+1;r<this._columnDefinitions.length;r++)f=t+":"+(r-1),i=t+":"+r,this._offsetCell(f,i);return this._columnDefinitions.splice(n,1),this._markAsDirty(),this},t.prototype.removeRowDefinition=function(n){var t,i,u,r,f;if(n<0||n>=this._rowDefinitions.length)return this;for(t=0;t<this._columnDefinitions.length;t++)i=n+":"+t,u=this._cells[i],this._removeCell(u,i);for(t=0;t<this._columnDefinitions.length;t++)for(r=n+1;r<this._rowDefinitions.length;r++)f=r-1+":"+t,i=r+":"+t,this._offsetCell(f,i);return this._rowDefinitions.splice(n,1),this._markAsDirty(),this},t.prototype.addControl=function(t,i,f){if(void 0===i&&(i=0),void 0===f&&(f=0),0===this._rowDefinitions.length&&this.addRowDefinition(1,!1),0===this._columnDefinitions.length&&this.addColumnDefinition(1,!1),-1!==this._childControls.indexOf(t))return r.Tools.Warn("Control (Name:"+t.name+", UniqueId:"+t.uniqueId+") is already associated with this grid. You must remove it before reattaching it"),this;var o=Math.min(i,this._rowDefinitions.length-1)+":"+Math.min(f,this._columnDefinitions.length-1),e=this._cells[o];return e||(e=new v(o),this._cells[o]=e,e.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,e.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,n.prototype.addControl.call(this,e)),e.addControl(t),this._childControls.push(t),t._tag=o,t.parent=this,this._markAsDirty(),this},t.prototype.removeControl=function(n){var i=this._childControls.indexOf(n),t;return-1!==i&&this._childControls.splice(i,1),t=this._cells[n._tag],t&&(t.removeControl(n),n._tag=null),this._markAsDirty(),this},t.prototype._getTypeName=function(){return"Grid"},t.prototype._getGridDefinitions=function(n){for(var r,u,v,f,t,e,y,o,s,p,h,c=[],l=[],w=[],b=[],k=this._currentMeasure.width,d=0,g=this._currentMeasure.height,nt=0,i=0,a=0,tt=this._rowDefinitions;a<tt.length;a++)(t=tt[a]).isPixel?(g-=f=t.getValue(this._host),l[i]=f):nt+=t.internalValue,i++;for(r=0,i=0,u=0,v=this._rowDefinitions;u<v.length;u++)t=v[u],(b.push(r),t.isPixel)?r+=t.getValue(this._host):(r+=f=t.internalValue/nt*g,l[i]=f),i++;for(i=0,e=0,y=this._columnDefinitions;e<y.length;e++)(t=y[e]).isPixel?(k-=h=t.getValue(this._host),c[i]=h):d+=t.internalValue,i++;for(o=0,i=0,s=0,p=this._columnDefinitions;s<p.length;s++)t=p[s],(w.push(o),t.isPixel)?o+=t.getValue(this._host):(o+=h=t.internalValue/d*k,c[i]=h),i++;n(w,b,c,l)},t.prototype._additionalProcessing=function(t,i){var r=this;this._getGridDefinitions(function(n,t,i,u){for(var e in r._cells)if(r._cells.hasOwnProperty(e)){var o=e.split(":"),s=parseInt(o[0]),h=parseInt(o[1]),f=r._cells[e];f.left=n[h]+"px";f.top=t[s]+"px";f.width=i[h]+"px";f.height=u[s]+"px";f._left.ignoreAdaptiveScaling=!0;f._top.ignoreAdaptiveScaling=!0;f._width.ignoreAdaptiveScaling=!0;f._height.ignoreAdaptiveScaling=!0}});n.prototype._additionalProcessing.call(this,t,i)},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var n in this._cells)this._cells.hasOwnProperty(n)&&this._cells[n]._markMatrixAsDirty()},t.prototype._renderHighlightSpecific=function(t){var i=this;n.prototype._renderHighlightSpecific.call(this,t);this._getGridDefinitions(function(n,r,u,f){for(var o,s,e=0;e<n.length;e++)o=i._currentMeasure.left+n[e]+u[e],t.beginPath(),t.moveTo(o,i._currentMeasure.top),t.lineTo(o,i._currentMeasure.top+i._currentMeasure.height),t.stroke();for(e=0;e<r.length;e++)s=i._currentMeasure.top+r[e]+f[e],t.beginPath(),t.moveTo(i._currentMeasure.left,s),t.lineTo(i._currentMeasure.left+i._currentMeasure.width,s),t.stroke()});t.restore()},t.prototype.dispose=function(){n.prototype.dispose.call(this);for(var t=0,i=this._childControls;t<i.length;t++)i[t].dispose();this._childControls=[]},t}(v),kt=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._value=r.Color3.Red(),i._tmpColor=new r.Color3,i._pointerStartedOnSquare=!1,i._pointerStartedOnWheel=!1,i._squareLeft=0,i._squareTop=0,i._squareSize=0,i._h=360,i._s=1,i._v=1,i._lastPointerDownID=-1,i.onValueChangedObservable=new r.Observable,i._pointerIsDown=!1,i.value=new r.Color3(.88,.1,.1),i.size="200px",i.isPointerBlocker=!0,i}return e(t,n),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(n){this._value.equals(n)||(this._value.copyFrom(n),this._RGBtoHSV(this._value,this._tmpColor),this._h=this._tmpColor.r,this._s=Math.max(this._tmpColor.g,1e-5),this._v=Math.max(this._tmpColor.b,1e-5),this._markAsDirty(),this._value.r<=t._Epsilon&&(this._value.r=0),this._value.g<=t._Epsilon&&(this._value.g=0),this._value.b<=t._Epsilon&&(this._value.b=0),this._value.r>=1-t._Epsilon&&(this._value.r=1),this._value.g>=1-t._Epsilon&&(this._value.g=1),this._value.b>=1-t._Epsilon&&(this._value.b=1),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(n){this._width.toString(this._host)!==n&&this._width.fromString(n)&&(this._height.fromString(n),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(n){this._height.toString(this._host)!==n&&this._height.fromString(n)&&(this._width.fromString(n),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.width},set:function(n){this.width=n},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"ColorPicker"},t.prototype._preMeasure=function(n){n.width<n.height?this._currentMeasure.height=n.width:this._currentMeasure.width=n.height},t.prototype._updateSquareProps=function(){var n=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),t=2*(n-.2*n)/Math.sqrt(2),i=n-.5*t;this._squareLeft=this._currentMeasure.left+i;this._squareTop=this._currentMeasure.top+i;this._squareSize=t},t.prototype._drawGradientSquare=function(n,t,i,r,u,f){var o=f.createLinearGradient(t,i,r+t,i),e;o.addColorStop(0,"#fff");o.addColorStop(1,"hsl("+n+", 100%, 50%)");f.fillStyle=o;f.fillRect(t,i,r,u);e=f.createLinearGradient(t,i,t,u+i);e.addColorStop(0,"rgba(0,0,0,0)");e.addColorStop(1,"#000");f.fillStyle=e;f.fillRect(t,i,r,u)},t.prototype._drawCircle=function(n,t,i,r){r.beginPath();r.arc(n,t,i+1,0,2*Math.PI,!1);r.lineWidth=3;r.strokeStyle="#333333";r.stroke();r.beginPath();r.arc(n,t,i,0,2*Math.PI,!1);r.lineWidth=3;r.strokeStyle="#ffffff";r.stroke()},t.prototype._createColorWheelCanvas=function(n,t){var o=document.createElement("canvas"),i,l,a,p,f,r,e;o.width=2*n;o.height=2*n;for(var v=o.getContext("2d"),y=v.getImageData(0,0,2*n,2*n),s=y.data,h=this._tmpColor,w=n*n,c=n-t,b=c*c,u=-n;u<n;u++)for(i=-n;i<n;i++)l=u*u+i*i,l>w||l<b||(a=Math.sqrt(l),p=Math.atan2(i,u),this._HSVtoRGB(180*p/Math.PI+180,a/n,1,h),f=4*(u+n+2*(i+n)*n),s[f]=255*h.r,s[f+1]=255*h.g,s[f+2]=255*h.b,r=.2,r=n<50?.2:n>150?.04:-.16*(n-50)/100+.2,e=(a-c)/(n-c),s[f+3]=e<r?e/r*255:e>1-r?255*(1-(e-(1-r))/r):255);return v.putImageData(y,0,0),o},t.prototype._RGBtoHSV=function(n,t){var e=n.r,r=n.g,u=n.b,i=Math.max(e,r,u),s=Math.min(e,r,u),f=0,h=0,c=i,o=i-s;0!==i&&(h=o/i);i!=s&&(i==e?(f=(r-u)/o,r<u&&(f+=6)):i==r?f=(u-e)/o+2:i==u&&(f=(e-r)/o+4),f*=60);t.r=f;t.g=h;t.b=c},t.prototype._HSVtoRGB=function(n,t,i,r){var f=i*t,u=n/60,e=f*(1-Math.abs(u%2-1)),o=0,s=0,h=0,c;u>=0&&u<=1?(o=f,s=e):u>=1&&u<=2?(o=e,s=f):u>=2&&u<=3?(s=f,h=e):u>=3&&u<=4?(s=e,h=f):u>=4&&u<=5?(o=e,h=f):u>=5&&u<=6&&(o=f,h=e);c=i-f;r.set(o+c,s+c,h+c)},t.prototype._draw=function(n){var i,r,f;n.save();this._applyStates(n);var t=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),u=.2*t,e=this._currentMeasure.left,o=this._currentMeasure.top;this._colorWheelCanvas&&this._colorWheelCanvas.width==2*t||(this._colorWheelCanvas=this._createColorWheelCanvas(t,u));this._updateSquareProps();(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY,n.fillRect(this._squareLeft,this._squareTop,this._squareSize,this._squareSize));n.drawImage(this._colorWheelCanvas,e,o);(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0);this._drawGradientSquare(this._h,this._squareLeft,this._squareTop,this._squareSize,this._squareSize,n);i=this._squareLeft+this._squareSize*this._s;r=this._squareTop+this._squareSize*(1-this._v);this._drawCircle(i,r,.04*t,n);f=t-.5*u;i=e+t+Math.cos((this._h-180)*Math.PI/180)*f;r=o+t+Math.sin((this._h-180)*Math.PI/180)*f;this._drawCircle(i,r,.35*u,n);n.restore()},t.prototype._updateValueFromPointer=function(n,i){if(this._pointerStartedOnWheel){var r=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),u=r+this._currentMeasure.left,f=r+this._currentMeasure.top;this._h=180*Math.atan2(i-f,n-u)/Math.PI+180}else this._pointerStartedOnSquare&&(this._updateSquareProps(),this._s=(n-this._squareLeft)/this._squareSize,this._v=1-(i-this._squareTop)/this._squareSize,this._s=Math.min(this._s,1),this._s=Math.max(this._s,t._Epsilon),this._v=Math.min(this._v,1),this._v=Math.max(this._v,t._Epsilon));this._HSVtoRGB(this._h,this._s,this._v,this._tmpColor);this.value=this._tmpColor},t.prototype._isPointOnSquare=function(n,t){this._updateSquareProps();var i=this._squareLeft,r=this._squareTop,u=this._squareSize;return n>=i&&n<=i+u&&t>=r&&t<=r+u},t.prototype._isPointOnWheel=function(n,t){var i=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),r=i-.2*i,u=n-(i+this._currentMeasure.left),f=t-(i+this._currentMeasure.top),e=u*u+f*f;return e<=i*i&&e>=r*r},t.prototype._onPointerDown=function(t,i,r,u){if(!n.prototype._onPointerDown.call(this,t,i,r,u))return!1;this._pointerIsDown=!0;this._pointerStartedOnSquare=!1;this._pointerStartedOnWheel=!1;this._invertTransformMatrix.transformCoordinates(i.x,i.y,this._transformedPosition);var f=this._transformedPosition.x,e=this._transformedPosition.y;return this._isPointOnSquare(f,e)?this._pointerStartedOnSquare=!0:this._isPointOnWheel(f,e)&&(this._pointerStartedOnWheel=!0),this._updateValueFromPointer(f,e),this._host._capturingControl[r]=this,this._lastPointerDownID=r,!0},t.prototype._onPointerMove=function(t,i,r){if(r==this._lastPointerDownID){this._invertTransformMatrix.transformCoordinates(i.x,i.y,this._transformedPosition);var u=this._transformedPosition.x,f=this._transformedPosition.y;this._pointerIsDown&&this._updateValueFromPointer(u,f);n.prototype._onPointerMove.call(this,t,i,r)}},t.prototype._onPointerUp=function(t,i,r,u,f){this._pointerIsDown=!1;delete this._host._capturingControl[r];n.prototype._onPointerUp.call(this,t,i,r,u,f)},t.ShowPickerDialogAsync=function(n,i){return new Promise(function(f){function yi(n,t){var i,r;e=t;i=n.toHexString();(bt.background=i,d.name!=e&&(d.text=Math.floor(255*n.r).toString()),g.name!=e&&(g.text=Math.floor(255*n.g).toString()),nt.name!=e&&(nt.text=Math.floor(255*n.b).toString()),v.name!=e&&(v.text=n.r.toString()),p.name!=e&&(p.text=n.g.toString()),b.name!=e&&(b.text=n.b.toString()),o.name!=e)&&(r=i.split("#"),o.text=r[1]);et.name!=e&&(et.value=n)}function wi(n,t){var i=n.text,u;/[^0-9]/g.test(i)?n.text=ot:(""!=i&&(Math.floor(parseInt(i))<0?i="0":Math.floor(parseInt(i))>255?i="255":isNaN(parseInt(i))&&(i="0")),e==n.name&&(ot=i),""!=i)&&(i=parseInt(i).toString(),n.text=i,u=r.Color3.FromHexString(bt.background),e==n.name&&yi("r"==t?new r.Color3(parseInt(i)/255,u.g,u.b):"g"==t?new r.Color3(u.r,parseInt(i)/255,u.b):new r.Color3(u.r,u.g,parseInt(i)/255),n.name))}function bi(n,t){var i=n.text,u;/[^0-9\.]/g.test(i)?n.text=ot:(""!=i&&"."!=i&&0!=parseFloat(i)&&(parseFloat(i)<0?i="0.0":parseFloat(i)>1?i="1.0":isNaN(parseFloat(i))&&(i="0.0")),e==n.name&&(ot=i),""!=i&&"."!=i&&0!=parseFloat(i)?(i=parseFloat(i).toString(),n.text=i):i="0.0",u=r.Color3.FromHexString(bt.background),e==n.name&&yi("r"==t?new r.Color3(parseFloat(i),u.g,u.b):"g"==t?new r.Color3(u.r,parseFloat(i),u.b):new r.Color3(u.r,u.g,parseFloat(i)),n.name))}function cu(){var e,n,t,o,f;return i.savedColors&&i.savedColors[li]?(e=vi?"b":"",n=y.CreateSimpleButton("Swatch_"+li,e),n.fontFamily="BabylonJSglyphs",t=r.Color3.FromHexString(i.savedColors[li]),o=t.r+t.g+t.b,n.color=o>ou?su:hu,n.fontSize=Math.floor(.7*pt),n.textBlock.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,n.height=n.width=pt.toString()+"px",n.background=i.savedColors[li],n.thickness=2,f=li,n.pointerDownAnimation=function(){n.thickness=4},n.pointerUpAnimation=function(){n.thickness=3},n.pointerEnterAnimation=function(){n.thickness=3},n.pointerOutAnimation=function(){n.thickness=2},n.onPointerClickObservable.add(function(){var t;vi?(t=f,i.savedColors&&i.savedColors.splice(t,1),i.savedColors&&0==i.savedColors.length&&(cr(!1),vi=!1),hr("",k)):i.savedColors&&yi(r.Color3.FromHexString(i.savedColors[f]),n.name)}),n):null}function st(n){if(void 0!==n&&(vi=n),vi){for(var t=0;t<c.children.length;t++)c.children[t].textBlock.text="b";void 0!==s&&(s.textBlock.text="Done")}else{for(t=0;t<c.children.length;t++)c.children[t].textBlock.text="";void 0!==s&&(s.textBlock.text="Edit")}}function hr(n,t){var r,f,l,u,e,o,a,h;if(i.savedColors){if(""!=n&&i.savedColors.push(n),li=0,c.clearControls(),r=Math.ceil(i.savedColors.length/i.numSwatchesPerLine),f=0==r?0:r+1,c.rowCount!=r+f){for(l=c.rowCount,u=0;u<l;u++)c.removeRowDefinition(0);for(u=0;u<r+f;u++)u%2?c.addRowDefinition(pt,!0):c.addRowDefinition(ai,!0)}for(c.height=(pt*r+f*ai).toString()+"px",e=1,o=1;e<r+f;e+=2,o++){a=i.savedColors.length>o*i.numSwatchesPerLine?i.numSwatchesPerLine:i.savedColors.length-(o-1)*i.numSwatchesPerLine;for(var y=Math.min(Math.max(a,0),i.numSwatchesPerLine),s=0,v=1;s<y;s++)s>i.numSwatchesPerLine||(h=cu(),null!=h&&(c.addControl(h,e,v),v+=2,li++))}i.savedColors.length>=i.swatchLimit?lr(t,!0):lr(t,!1)}}function cr(n){n?((s=y.CreateSimpleButton("butEdit","Edit")).width=ii,s.height=hi,s.left=Math.floor(.1*parseInt(ii)).toString()+"px",s.top=(-1*parseFloat(s.left)).toString()+"px",s.verticalAlignment=u.VERTICAL_ALIGNMENT_BOTTOM,s.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,s.thickness=2,s.color=kt,s.fontSize=ft,s.background=at,s.onPointerEnterObservable.add(function(){s.background=ri}),s.onPointerOutObservable.add(function(){s.background=at}),s.pointerDownAnimation=function(){s.background=ur},s.pointerUpAnimation=function(){s.background=ri},s.onPointerClickObservable.add(function(){vi=!vi;st()}),ui.addControl(s,1,0)):ui.removeControl(s)}function lr(n,t){t?(n.color=fu,n.background=eu):(n.color=kt,n.background=at)}function ar(t){i.savedColors&&i.savedColors.length>0?f({savedColors:i.savedColors,pickedColor:t}):f({pickedColor:t});n.removeControl(lt)}var lt,vr,fr,dr,ht,dt,yr,nr,wt,tt,er,gt,tr,ui,fi,ir,ei,rr,vt,ki,oi,gr,nu,pr,di,ct,pi,gi,yt,it,rt,k,ni,ut,si,ti,tu;i.pickerWidth=i.pickerWidth||"640px";i.pickerHeight=i.pickerHeight||"400px";i.headerHeight=i.headerHeight||"35px";i.lastColor=i.lastColor||"#000000";i.swatchLimit=i.swatchLimit||20;i.numSwatchesPerLine=i.numSwatchesPerLine||10;var or,ft,s,ii,hi,ci,li,c,et,d,g,nt,v,p,b,o,bt,ot,e,wr=i.swatchLimit/i.numSwatchesPerLine,iu=parseFloat(i.pickerWidth)/i.numSwatchesPerLine,ai=Math.floor(.25*iu),ru=ai*(i.numSwatchesPerLine+1),pt=Math.floor((parseFloat(i.pickerWidth)-ru)/i.numSwatchesPerLine),uu=pt*wr+ai*(wr+1),br=(parseInt(i.pickerHeight)+uu+Math.floor(.25*pt)).toString()+"px",kt="#c0c0c0",at="#535353",ri="#414141",ur="515151",fu="#555555",eu="#454545",sr=r.Color3.FromHexString("#dddddd"),ou=sr.r+sr.g+sr.b,su="#aaaaaa",hu="#ffffff",kr=["R","G","B"],vi=!1;if(lt=new h,(lt.name="Dialog Container",lt.width=i.pickerWidth,i.savedColors)?(lt.height=br,vr=parseInt(i.pickerHeight)/parseInt(br),lt.addRowDefinition(vr,!1),lt.addRowDefinition(1-vr,!1)):(lt.height=i.pickerHeight,lt.addRowDefinition(1,!1)),n.addControl(lt),i.savedColors){for((c=new h).name="Swatch Drawer",c.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,c.background=at,c.width=i.pickerWidth,fr=i.savedColors.length/i.numSwatchesPerLine,dr=0==fr?0:fr+1,c.height=(pt*fr+dr*ai).toString()+"px",c.top=Math.floor(.25*pt).toString()+"px",ht=0;ht<2*Math.ceil(i.savedColors.length/i.numSwatchesPerLine)+1;ht++)ht%2!=0?c.addRowDefinition(pt,!0):c.addRowDefinition(ai,!0);for(ht=0;ht<2*i.numSwatchesPerLine+1;ht++)ht%2!=0?c.addColumnDefinition(pt,!0):c.addColumnDefinition(ai,!0);lt.addControl(c,1,0)}for(dt=new h,dt.name="Picker Panel",dt.height=i.pickerHeight,yr=parseInt(i.headerHeight)/parseInt(i.pickerHeight),nr=[yr,1-yr],dt.addRowDefinition(nr[0],!1),dt.addRowDefinition(nr[1],!1),lt.addControl(dt,0,0),wt=new a,wt.name="Dialogue Header Bar",wt.background="#cccccc",wt.thickness=0,dt.addControl(wt,0,0),tt=y.CreateSimpleButton("closeButton","a"),tt.fontFamily="BabylonJSglyphs",er=r.Color3.FromHexString(wt.background),or=new r.Color3(1-er.r,1-er.g,1-er.b),tt.color=or.toHexString(),tt.fontSize=Math.floor(.6*parseInt(i.headerHeight)),tt.textBlock.textVerticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,tt.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_RIGHT,tt.height=tt.width=i.headerHeight,tt.background=wt.background,tt.thickness=0,tt.pointerDownAnimation=function(){},tt.pointerUpAnimation=function(){tt.background=wt.background},tt.pointerEnterAnimation=function(){tt.color=wt.background;tt.background="red"},tt.pointerOutAnimation=function(){tt.color=or.toHexString();tt.background=wt.background},tt.onPointerClickObservable.add(function(){ar(ct.background)}),dt.addControl(tt,0,0),gt=new h,gt.name="Dialogue Body",gt.background=at,tr=[.4375,.5625],gt.addRowDefinition(1,!1),gt.addColumnDefinition(tr[0],!1),gt.addColumnDefinition(tr[1],!1),dt.addControl(gt,1,0),ui=new h,ui.name="Picker Grid",ui.addRowDefinition(.85,!1),ui.addRowDefinition(.15,!1),gt.addControl(ui,0,0),(et=new t).name="GUI Color Picker",i.pickerHeight<i.pickerWidth?et.width=.89:et.height=.89,et.value=r.Color3.FromHexString(i.lastColor),et.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,et.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,et.onPointerDownObservable.add(function(){e=et.name;ot="";st(!1)}),et.onValueChangedObservable.add(function(n){e==et.name&&yi(n,et.name)}),ui.addControl(et,0,0),fi=new h,fi.name="Dialogue Right Half",fi.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,ir=[.514,.486],fi.addRowDefinition(ir[0],!1),fi.addRowDefinition(ir[1],!1),gt.addControl(fi,1,1),ei=new h,ei.name="Swatches and Buttons",rr=[.417,.583],ei.addRowDefinition(1,!1),ei.addColumnDefinition(rr[0],!1),ei.addColumnDefinition(rr[1],!1),fi.addControl(ei,0,0),vt=new h,vt.name="New and Current Swatches",ki=[.04,.16,.64,.16],vt.addRowDefinition(ki[0],!1),vt.addRowDefinition(ki[1],!1),vt.addRowDefinition(ki[2],!1),vt.addRowDefinition(ki[3],!1),ei.addControl(vt,0,0),oi=new h,oi.name="Active Swatches",oi.width=.67,oi.addRowDefinition(.5,!1),oi.addRowDefinition(.5,!1),vt.addControl(oi,2,0),gr=Math.floor(parseInt(i.pickerWidth)*tr[1]*rr[0]*.11),nu=Math.floor(parseInt(i.pickerHeight)*nr[1]*ir[0]*ki[1]*.5),pr=i.pickerWidth>i.pickerHeight?nu:gr,di=new l,di.text="new",di.name="New Color Label",di.color=kt,di.fontSize=pr,vt.addControl(di,1,0),(bt=new a).name="New Color Swatch",bt.background=i.lastColor,bt.thickness=0,oi.addControl(bt,0,0),ct=y.CreateSimpleButton("currentSwatch",""),ct.background=i.lastColor,ct.thickness=0,ct.onPointerClickObservable.add(function(){yi(r.Color3.FromHexString(ct.background),ct.name);st(!1)}),ct.pointerDownAnimation=function(){},ct.pointerUpAnimation=function(){},ct.pointerEnterAnimation=function(){},ct.pointerOutAnimation=function(){},oi.addControl(ct,1,0),pi=new a,pi.name="Swatch Outline",pi.width=.67,pi.thickness=2,pi.color="#404040",pi.isHitTestVisible=!1,vt.addControl(pi,2,0),gi=new l,gi.name="Current Color Label",gi.text="current",gi.color=kt,gi.fontSize=pr,vt.addControl(gi,3,0),yt=new h,yt.name="Button Grid",yt.height=.8,yt.addRowDefinition(1/3,!1),yt.addRowDefinition(1/3,!1),yt.addRowDefinition(1/3,!1),ei.addControl(yt,0,1),ii=Math.floor(parseInt(i.pickerWidth)*tr[1]*rr[1]*.67).toString()+"px",hi=Math.floor(parseInt(i.pickerHeight)*nr[1]*ir[0]*(parseFloat(yt.height.toString())/100)*(1/3)*.7).toString()+"px",ft=parseFloat(ii)>parseFloat(hi)?Math.floor(.45*parseFloat(hi)):Math.floor(.11*parseFloat(ii)),it=y.CreateSimpleButton("butOK","OK"),it.width=ii,it.height=hi,it.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,it.thickness=2,it.color=kt,it.fontSize=ft,it.background=at,it.onPointerEnterObservable.add(function(){it.background=ri}),it.onPointerOutObservable.add(function(){it.background=at}),it.pointerDownAnimation=function(){it.background=ur},it.pointerUpAnimation=function(){it.background=ri},it.onPointerClickObservable.add(function(){st(!1);ar(bt.background)}),yt.addControl(it,0,0),rt=y.CreateSimpleButton("butCancel","Cancel"),(rt.width=ii,rt.height=hi,rt.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,rt.thickness=2,rt.color=kt,rt.fontSize=ft,rt.background=at,rt.onPointerEnterObservable.add(function(){rt.background=ri}),rt.onPointerOutObservable.add(function(){rt.background=at}),rt.pointerDownAnimation=function(){rt.background=ur},rt.pointerUpAnimation=function(){rt.background=ri},rt.onPointerClickObservable.add(function(){st(!1);ar(ct.background)}),yt.addControl(rt,1,0),i.savedColors)&&(k=y.CreateSimpleButton("butSave","Save"),k.width=ii,k.height=hi,k.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,k.thickness=2,k.fontSize=ft,i.savedColors.length<i.swatchLimit?(k.color=kt,k.background=at):lr(k,!0),k.onPointerEnterObservable.add(function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(k.background=ri)}),k.onPointerOutObservable.add(function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(k.background=at)}),k.pointerDownAnimation=function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(k.background=ur)},k.pointerUpAnimation=function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(k.background=ri)},k.onPointerClickObservable.add(function(){i.savedColors&&(0==i.savedColors.length&&cr(!0),i.savedColors.length<i.swatchLimit&&hr(bt.background,k),st(!1))}),i.savedColors.length>0&&cr(!0),yt.addControl(k,2,0)),ni=new h,ni.name="Dialog Lower Right",ni.addRowDefinition(.02,!1),ni.addRowDefinition(.63,!1),ni.addRowDefinition(.21,!1),ni.addRowDefinition(.14,!1),fi.addControl(ni,1,0),ci=r.Color3.FromHexString(i.lastColor),ut=new h,ut.name="RGB Values",ut.width=.82,ut.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,ut.addRowDefinition(1/3,!1),ut.addRowDefinition(1/3,!1),ut.addRowDefinition(1/3,!1),ut.addColumnDefinition(.1,!1),ut.addColumnDefinition(.2,!1),ut.addColumnDefinition(.7,!1),ni.addControl(ut,1,0),ht=0;ht<kr.length;ht++)(si=new l).text=kr[ht],si.color=kt,si.fontSize=ft,ut.addControl(si,ht,0);(d=new w).width=.83;d.height=.72;d.name="rIntField";d.fontSize=ft;d.text=(255*ci.r).toString();d.color="#f0f0f0";d.background="#454545";d.onFocusObservable.add(function(){e=d.name;ot=d.text;st(!1)});d.onBlurObservable.add(function(){""==d.text&&(d.text="0");wi(d,"r");e==d.name&&(e="")});d.onTextChangedObservable.add(function(){e==d.name&&wi(d,"r")});ut.addControl(d,0,1);(g=new w).width=.83;g.height=.72;g.name="gIntField";g.fontSize=ft;g.text=(255*ci.g).toString();g.color="#f0f0f0";g.background="#454545";g.onFocusObservable.add(function(){e=g.name;ot=g.text;st(!1)});g.onBlurObservable.add(function(){""==g.text&&(g.text="0");wi(g,"g");e==g.name&&(e="")});g.onTextChangedObservable.add(function(){e==g.name&&wi(g,"g")});ut.addControl(g,1,1);(nt=new w).width=.83;nt.height=.72;nt.name="bIntField";nt.fontSize=ft;nt.text=(255*ci.b).toString();nt.color="#f0f0f0";nt.background="#454545";nt.onFocusObservable.add(function(){e=nt.name;ot=nt.text;st(!1)});nt.onBlurObservable.add(function(){""==nt.text&&(nt.text="0");wi(nt,"b");e==nt.name&&(e="")});nt.onTextChangedObservable.add(function(){e==nt.name&&wi(nt,"b")});ut.addControl(nt,2,1);(v=new w).width=.95;v.height=.72;v.name="rDecField";v.fontSize=ft;v.text=ci.r.toString();v.color="#f0f0f0";v.background="#454545";v.onFocusObservable.add(function(){e=v.name;ot=v.text;st(!1)});v.onBlurObservable.add(function(){0!=parseFloat(v.text)&&""!=v.text||(v.text="0",bi(v,"r"));e==v.name&&(e="")});v.onTextChangedObservable.add(function(){e==v.name&&bi(v,"r")});ut.addControl(v,0,2);(p=new w).width=.95;p.height=.72;p.name="gDecField";p.fontSize=ft;p.text=ci.g.toString();p.color="#f0f0f0";p.background="#454545";p.onFocusObservable.add(function(){e=p.name;ot=p.text;st(!1)});p.onBlurObservable.add(function(){0!=parseFloat(p.text)&&""!=p.text||(p.text="0",bi(p,"g"));e==p.name&&(e="")});p.onTextChangedObservable.add(function(){e==p.name&&bi(p,"g")});ut.addControl(p,1,2);(b=new w).width=.95;b.height=.72;b.name="bDecField";b.fontSize=ft;b.text=ci.b.toString();b.color="#f0f0f0";b.background="#454545";b.onFocusObservable.add(function(){e=b.name;ot=b.text;st(!1)});b.onBlurObservable.add(function(){0!=parseFloat(b.text)&&""!=b.text||(b.text="0",bi(b,"b"));e==b.name&&(e="")});b.onTextChangedObservable.add(function(){e==b.name&&bi(b,"b")});ut.addControl(b,2,2);ti=new h;ti.name="Hex Value";ti.width=.82;ti.addRowDefinition(1,!1);ti.addColumnDefinition(.1,!1);ti.addColumnDefinition(.9,!1);ni.addControl(ti,2,0);(si=new l).text="#";si.color=kt;si.fontSize=ft;ti.addControl(si,0,0);(o=new w).width=.96;o.height=.72;o.name="hexField";o.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER;o.fontSize=ft;tu=i.lastColor.split("#");o.text=tu[1];o.color="#f0f0f0";o.background="#454545";o.onFocusObservable.add(function(){e=o.name;ot=o.text;st(!1)});o.onBlurObservable.add(function(){if(3==o.text.length){var n=o.text.split("");o.text=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]}""==o.text&&(o.text="000000",yi(r.Color3.FromHexString(o.text),"b"));e==o.name&&(e="")});o.onTextChangedObservable.add(function(){var n=o.text,f=/[^0-9A-F]/i.test(n),u,i,t;if((o.text.length>6||f)&&e==o.name)o.text=ot;else{if(o.text.length<6)for(u=6-o.text.length,i=0;i<u;i++)n="0"+n;3==o.text.length&&(t=o.text.split(""),n=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);n="#"+n;e==o.name&&(ot=o.text,yi(r.Color3.FromHexString(n),o.name))}});ti.addControl(o,0,1);i.savedColors&&i.savedColors.length>0&&hr("",k)})},t._Epsilon=1e-6,t}(u),dt=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._thickness=1,i}return e(t,n),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(n){this._thickness!==n&&(this._thickness=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Ellipse"},t.prototype._localDraw=function(n){n.save();(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY);u.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,n);this._background&&(n.fillStyle=this._background,n.fill());(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0);this._thickness&&(this.color&&(n.strokeStyle=this.color),n.lineWidth=this._thickness,n.stroke());n.restore()},t.prototype._additionalProcessing=function(t,i){n.prototype._additionalProcessing.call(this,t,i);this._measureForChildren.width-=2*this._thickness;this._measureForChildren.height-=2*this._thickness;this._measureForChildren.left+=this._thickness;this._measureForChildren.top+=this._thickness},t.prototype._clipForChildren=function(n){u.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2,this._currentMeasure.height/2,n);n.clip()},t}(v),gt=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype._beforeRenderText=function(n){for(var t="",i=0;i<n.length;i++)t+="•";return t},t}(w),ni=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._lineWidth=1,i._x1=new f(0),i._y1=new f(0),i._x2=new f(0),i._y2=new f(0),i._dash=[],i.isHitTestVisible=!1,i._horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,i._verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,i}return e(t,n),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(n){this._dash!==n&&(this._dash=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connectedControl",{get:function(){return this._connectedControl},set:function(n){var t=this;this._connectedControl!==n&&(this._connectedControlDirtyObserver&&this._connectedControl&&(this._connectedControl.onDirtyObservable.remove(this._connectedControlDirtyObserver),this._connectedControlDirtyObserver=null),n&&(this._connectedControlDirtyObserver=n.onDirtyObservable.add(function(){return t._markAsDirty()})),this._connectedControl=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x1",{get:function(){return this._x1.toString(this._host)},set:function(n){this._x1.toString(this._host)!==n&&this._x1.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this._y1.toString(this._host)},set:function(n){this._y1.toString(this._host)!==n&&this._y1.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){return this._x2.toString(this._host)},set:function(n){this._x2.toString(this._host)!==n&&this._x2.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){return this._y2.toString(this._host)},set:function(n){this._y2.toString(this._host)!==n&&this._y2.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(n){this._lineWidth!==n&&(this._lineWidth=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveX2",{get:function(){return(this._connectedControl?this._connectedControl.centerX:0)+this._x2.getValue(this._host)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveY2",{get:function(){return(this._connectedControl?this._connectedControl.centerY:0)+this._y2.getValue(this._host)},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Line"},t.prototype._draw=function(n){n.save();(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY);this._applyStates(n);n.strokeStyle=this.color;n.lineWidth=this._lineWidth;n.setLineDash(this._dash);n.beginPath();n.moveTo(this._cachedParentMeasure.left+this._x1.getValue(this._host),this._cachedParentMeasure.left+this._y1.getValue(this._host));n.lineTo(this._cachedParentMeasure.left+this._effectiveX2,this._cachedParentMeasure.left+this._effectiveY2);n.stroke();n.restore()},t.prototype._measure=function(){this._currentMeasure.width=Math.abs(this._x1.getValue(this._host)-this._effectiveX2)+this._lineWidth;this._currentMeasure.height=Math.abs(this._y1.getValue(this._host)-this._effectiveY2)+this._lineWidth},t.prototype._computeAlignment=function(n){this._currentMeasure.left=n.left+Math.min(this._x1.getValue(this._host),this._effectiveX2)-this._lineWidth/2;this._currentMeasure.top=n.top+Math.min(this._y1.getValue(this._host),this._effectiveY2)-this._lineWidth/2},t.prototype.moveToVector3=function(n,t,i){if(void 0===i&&(i=!1),this._host&&this.parent===this._host._rootContainer){var f=this._host._getGlobalViewport(t),u=r.Vector3.Project(n,r.Matrix.Identity(),t.getTransformMatrix(),f);this._moveToProjectedPosition(u,i);this.notRenderable=u.z<0||u.z>1?!0:!1}else r.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},t.prototype._moveToProjectedPosition=function(n,t){void 0===t&&(t=!1);var i=n.x+this._linkOffsetX.getValue(this._host)+"px",r=n.y+this._linkOffsetY.getValue(this._host)+"px";t?(this.x2=i,this.y2=r,this._x2.ignoreAdaptiveScaling=!0,this._y2.ignoreAdaptiveScaling=!0):(this.x1=i,this.y1=r,this._x1.ignoreAdaptiveScaling=!0,this._y1.ignoreAdaptiveScaling=!0)},t}(u),et=function(){function n(n){this._multiLine=n;this._x=new f(0);this._y=new f(0);this._point=new r.Vector2(0,0)}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x.toString(this._multiLine._host)},set:function(n){this._x.toString(this._multiLine._host)!==n&&this._x.fromString(n)&&this._multiLine._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y.toString(this._multiLine._host)},set:function(n){this._y.toString(this._multiLine._host)!==n&&this._y.fromString(n)&&this._multiLine._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"control",{get:function(){return this._control},set:function(n){this._control!==n&&(this._control&&this._controlObserver&&(this._control.onDirtyObservable.remove(this._controlObserver),this._controlObserver=null),this._control=n,this._control&&(this._controlObserver=this._control.onDirtyObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mesh",{get:function(){return this._mesh},set:function(n){this._mesh!==n&&(this._mesh&&this._meshObserver&&this._mesh.getScene().onAfterCameraRenderObservable.remove(this._meshObserver),this._mesh=n,this._mesh&&(this._meshObserver=this._mesh.getScene().onAfterCameraRenderObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!0,configurable:!0}),n.prototype.resetLinks=function(){this.control=null;this.mesh=null},n.prototype.translate=function(){return this._point=this._translatePoint(),this._point},n.prototype._translatePoint=function(){if(null!=this._mesh)return this._multiLine._host.getProjectedPosition(this._mesh.getBoundingInfo().boundingSphere.center,this._mesh.getWorldMatrix());if(null!=this._control)return new r.Vector2(this._control.centerX,this._control.centerY);var n=this._multiLine._host,t=this._x.getValueInPixel(n,Number(n._canvas.width)),i=this._y.getValueInPixel(n,Number(n._canvas.height));return new r.Vector2(t,i)},n.prototype.dispose=function(){this.resetLinks()},n}(),ti=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._lineWidth=1,i.onPointUpdate=function(){i._markAsDirty()},i.isHitTestVisible=!1,i._horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,i._verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,i._dash=[],i._points=[],i}return e(t,n),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(n){this._dash!==n&&(this._dash=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype.getAt=function(n){return this._points[n]||(this._points[n]=new et(this)),this._points[n]},t.prototype.add=function(){for(var i=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map(function(n){return i.push(n)})},t.prototype.push=function(n){var t=this.getAt(this._points.length);return null==n?t:(n instanceof r.AbstractMesh?t.mesh=n:n instanceof u?t.control=n:null!=n.x&&null!=n.y&&(t.x=n.x,t.y=n.y),t)},t.prototype.remove=function(n){var t,i;if(n instanceof et){if(-1===(t=this._points.indexOf(n)))return}else t=n;i=this._points[t];i&&(i.dispose(),this._points.splice(t,1))},t.prototype.reset=function(){for(;this._points.length>0;)this.remove(this._points.length-1)},t.prototype.resetLinks=function(){this._points.forEach(function(n){null!=n&&n.resetLinks()})},Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(n){this._lineWidth!==n&&(this._lineWidth=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(){},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"MultiLine"},t.prototype._draw=function(n){n.save();(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY);this._applyStates(n);n.strokeStyle=this.color;n.lineWidth=this._lineWidth;n.setLineDash(this._dash);n.beginPath();var t=!0;this._points.forEach(function(i){i&&(t?(n.moveTo(i._point.x,i._point.y),t=!1):n.lineTo(i._point.x,i._point.y))});n.stroke();n.restore()},t.prototype._additionalProcessing=function(){var n=this;this._minX=null;this._minY=null;this._maxX=null;this._maxY=null;this._points.forEach(function(t){t&&(t.translate(),(null==n._minX||t._point.x<n._minX)&&(n._minX=t._point.x),(null==n._minY||t._point.y<n._minY)&&(n._minY=t._point.y),(null==n._maxX||t._point.x>n._maxX)&&(n._maxX=t._point.x),(null==n._maxY||t._point.y>n._maxY)&&(n._maxY=t._point.y))});null==this._minX&&(this._minX=0);null==this._minY&&(this._minY=0);null==this._maxX&&(this._maxX=0);null==this._maxY&&(this._maxY=0)},t.prototype._measure=function(){null!=this._minX&&null!=this._maxX&&null!=this._minY&&null!=this._maxY&&(this._currentMeasure.width=Math.abs(this._maxX-this._minX)+this._lineWidth,this._currentMeasure.height=Math.abs(this._maxY-this._minY)+this._lineWidth)},t.prototype._computeAlignment=function(){null!=this._minX&&null!=this._minY&&(this._currentMeasure.left=this._minX-this._lineWidth/2,this._currentMeasure.top=this._minY-this._lineWidth/2)},t.prototype.dispose=function(){this.reset();n.prototype.dispose.call(this)},t}(u),vt=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._isChecked=!1,i._background="black",i._checkSizeRatio=.8,i._thickness=1,i.group="",i.onIsCheckedChangedObservable=new r.Observable,i.isPointerBlocker=!0,i}return e(t,n),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(n){this._thickness!==n&&(this._thickness=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(n){n=Math.max(Math.min(1,n),0);this._checkSizeRatio!==n&&(this._checkSizeRatio=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(n){var t=this;this._isChecked!==n&&(this._isChecked=n,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(n),this._isChecked&&this._host&&this._host.executeOnAllControls(function(n){if(n!==t&&void 0!==n.group){var i=n;i.group===t.group&&(i.isChecked=!1)}}))},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"RadioButton"},t.prototype._draw=function(n){var t,i,r,f;n.save();this._applyStates(n);t=this._currentMeasure.width-this._thickness;i=this._currentMeasure.height-this._thickness;((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),u.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,n),n.fillStyle=this._isEnabled?this._background:this._disabledColor,n.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),n.strokeStyle=this.color,n.lineWidth=this._thickness,n.stroke(),this._isChecked)&&(n.fillStyle=this._isEnabled?this.color:this._disabledColor,r=t*this._checkSizeRatio,f=i*this._checkSizeRatio,u.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,r/2-this._thickness/2,f/2-this._thickness/2,n),n.fill());n.restore()},t.prototype._onPointerDown=function(t,i,r,u){return!!n.prototype._onPointerDown.call(this,t,i,r,u)&&(this.isChecked||(this.isChecked=!0),!0)},t.AddRadioButtonWithHeader=function(n,i,r,f){var s=new p,e,o;return s.isVertical=!1,s.height="30px",e=new t,e.width="20px",e.height="20px",e.isChecked=r,e.color="green",e.group=i,e.onIsCheckedChangedObservable.add(function(n){return f(e,n)}),s.addControl(e),o=new l,o.text=n,o.width="180px",o.paddingLeft="5px",o.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,o.color="white",s.addControl(o),s},t}(u),it=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._thumbWidth=new f(20,f.UNITMODE_PIXEL,!1),i._minimum=0,i._maximum=100,i._value=50,i._isVertical=!1,i._barOffset=new f(5,f.UNITMODE_PIXEL,!1),i._isThumbClamped=!1,i._displayThumb=!0,i._step=0,i._lastPointerDownID=-1,i._effectiveBarOffset=0,i.onValueChangedObservable=new r.Observable,i._pointerIsDown=!1,i.isPointerBlocker=!0,i}return e(t,n),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb},set:function(n){this._displayThumb!==n&&(this._displayThumb=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(n){this._step!==n&&(this._step=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"barOffset",{get:function(){return this._barOffset.toString(this._host)},set:function(n){this._barOffset.toString(this._host)!==n&&this._barOffset.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"barOffsetInPixels",{get:function(){return this._barOffset.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidth",{get:function(){return this._thumbWidth.toString(this._host)},set:function(n){this._thumbWidth.toString(this._host)!==n&&this._thumbWidth.fromString(n)&&this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidthInPixels",{get:function(){return this._thumbWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{get:function(){return this._minimum},set:function(n){this._minimum!==n&&(this._minimum=n,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(n){this._maximum!==n&&(this._maximum=n,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(n){n=Math.max(Math.min(n,this._maximum),this._minimum);this._value!==n&&(this._value=n,this._markAsDirty(),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(n){this._isVertical!==n&&(this._isVertical=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isThumbClamped",{get:function(){return this._isThumbClamped},set:function(n){this._isThumbClamped!==n&&(this._isThumbClamped=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"BaseSlider"},t.prototype._getThumbPosition=function(){return this.isVertical?(this.maximum-this.value)/(this.maximum-this.minimum)*this._backgroundBoxLength:(this.value-this.minimum)/(this.maximum-this.minimum)*this._backgroundBoxLength},t.prototype._getThumbThickness=function(n){var t=0;switch(n){case"circle":t=this._thumbWidth.isPixel?Math.max(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host);break;case"rectangle":t=this._thumbWidth.isPixel?Math.min(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)}return t},t.prototype._prepareRenderingData=function(n){this._effectiveBarOffset=0;this._renderLeft=this._currentMeasure.left;this._renderTop=this._currentMeasure.top;this._renderWidth=this._currentMeasure.width;this._renderHeight=this._currentMeasure.height;this._backgroundBoxLength=Math.max(this._currentMeasure.width,this._currentMeasure.height);this._backgroundBoxThickness=Math.min(this._currentMeasure.width,this._currentMeasure.height);this._effectiveThumbThickness=this._getThumbThickness(n);this.displayThumb&&(this._backgroundBoxLength-=this._effectiveThumbThickness);this.isVertical&&this._currentMeasure.height<this._currentMeasure.width?console.error("Height should be greater than width"):(this._effectiveBarOffset=this._barOffset.isPixel?Math.min(this._barOffset.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._barOffset.getValue(this._host),this._backgroundBoxThickness-=2*this._effectiveBarOffset,this.isVertical?(this._renderLeft+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderTop+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxLength,this._renderWidth=this._backgroundBoxThickness):(this._renderTop+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderLeft+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxThickness,this._renderWidth=this._backgroundBoxLength))},t.prototype._updateValueFromPointer=function(n,t){var i,r;0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(n,t,this._transformedPosition),n=this._transformedPosition.x,t=this._transformedPosition.y);i=this._isVertical?this._minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this._maximum-this._minimum):this._minimum+(n-this._currentMeasure.left)/this._currentMeasure.width*(this._maximum-this._minimum);r=1/this._step|0;this.value=this._step?(i*r|0)/r:i},t.prototype._onPointerDown=function(t,i,r,u){return!!n.prototype._onPointerDown.call(this,t,i,r,u)&&(this._pointerIsDown=!0,this._updateValueFromPointer(i.x,i.y),this._host._capturingControl[r]=this,this._lastPointerDownID=r,!0)},t.prototype._onPointerMove=function(t,i,r){r==this._lastPointerDownID&&(this._pointerIsDown&&this._updateValueFromPointer(i.x,i.y),n.prototype._onPointerMove.call(this,t,i,r))},t.prototype._onPointerUp=function(t,i,r,u,f){this._pointerIsDown=!1;delete this._host._capturingControl[r];n.prototype._onPointerUp.call(this,t,i,r,u,f)},t}(u),yt=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._background="black",i._borderColor="white",i._isThumbCircle=!1,i._displayValueBar=!0,i}return e(t,n),Object.defineProperty(t.prototype,"displayValueBar",{get:function(){return this._displayValueBar},set:function(n){this._displayValueBar!==n&&(this._displayValueBar=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(n){this._borderColor!==n&&(this._borderColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isThumbCircle",{get:function(){return this._isThumbCircle},set:function(n){this._isThumbCircle!==n&&(this._isThumbCircle=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Slider"},t.prototype._draw=function(n){var r;n.save();this._applyStates(n);this._prepareRenderingData(this.isThumbCircle?"circle":"rectangle");var t=this._renderLeft,i=this._renderTop,f=this._renderWidth,u=this._renderHeight,e=0;this.isThumbClamped&&this.isThumbCircle?(this.isVertical?i+=this._effectiveThumbThickness/2:t+=this._effectiveThumbThickness/2,e=this._backgroundBoxThickness/2):e=(this._effectiveThumbThickness-this._effectiveBarOffset)/2;(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY);r=this._getThumbPosition();n.fillStyle=this._background;this.isVertical?this.isThumbClamped?this.isThumbCircle?(n.beginPath(),n.arc(t+this._backgroundBoxThickness/2,i,e,Math.PI,2*Math.PI),n.fill(),n.fillRect(t,i,f,u)):n.fillRect(t,i,f,u+this._effectiveThumbThickness):n.fillRect(t,i,f,u):this.isThumbClamped?this.isThumbCircle?(n.beginPath(),n.arc(t+this._backgroundBoxLength,i+this._backgroundBoxThickness/2,e,0,2*Math.PI),n.fill(),n.fillRect(t,i,f,u)):n.fillRect(t,i,f+this._effectiveThumbThickness,u):n.fillRect(t,i,f,u);(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0);n.fillStyle=this.color;this._displayValueBar&&(this.isVertical?this.isThumbClamped?this.isThumbCircle?(n.beginPath(),n.arc(t+this._backgroundBoxThickness/2,i+this._backgroundBoxLength,e,0,2*Math.PI),n.fill(),n.fillRect(t,i+r,f,u-r)):n.fillRect(t,i+r,f,u-r+this._effectiveThumbThickness):n.fillRect(t,i+r,f,u-r):this.isThumbClamped&&this.isThumbCircle?(n.beginPath(),n.arc(t,i+this._backgroundBoxThickness/2,e,0,2*Math.PI),n.fill(),n.fillRect(t,i,r,u)):n.fillRect(t,i,r,u));this.displayThumb&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowColor=this.shadowColor,n.shadowBlur=this.shadowBlur,n.shadowOffsetX=this.shadowOffsetX,n.shadowOffsetY=this.shadowOffsetY),this._isThumbCircle?(n.beginPath(),this.isVertical?n.arc(t+this._backgroundBoxThickness/2,i+r,e,0,2*Math.PI):n.arc(t+r,i+this._backgroundBoxThickness/2,e,0,2*Math.PI),n.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),n.strokeStyle=this._borderColor,n.stroke()):(this.isVertical?n.fillRect(t-this._effectiveBarOffset,this._currentMeasure.top+r,this._currentMeasure.width,this._effectiveThumbThickness):n.fillRect(this._currentMeasure.left+r,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),n.strokeStyle=this._borderColor,this.isVertical?n.strokeRect(t-this._effectiveBarOffset,this._currentMeasure.top+r,this._currentMeasure.width,this._effectiveThumbThickness):n.strokeRect(this._currentMeasure.left+r,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height)));n.restore()},t}(it),rt=function(){function n(n){this.name=n;this._groupPanel=new p;this._selectors=[];this._groupPanel.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP;this._groupPanel.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;this._groupHeader=this._addGroupHeader(n)}return Object.defineProperty(n.prototype,"groupPanel",{get:function(){return this._groupPanel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectors",{get:function(){return this._selectors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"header",{get:function(){return this._groupHeader.text},set:function(n){"label"!==this._groupHeader.text&&(this._groupHeader.text=n)},enumerable:!0,configurable:!0}),n.prototype._addGroupHeader=function(n){var t=new l("groupHead",n);return t.width=.9,t.height="30px",t.textWrapping=!0,t.color="black",t.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,t.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,t.left="2px",this._groupPanel.addControl(t),t},n.prototype._getSelector=function(n){if(!(n<0||n>=this._selectors.length))return this._selectors[n]},n.prototype.removeSelector=function(n){n<0||n>=this._selectors.length||(this._groupPanel.removeControl(this._selectors[n]),this._selectors.splice(n,1))},n}(),ii=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.addCheckbox=function(n,t,i){var r,f;void 0===t&&(t=function(){});void 0===i&&(i=!1);i=i||!1;r=new at;r.width="20px";r.height="20px";r.color="#364249";r.background="#CCCCCC";r.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;r.onIsCheckedChangedObservable.add(function(n){t(n)});f=u.AddHeader(r,n,"200px",{isHorizontal:!0,controlFirst:!0});f.height="30px";f.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;f.left="4px";this.groupPanel.addControl(f);this.selectors.push(f);r.isChecked=i;this.groupPanel.parent&&this.groupPanel.parent.parent&&(r.color=this.groupPanel.parent.parent.buttonColor,r.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(n,t){this.selectors[n].children[1].text=t},t.prototype._setSelectorLabelColor=function(n,t){this.selectors[n].children[1].color=t},t.prototype._setSelectorButtonColor=function(n,t){this.selectors[n].children[0].color=t},t.prototype._setSelectorButtonBackground=function(n,t){this.selectors[n].children[0].background=t},t}(rt),ri=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t._selectNb=0,t}return e(t,n),t.prototype.addRadio=function(n,t,i){var e,r,f;void 0===t&&(t=function(){});void 0===i&&(i=!1);e=this._selectNb++;r=new vt;r.name=n;r.width="20px";r.height="20px";r.color="#364249";r.background="#CCCCCC";r.group=this.name;r.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;r.onIsCheckedChangedObservable.add(function(n){n&&t(e)});f=u.AddHeader(r,n,"200px",{isHorizontal:!0,controlFirst:!0});f.height="30px";f.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;f.left="4px";this.groupPanel.addControl(f);this.selectors.push(f);r.isChecked=i;this.groupPanel.parent&&this.groupPanel.parent.parent&&(r.color=this.groupPanel.parent.parent.buttonColor,r.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(n,t){this.selectors[n].children[1].text=t},t.prototype._setSelectorLabelColor=function(n,t){this.selectors[n].children[1].color=t},t.prototype._setSelectorButtonColor=function(n,t){this.selectors[n].children[0].color=t},t.prototype._setSelectorButtonBackground=function(n,t){this.selectors[n].children[0].background=t},t}(rt),ui=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.addSlider=function(n,t,i,r,f,e,o){var s,h;void 0===t&&(t=function(){});void 0===i&&(i="Units");void 0===r&&(r=0);void 0===f&&(f=0);void 0===e&&(e=0);void 0===o&&(o=function(n){return 0|n});s=new yt;s.name=i;s.value=e;s.minimum=r;s.maximum=f;s.width=.9;s.height="20px";s.color="#364249";s.background="#CCCCCC";s.borderColor="black";s.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;s.left="4px";s.paddingBottom="4px";s.onValueChangedObservable.add(function(n){s.parent.children[0].text=s.parent.children[0].name+": "+o(n)+" "+s.name;t(n)});h=u.AddHeader(s,n+": "+o(e)+" "+i,"30px",{isHorizontal:!1,controlFirst:!1});h.height="60px";h.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;h.left="4px";h.children[0].name=n;this.groupPanel.addControl(h);this.selectors.push(h);this.groupPanel.parent&&this.groupPanel.parent.parent&&(s.color=this.groupPanel.parent.parent.buttonColor,s.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(n,t){this.selectors[n].children[0].name=t;this.selectors[n].children[0].text=t+": "+this.selectors[n].children[1].value+" "+this.selectors[n].children[1].name},t.prototype._setSelectorLabelColor=function(n,t){this.selectors[n].children[0].color=t},t.prototype._setSelectorButtonColor=function(n,t){this.selectors[n].children[1].color=t},t.prototype._setSelectorButtonBackground=function(n,t){this.selectors[n].children[1].background=t},t}(rt),fi=function(n){function t(t,i){var r,f;if(void 0===i&&(i=[]),r=n.call(this,t)||this,r.name=t,r.groups=i,r._buttonColor="#364249",r._buttonBackground="#CCCCCC",r._headerColor="black",r._barColor="white",r._barHeight="2px",r._spacerHeight="20px",r._bars=[],r._groups=i,r.thickness=2,r._panel=new p,r._panel.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,r._panel.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,r._panel.top=5,r._panel.left=5,r._panel.width=.95,i.length>0){for(f=0;f<i.length-1;f++)r._panel.addControl(i[f].groupPanel),r._addSpacer();r._panel.addControl(i[i.length-1].groupPanel)}return r.addControl(r._panel),r}return e(t,n),t.prototype._getTypeName=function(){return"SelectionPanel"},Object.defineProperty(t.prototype,"headerColor",{get:function(){return this._headerColor},set:function(n){this._headerColor!==n&&(this._headerColor=n,this._setHeaderColor())},enumerable:!0,configurable:!0}),t.prototype._setHeaderColor=function(){for(var n=0;n<this._groups.length;n++)this._groups[n].groupPanel.children[0].color=this._headerColor},Object.defineProperty(t.prototype,"buttonColor",{get:function(){return this._buttonColor},set:function(n){this._buttonColor!==n&&(this._buttonColor=n,this._setbuttonColor())},enumerable:!0,configurable:!0}),t.prototype._setbuttonColor=function(){for(var t,n=0;n<this._groups.length;n++)for(t=0;t<this._groups[n].selectors.length;t++)this._groups[n]._setSelectorButtonColor(t,this._buttonColor)},Object.defineProperty(t.prototype,"labelColor",{get:function(){return this._labelColor},set:function(n){this._labelColor!==n&&(this._labelColor=n,this._setLabelColor())},enumerable:!0,configurable:!0}),t.prototype._setLabelColor=function(){for(var t,n=0;n<this._groups.length;n++)for(t=0;t<this._groups[n].selectors.length;t++)this._groups[n]._setSelectorLabelColor(t,this._labelColor)},Object.defineProperty(t.prototype,"buttonBackground",{get:function(){return this._buttonBackground},set:function(n){this._buttonBackground!==n&&(this._buttonBackground=n,this._setButtonBackground())},enumerable:!0,configurable:!0}),t.prototype._setButtonBackground=function(){for(var t,n=0;n<this._groups.length;n++)for(t=0;t<this._groups[n].selectors.length;t++)this._groups[n]._setSelectorButtonBackground(t,this._buttonBackground)},Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(n){this._barColor!==n&&(this._barColor=n,this._setBarColor())},enumerable:!0,configurable:!0}),t.prototype._setBarColor=function(){for(var n=0;n<this._bars.length;n++)this._bars[n].children[0].background=this._barColor},Object.defineProperty(t.prototype,"barHeight",{get:function(){return this._barHeight},set:function(n){this._barHeight!==n&&(this._barHeight=n,this._setBarHeight())},enumerable:!0,configurable:!0}),t.prototype._setBarHeight=function(){for(var n=0;n<this._bars.length;n++)this._bars[n].children[0].height=this._barHeight},Object.defineProperty(t.prototype,"spacerHeight",{get:function(){return this._spacerHeight},set:function(n){this._spacerHeight!==n&&(this._spacerHeight=n,this._setSpacerHeight())},enumerable:!0,configurable:!0}),t.prototype._setSpacerHeight=function(){for(var n=0;n<this._bars.length;n++)this._bars[n].height=this._spacerHeight},t.prototype._addSpacer=function(){var t=new v,n;t.width=1;t.height=this._spacerHeight;t.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;n=new a;n.width=1;n.height=this._barHeight;n.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT;n.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER;n.background=this._barColor;n.color="transparent";t.addControl(n);this._panel.addControl(t);this._bars.push(t)},t.prototype.addGroup=function(n){this._groups.length>0&&this._addSpacer();this._panel.addControl(n.groupPanel);this._groups.push(n);n.groupPanel.children[0].color=this._headerColor;for(var t=0;t<n.selectors.length;t++)n._setSelectorButtonColor(t,this._buttonColor),n._setSelectorButtonBackground(t,this._buttonBackground)},t.prototype.removeGroup=function(n){if(!(n<0||n>=this._groups.length)){var t=this._groups[n];this._panel.removeControl(t.groupPanel);this._groups.splice(n,1);n<this._bars.length&&(this._panel.removeControl(this._bars[n]),this._bars.splice(n,1))}},t.prototype.setHeaderName=function(n,t){t<0||t>=this._groups.length||(this._groups[t].groupPanel.children[0].text=n)},t.prototype.relabel=function(n,t,i){if(!(t<0||t>=this._groups.length)){var r=this._groups[t];i<0||i>=r.selectors.length||r._setSelectorLabel(i,n)}},t.prototype.removeFromGroupSelector=function(n,t){if(!(n<0||n>=this._groups.length)){var i=this._groups[n];t<0||t>=i.selectors.length||i.removeSelector(t)}},t.prototype.addToGroupCheckbox=function(n,t,i,r){(void 0===i&&(i=function(){}),void 0===r&&(r=!1),n<0||n>=this._groups.length)||this._groups[n].addCheckbox(t,i,r)},t.prototype.addToGroupRadio=function(n,t,i,r){(void 0===i&&(i=function(){}),void 0===r&&(r=!1),n<0||n>=this._groups.length)||this._groups[n].addRadio(t,i,r)},t.prototype.addToGroupSlider=function(n,t,i,r,u,f,e,o){(void 0===i&&(i=function(){}),void 0===r&&(r="Units"),void 0===u&&(u=0),void 0===f&&(f=0),void 0===e&&(e=0),void 0===o&&(o=function(n){return 0|n}),n<0||n>=this._groups.length)||this._groups[n].addSlider(t,i,r,u,f,e,o)},t}(a),ei=function(n){function t(t){return n.call(this,t)||this}return e(t,n),t.prototype._getTypeName=function(){return"ScrollViewerWindow"},t.prototype._additionalProcessing=function(t,i){n.prototype._additionalProcessing.call(this,t,i);this._measureForChildren.left=this._currentMeasure.left;this._measureForChildren.top=this._currentMeasure.top;this._measureForChildren.width=t.width;this._measureForChildren.height=t.height},t.prototype._postMeasure=function(){for(var t,i=this.parentClientWidth,r=this.parentClientHeight,e=0,o=this.children;e<o.length;e++)t=o[e],t.isVisible&&!t.notRenderable&&(t.horizontalAlignment===u.HORIZONTAL_ALIGNMENT_CENTER&&t._offsetLeft(this._currentMeasure.left-t._currentMeasure.left),t.verticalAlignment===u.VERTICAL_ALIGNMENT_CENTER&&t._offsetTop(this._currentMeasure.top-t._currentMeasure.top),i=Math.max(i,t._currentMeasure.left-this._currentMeasure.left+t._currentMeasure.width),r=Math.max(r,t._currentMeasure.top-this._currentMeasure.top+t._currentMeasure.height));this._currentMeasure.width!==i&&(this._width.updateInPlace(i,f.UNITMODE_PIXEL),this._currentMeasure.width=i,this._rebuildLayout=!0,this._isDirty=!0);this._currentMeasure.height!==r&&(this._height.updateInPlace(r,f.UNITMODE_PIXEL),this._currentMeasure.height=r,this._rebuildLayout=!0,this._isDirty=!0);n.prototype._postMeasure.call(this)},t}(v),ot=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._background="black",i._borderColor="white",i._thumbMeasure=new s(0,0,0,0),i}return e(t,n),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(n){this._borderColor!==n&&(this._borderColor=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"Scrollbar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(n){n.save();this._applyStates(n);this._prepareRenderingData("rectangle");var i=this._renderLeft,t=this._getThumbPosition();n.fillStyle=this._background;n.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);n.fillStyle=this.color;this.isVertical?(this._thumbMeasure.left=i-this._effectiveBarOffset,this._thumbMeasure.top=this._currentMeasure.top+t,this._thumbMeasure.width=this._currentMeasure.width,this._thumbMeasure.height=this._effectiveThumbThickness):(this._thumbMeasure.left=this._currentMeasure.left+t,this._thumbMeasure.top=this._currentMeasure.top,this._thumbMeasure.width=this._effectiveThumbThickness,this._thumbMeasure.height=this._currentMeasure.height);n.fillRect(this._thumbMeasure.left,this._thumbMeasure.top,this._thumbMeasure.width,this._thumbMeasure.height);n.restore()},t.prototype._updateValueFromPointer=function(n,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(n,t,this._transformedPosition),n=this._transformedPosition.x,t=this._transformedPosition.y);this._first&&(this._first=!1,this._originX=n,this._originY=t,(n<this._thumbMeasure.left||n>this._thumbMeasure.left+this._thumbMeasure.width||t<this._thumbMeasure.top||t>this._thumbMeasure.top+this._thumbMeasure.height)&&(this.value=this.isVertical?this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.minimum+(n-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var i=0;i=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(n-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness);this.value+=i*(this.maximum-this.minimum);this._originX=n;this._originY=t},t.prototype._onPointerDown=function(t,i,r,u){return this._first=!0,n.prototype._onPointerDown.call(this,t,i,r,u)},t}(it),oi=function(n){function t(t){var i=n.call(this,t)||this;return i._barSize=20,i._pointerIsOver=!1,i._wheelPrecision=.05,i.onDirtyObservable.add(function(){i._horizontalBarSpace.color=i.color;i._verticalBarSpace.color=i.color;i._dragSpace.color=i.color}),i.onPointerEnterObservable.add(function(){i._pointerIsOver=!0}),i.onPointerOutObservable.add(function(){i._pointerIsOver=!1}),i._grid=new h,i._horizontalBar=new ot,i._verticalBar=new ot,i._window=new ei,i._window.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,i._window.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,i._grid.addColumnDefinition(1),i._grid.addColumnDefinition(0,!0),i._grid.addRowDefinition(1),i._grid.addRowDefinition(0,!0),n.prototype.addControl.call(i,i._grid),i._grid.addControl(i._window,0,0),i._verticalBar.paddingLeft=0,i._verticalBar.width="100%",i._verticalBar.height="100%",i._verticalBar.barOffset=0,i._verticalBar.value=0,i._verticalBar.maximum=1,i._verticalBar.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,i._verticalBar.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,i._verticalBar.isVertical=!0,i._verticalBar.rotation=Math.PI,i._verticalBar.isVisible=!1,i._verticalBarSpace=new a,i._verticalBarSpace.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,i._verticalBarSpace.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,i._verticalBarSpace.thickness=1,i._grid.addControl(i._verticalBarSpace,0,1),i._verticalBarSpace.addControl(i._verticalBar),i._verticalBar.onValueChangedObservable.add(function(n){i._window.top=n*i._endTop+"px"}),i._horizontalBar.paddingLeft=0,i._horizontalBar.width="100%",i._horizontalBar.height="100%",i._horizontalBar.barOffset=0,i._horizontalBar.value=0,i._horizontalBar.maximum=1,i._horizontalBar.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_CENTER,i._horizontalBar.verticalAlignment=u.VERTICAL_ALIGNMENT_CENTER,i._horizontalBar.isVisible=!1,i._horizontalBarSpace=new a,i._horizontalBarSpace.horizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,i._horizontalBarSpace.verticalAlignment=u.VERTICAL_ALIGNMENT_TOP,i._horizontalBarSpace.thickness=1,i._grid.addControl(i._horizontalBarSpace,1,0),i._horizontalBarSpace.addControl(i._horizontalBar),i._horizontalBar.onValueChangedObservable.add(function(n){i._window.left=n*i._endLeft+"px"}),i._dragSpace=new a,i._dragSpace.thickness=1,i._grid.addControl(i._dragSpace,1,1),i.barColor="grey",i.barBackground="transparent",i}return e(t,n),Object.defineProperty(t.prototype,"horizontalBar",{get:function(){return this._horizontalBar},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalBar",{get:function(){return this._verticalBar},enumerable:!0,configurable:!0}),t.prototype.addControl=function(n){return n?(this._window.addControl(n),this):this},t.prototype.removeControl=function(n){return this._window.removeControl(n),this},Object.defineProperty(t.prototype,"children",{get:function(){return this._window.children},enumerable:!0,configurable:!0}),t.prototype._flagDescendantsAsMatrixDirty=function(){for(var n=0,t=this._children;n<t.length;n++)t[n]._markMatrixAsDirty()},t.prototype.resetWindow=function(){this._window.width="100%";this._window.height="100%"},t.prototype._getTypeName=function(){return"ScrollViewer"},t.prototype._buildClientSizes=function(){this._window.parentClientWidth=this._currentMeasure.width-(this._verticalBar.isVisible?this._barSize:0)-2*this.thickness;this._window.parentClientHeight=this._currentMeasure.height-(this._horizontalBar.isVisible?this._barSize:0)-2*this.thickness;this._clientWidth=this._window.parentClientWidth;this._clientHeight=this._window.parentClientHeight},t.prototype._additionalProcessing=function(t,i){n.prototype._additionalProcessing.call(this,t,i);this._buildClientSizes()},t.prototype._postMeasure=function(){n.prototype._postMeasure.call(this);this._updateScroller()},Object.defineProperty(t.prototype,"wheelPrecision",{get:function(){return this._wheelPrecision},set:function(n){this._wheelPrecision!==n&&(n<0&&(n=0),n>1&&(n=1),this._wheelPrecision=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(n){this._barColor!==n&&(this._barColor=n,this._horizontalBar.color=n,this._verticalBar.color=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"barSize",{get:function(){return this._barSize},set:function(n){this._barSize!==n&&(this._barSize=n,this._markAsDirty(),this._horizontalBar.isVisible&&this._grid.setRowDefinition(1,this._barSize,!0),this._verticalBar.isVisible&&this._grid.setColumnDefinition(1,this._barSize,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"barBackground",{get:function(){return this._barBackground},set:function(n){this._barBackground!==n&&(this._barBackground=n,this._horizontalBar.background=n,this._verticalBar.background=n,this._dragSpace.background=n)},enumerable:!0,configurable:!0}),t.prototype._updateScroller=function(){var n=this._window._currentMeasure.width,t=this._window._currentMeasure.height,i,r,u,f;this._horizontalBar.isVisible&&n<=this._clientWidth?(this._grid.setRowDefinition(1,0,!0),this._horizontalBar.isVisible=!1,this._horizontalBar.value=0,this._rebuildLayout=!0):!this._horizontalBar.isVisible&&n>this._clientWidth&&(this._grid.setRowDefinition(1,this._barSize,!0),this._horizontalBar.isVisible=!0,this._rebuildLayout=!0);this._verticalBar.isVisible&&t<=this._clientHeight?(this._grid.setColumnDefinition(1,0,!0),this._verticalBar.isVisible=!1,this._verticalBar.value=0,this._rebuildLayout=!0):!this._verticalBar.isVisible&&t>this._clientHeight&&(this._grid.setColumnDefinition(1,this._barSize,!0),this._verticalBar.isVisible=!0,this._rebuildLayout=!0);this._buildClientSizes();this._endLeft=this._clientWidth-n;this._endTop=this._clientHeight-t;i=this._horizontalBar.value*this._endLeft+"px";r=this._verticalBar.value*this._endTop+"px";i!==this._window.left&&(this._window.left=i,this._rebuildLayout=!0);r!==this._window.top&&(this._window.top=r,this._rebuildLayout=!0);u=this._clientWidth/n;f=this._clientHeight/t;this._horizontalBar.thumbWidth=this._clientWidth*u+"px";this._verticalBar.thumbWidth=this._clientHeight*f+"px"},t.prototype._link=function(t){n.prototype._link.call(this,t);this._attachWheel()},t.prototype._attachWheel=function(){var n=this,t;this._host&&!this._onPointerObserver&&(t=this._host.getScene(),this._onPointerObserver=t.onPointerObservable.add(function(t){n._pointerIsOver&&t.type===r.PointerEventTypes.POINTERWHEEL&&(1==n._verticalBar.isVisible&&(t.event.deltaY<0&&n._verticalBar.value>0?n._verticalBar.value-=n._wheelPrecision:t.event.deltaY>0&&n._verticalBar.value<n._verticalBar.maximum&&(n._verticalBar.value+=n._wheelPrecision)),1==n._horizontalBar.isVisible&&(t.event.deltaX<0&&n._horizontalBar.value<n._horizontalBar.maximum?n._horizontalBar.value+=n._wheelPrecision:t.event.deltaX>0&&n._horizontalBar.value>0&&(n._horizontalBar.value-=n._wheelPrecision)))}))},t.prototype._renderHighlightSpecific=function(t){this.isHighlighted&&(n.prototype._renderHighlightSpecific.call(this,t),this._grid._renderHighlightSpecific(t),t.restore())},t.prototype.dispose=function(){var t=this._host.getScene();t&&this._onPointerObserver&&(t.onPointerObservable.remove(this._onPointerObserver),this._onPointerObserver=null);n.prototype.dispose.call(this)},t}(a),si=function(){return function(){}}(),hi=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.onKeyPressObservable=new r.Observable,t.defaultButtonWidth="40px",t.defaultButtonHeight="40px",t.defaultButtonPaddingLeft="2px",t.defaultButtonPaddingRight="2px",t.defaultButtonPaddingTop="2px",t.defaultButtonPaddingBottom="2px",t.defaultButtonColor="#DDD",t.defaultButtonBackground="#070707",t.shiftButtonColor="#7799FF",t.selectedShiftThickness=1,t.shiftState=0,t._currentlyConnectedInputText=null,t._connectedInputTexts=[],t._onKeyPressObserver=null,t}return e(t,n),t.prototype._getTypeName=function(){return"VirtualKeyboard"},t.prototype._createKey=function(n,t){var r=this,i=y.CreateSimpleButton(n,n);return i.width=t&&t.width?t.width:this.defaultButtonWidth,i.height=t&&t.height?t.height:this.defaultButtonHeight,i.color=t&&t.color?t.color:this.defaultButtonColor,i.background=t&&t.background?t.background:this.defaultButtonBackground,i.paddingLeft=t&&t.paddingLeft?t.paddingLeft:this.defaultButtonPaddingLeft,i.paddingRight=t&&t.paddingRight?t.paddingRight:this.defaultButtonPaddingRight,i.paddingTop=t&&t.paddingTop?t.paddingTop:this.defaultButtonPaddingTop,i.paddingBottom=t&&t.paddingBottom?t.paddingBottom:this.defaultButtonPaddingBottom,i.thickness=0,i.isFocusInvisible=!0,i.shadowColor=this.shadowColor,i.shadowBlur=this.shadowBlur,i.shadowOffsetX=this.shadowOffsetX,i.shadowOffsetY=this.shadowOffsetY,i.onPointerUpObservable.add(function(){r.onKeyPressObservable.notifyObservers(n)}),i},t.prototype.addKeysRow=function(n,t){var r=new p,i,u,e,f;for(r.isVertical=!1,r.isFocusInvisible=!0,i=null,u=0;u<n.length;u++)e=null,t&&t.length===n.length&&(e=t[u]),f=this._createKey(n[u],e),(!i||f.heightInPixels>i.heightInPixels)&&(i=f),r.addControl(f);r.height=i?i.height:this.defaultButtonHeight;this.addControl(r)},t.prototype.applyShiftState=function(n){var r,u,e,f,t,i;if(this.children)for(r=0;r<this.children.length;r++)if(u=this.children[r],u&&u.children)for(e=u,f=0;f<e.children.length;f++)t=e.children[f],t&&t.children[0]&&(i=t.children[0],"⇧"===i.text&&(t.color=n?this.shiftButtonColor:this.defaultButtonColor,t.thickness=n>1?this.selectedShiftThickness:0),i.text=n>0?i.text.toUpperCase():i.text.toLowerCase())},Object.defineProperty(t.prototype,"connectedInputText",{get:function(){return this._currentlyConnectedInputText},enumerable:!0,configurable:!0}),t.prototype.connect=function(n){var t=this,i,r;this._connectedInputTexts.some(function(t){return t.input===n})||(null===this._onKeyPressObserver&&(this._onKeyPressObserver=this.onKeyPressObservable.add(function(n){if(t._currentlyConnectedInputText){switch(t._currentlyConnectedInputText._host.focusedControl=t._currentlyConnectedInputText,n){case"⇧":return t.shiftState++,t.shiftState>2&&(t.shiftState=0),void t.applyShiftState(t.shiftState);case"←":return void t._currentlyConnectedInputText.processKey(8);case"↵":return void t._currentlyConnectedInputText.processKey(13)}t._currentlyConnectedInputText.processKey(-1,t.shiftState?n.toUpperCase():n);1===t.shiftState&&(t.shiftState=0,t.applyShiftState(t.shiftState))}})),this.isVisible=!1,this._currentlyConnectedInputText=n,n._connectedVirtualKeyboard=this,i=n.onFocusObservable.add(function(){t._currentlyConnectedInputText=n;n._connectedVirtualKeyboard=t;t.isVisible=!0}),r=n.onBlurObservable.add(function(){n._connectedVirtualKeyboard=null;t._currentlyConnectedInputText=null;t.isVisible=!1}),this._connectedInputTexts.push({input:n,onBlurObserver:r,onFocusObserver:i}))},t.prototype.disconnect=function(n){var i=this,t;n?(t=this._connectedInputTexts.filter(function(t){return t.input===n}),1===t.length&&(this._removeConnectedInputObservables(t[0]),this._connectedInputTexts=this._connectedInputTexts.filter(function(t){return t.input!==n}),this._currentlyConnectedInputText===n&&(this._currentlyConnectedInputText=null))):(this._connectedInputTexts.forEach(function(n){i._removeConnectedInputObservables(n)}),this._connectedInputTexts=[]);0===this._connectedInputTexts.length&&(this._currentlyConnectedInputText=null,this.onKeyPressObservable.remove(this._onKeyPressObserver),this._onKeyPressObserver=null)},t.prototype._removeConnectedInputObservables=function(n){n.input._connectedVirtualKeyboard=null;n.input.onFocusObservable.remove(n.onFocusObserver);n.input.onBlurObservable.remove(n.onBlurObserver)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this.disconnect()},t.CreateDefaultLayout=function(n){var i=new t(n);return i.addKeysRow(["1","2","3","4","5","6","7","8","9","0","←"]),i.addKeysRow(["q","w","e","r","t","y","u","i","o","p"]),i.addKeysRow(["a","s","d","f","g","h","j","k","l",";","'","↵"]),i.addKeysRow(["⇧","z","x","c","v","b","n","m",",",".","/"]),i.addKeysRow([" "],[{width:"200px"}]),i},t}(p),ci=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._cellWidth=20,i._cellHeight=20,i._minorLineTickness=1,i._minorLineColor="DarkGray",i._majorLineTickness=2,i._majorLineColor="White",i._majorLineFrequency=5,i._background="Black",i._displayMajorLines=!0,i._displayMinorLines=!0,i}return e(t,n),Object.defineProperty(t.prototype,"displayMinorLines",{get:function(){return this._displayMinorLines},set:function(n){this._displayMinorLines!==n&&(this._displayMinorLines=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMajorLines",{get:function(){return this._displayMajorLines},set:function(n){this._displayMajorLines!==n&&(this._displayMajorLines=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(n){this._cellWidth=n;this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(n){this._cellHeight=n;this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minorLineTickness",{get:function(){return this._minorLineTickness},set:function(n){this._minorLineTickness=n;this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minorLineColor",{get:function(){return this._minorLineColor},set:function(n){this._minorLineColor=n;this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"majorLineTickness",{get:function(){return this._majorLineTickness},set:function(n){this._majorLineTickness=n;this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"majorLineColor",{get:function(){return this._majorLineColor},set:function(n){this._majorLineColor=n;this._markAsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"majorLineFrequency",{get:function(){return this._majorLineFrequency},set:function(n){this._majorLineFrequency=n;this._markAsDirty()},enumerable:!0,configurable:!0}),t.prototype._draw=function(n){var t,r,i,u;if(n.save(),this._applyStates(n),this._isEnabled){this._background&&(n.fillStyle=this._background,n.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height));var f=this._currentMeasure.width/this._cellWidth,e=this._currentMeasure.height/this._cellHeight,o=this._currentMeasure.left+this._currentMeasure.width/2,s=this._currentMeasure.top+this._currentMeasure.height/2;if(this._displayMinorLines){for(n.strokeStyle=this._minorLineColor,n.lineWidth=this._minorLineTickness,t=-f/2;t<f/2;t++)r=o+t*this.cellWidth,n.beginPath(),n.moveTo(r,this._currentMeasure.top),n.lineTo(r,this._currentMeasure.top+this._currentMeasure.height),n.stroke();for(i=-e/2;i<e/2;i++)u=s+i*this.cellHeight,n.beginPath(),n.moveTo(this._currentMeasure.left,u),n.lineTo(this._currentMeasure.left+this._currentMeasure.width,u),n.stroke()}if(this._displayMajorLines){for(n.strokeStyle=this._majorLineColor,n.lineWidth=this._majorLineTickness,t=-f/2+this._majorLineFrequency;t<f/2;t+=this._majorLineFrequency)r=o+t*this.cellWidth,n.beginPath(),n.moveTo(r,this._currentMeasure.top),n.lineTo(r,this._currentMeasure.top+this._currentMeasure.height),n.stroke();for(i=-e/2+this._majorLineFrequency;i<e/2;i+=this._majorLineFrequency)u=s+i*this.cellHeight,n.moveTo(this._currentMeasure.left,u),n.lineTo(this._currentMeasure.left+this._currentMeasure.width,u),n.closePath(),n.stroke()}}n.restore()},t.prototype._getTypeName=function(){return"DisplayGrid"},t}(u),li=function(n){function t(t){var i=n.call(this,t)||this;return i.name=t,i._tempMeasure=new s(0,0,0,0),i}return e(t,n),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb&&null!=this.thumbImage},set:function(n){this._displayThumb!==n&&(this._displayThumb=n,this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundImage},set:function(n){var t=this;this._backgroundImage!==n&&(this._backgroundImage=n,n&&!n.isLoaded&&n.onImageLoadedObservable.addOnce(function(){return t._markAsDirty()}),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueBarImage",{get:function(){return this._valueBarImage},set:function(n){var t=this;this._valueBarImage!==n&&(this._valueBarImage=n,n&&!n.isLoaded&&n.onImageLoadedObservable.addOnce(function(){return t._markAsDirty()}),this._markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbImage},set:function(n){var t=this;this._thumbImage!==n&&(this._thumbImage=n,n&&!n.isLoaded&&n.onImageLoadedObservable.addOnce(function(){return t._markAsDirty()}),this._markAsDirty())},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"ImageBasedSlider"},t.prototype._draw=function(n){n.save();this._applyStates(n);this._prepareRenderingData("rectangle");var t=this._getThumbPosition(),i=this._renderLeft,r=this._renderTop,f=this._renderWidth,u=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(i,r,f,u),this.isThumbClamped&&this.displayThumb&&(this.isVertical?this._tempMeasure.height+=this._effectiveThumbThickness:this._tempMeasure.width+=this._effectiveThumbThickness),this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure),this._backgroundImage._draw(n));this._valueBarImage&&(this.isVertical?this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(i,r+t,f,u-t+this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(i,r+t,f,u-t):this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(i,r,t+this._effectiveThumbThickness/2,u):this._tempMeasure.copyFromFloats(i,r,t,u),this._valueBarImage._currentMeasure.copyFrom(this._tempMeasure),this._valueBarImage._draw(n));this.displayThumb&&(this.isVertical?this._tempMeasure.copyFromFloats(i-this._effectiveBarOffset,this._currentMeasure.top+t,this._currentMeasure.width,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+t,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(n));n.restore()},t}(it);u.AddHeader=function(n,t,i,r){var e=new p("panel"),o=!r||r.isHorizontal,s=!r||r.controlFirst,f;return e.isVertical=!o,f=new l("header"),f.text=t,f.textHorizontalAlignment=u.HORIZONTAL_ALIGNMENT_LEFT,o?f.width=i:f.height=i,s?(e.addControl(n),e.addControl(f),f.paddingLeft="5px"):(e.addControl(f),e.addControl(n),f.paddingRight="5px"),f.shadowBlur=n.shadowBlur,f.shadowColor=n.shadowColor,f.shadowOffsetX=n.shadowOffsetX,f.shadowOffsetY=n.shadowOffsetY,e};var pt=function(){function n(n){this._fontFamily="Arial";this._fontStyle="";this._fontWeight="";this._fontSize=new f(18,f.UNITMODE_PIXEL,!1);this.onChangedObservable=new r.Observable;this._host=n}return Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(n){this._fontSize.toString(this._host)!==n&&this._fontSize.fromString(n)&&this.onChangedObservable.notifyObservers(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(n){this._fontFamily!==n&&(this._fontFamily=n,this.onChangedObservable.notifyObservers(this))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(n){this._fontStyle!==n&&(this._fontStyle=n,this.onChangedObservable.notifyObservers(this))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(n){this._fontWeight!==n&&(this._fontWeight=n,this.onChangedObservable.notifyObservers(this))},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this.onChangedObservable.clear()},n}(),st=function(n){function t(t,i,u,f,e,o){void 0===i&&(i=0);void 0===u&&(u=0);void 0===e&&(e=!1);void 0===o&&(o=r.Texture.NEAREST_SAMPLINGMODE);var h=n.call(this,t,{width:i,height:u},f,e,o,r.Engine.TEXTUREFORMAT_RGBA)||this;return h._isDirty=!1,h._rootContainer=new v("root"),h._lastControlOver={},h._lastControlDown={},h._capturingControl={},h._linkedControls=[],h._isFullscreen=!1,h._fullscreenViewport=new r.Viewport(0,0,1,1),h._idealWidth=0,h._idealHeight=0,h._useSmallestIdeal=!1,h._renderAtIdealSize=!1,h._blockNextFocusCheck=!1,h._renderScale=1,h._cursorChanged=!1,h._clipboardData="",h.onClipboardObservable=new r.Observable,h.onControlPickedObservable=new r.Observable,h.onBeginLayoutObservable=new r.Observable,h.onEndLayoutObservable=new r.Observable,h.onBeginRenderObservable=new r.Observable,h.onEndRenderObservable=new r.Observable,h.premulAlpha=!1,h._useInvalidateRectOptimization=!0,h._invalidatedRectangle=null,h._clearMeasure=new s(0,0,0,0),h.onClipboardCopy=function(n){var t=n,i=new r.ClipboardInfo(r.ClipboardEventTypes.COPY,t);h.onClipboardObservable.notifyObservers(i);t.preventDefault()},h.onClipboardCut=function(n){var t=n,i=new r.ClipboardInfo(r.ClipboardEventTypes.CUT,t);h.onClipboardObservable.notifyObservers(i);t.preventDefault()},h.onClipboardPaste=function(n){var t=n,i=new r.ClipboardInfo(r.ClipboardEventTypes.PASTE,t);h.onClipboardObservable.notifyObservers(i);t.preventDefault()},(f=h.getScene())&&h._texture?(h._rootCanvas=f.getEngine().getRenderingCanvas(),h._renderObserver=f.onBeforeCameraRenderObservable.add(function(n){return h._checkUpdate(n)}),h._preKeyboardObserver=f.onPreKeyboardObservable.add(function(n){h._focusedControl&&(n.type===r.KeyboardEventTypes.KEYDOWN&&h._focusedControl.processKeyboard(n.event),n.skipOnPointerObservable=!0)}),h._rootContainer._link(h),h.hasAlpha=!0,i&&u||(h._resizeObserver=f.getEngine().onResizeObservable.add(function(){return h._onResize()}),h._onResize()),h._texture.isReady=!0,h):h}return e(t,n),Object.defineProperty(t.prototype,"renderScale",{get:function(){return this._renderScale},set:function(n){n!==this._renderScale&&(this._renderScale=n,this._onResize())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(n){this._background!==n&&(this._background=n,this.markAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idealWidth",{get:function(){return this._idealWidth},set:function(n){this._idealWidth!==n&&(this._idealWidth=n,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idealHeight",{get:function(){return this._idealHeight},set:function(n){this._idealHeight!==n&&(this._idealHeight=n,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useSmallestIdeal",{get:function(){return this._useSmallestIdeal},set:function(n){this._useSmallestIdeal!==n&&(this._useSmallestIdeal=n,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderAtIdealSize",{get:function(){return this._renderAtIdealSize},set:function(n){this._renderAtIdealSize!==n&&(this._renderAtIdealSize=n,this._onResize())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layer",{get:function(){return this._layerToDispose},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!0,configurable:!0}),t.prototype.getChildren=function(){return[this._rootContainer]},t.prototype.getDescendants=function(n,t){return this._rootContainer.getDescendants(n,t)},Object.defineProperty(t.prototype,"focusedControl",{get:function(){return this._focusedControl},set:function(n){this._focusedControl!=n&&(this._focusedControl&&this._focusedControl.onBlur(),n&&n.onFocus(),this._focusedControl=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isForeground",{get:function(){return!this.layer||!this.layer.isBackground},set:function(n){this.layer&&this.layer.isBackground!==!n&&(this.layer.isBackground=!n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clipboardData",{get:function(){return this._clipboardData},set:function(n){this._clipboardData=n},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"AdvancedDynamicTexture"},t.prototype.executeOnAllControls=function(n,t){var i,u,r;for(t||(t=this._rootContainer),n(t),i=0,u=t.children;i<u.length;i++)r=u[i],r.children?this.executeOnAllControls(n,r):n(r)},Object.defineProperty(t.prototype,"useInvalidateRectOptimization",{get:function(){return this._useInvalidateRectOptimization},set:function(n){this._useInvalidateRectOptimization=n},enumerable:!0,configurable:!0}),t.prototype.invalidateRect=function(n,t,i,r){if(this._useInvalidateRectOptimization)if(this._invalidatedRectangle){var u=Math.ceil(Math.max(this._invalidatedRectangle.left+this._invalidatedRectangle.width-1,i)),f=Math.ceil(Math.max(this._invalidatedRectangle.top+this._invalidatedRectangle.height-1,r));this._invalidatedRectangle.left=Math.floor(Math.min(this._invalidatedRectangle.left,n));this._invalidatedRectangle.top=Math.floor(Math.min(this._invalidatedRectangle.top,t));this._invalidatedRectangle.width=u-this._invalidatedRectangle.left+1;this._invalidatedRectangle.height=f-this._invalidatedRectangle.top+1}else this._invalidatedRectangle=new s(n,t,i-n+1,r-t+1)},t.prototype.markAsDirty=function(){this._isDirty=!0},t.prototype.createStyle=function(){return new pt(this)},t.prototype.addControl=function(n){return this._rootContainer.addControl(n),this},t.prototype.removeControl=function(n){return this._rootContainer.removeControl(n),this},t.prototype.dispose=function(){var t=this.getScene();t&&(this._rootCanvas=null,t.onBeforeCameraRenderObservable.remove(this._renderObserver),this._resizeObserver&&t.getEngine().onResizeObservable.remove(this._resizeObserver),this._pointerMoveObserver&&t.onPrePointerObservable.remove(this._pointerMoveObserver),this._pointerObserver&&t.onPointerObservable.remove(this._pointerObserver),this._preKeyboardObserver&&t.onPreKeyboardObservable.remove(this._preKeyboardObserver),this._canvasPointerOutObserver&&t.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver),this._layerToDispose&&(this._layerToDispose.texture=null,this._layerToDispose.dispose(),this._layerToDispose=null),this._rootContainer.dispose(),this.onClipboardObservable.clear(),this.onControlPickedObservable.clear(),this.onBeginRenderObservable.clear(),this.onEndRenderObservable.clear(),this.onBeginLayoutObservable.clear(),this.onEndLayoutObservable.clear(),n.prototype.dispose.call(this))},t.prototype._onResize=function(){var r=this.getScene();if(r){var u=r.getEngine(),i=this.getSize(),n=u.getRenderWidth()*this._renderScale,t=u.getRenderHeight()*this._renderScale;this._renderAtIdealSize&&(this._idealWidth?(t=t*this._idealWidth/n,n=this._idealWidth):this._idealHeight&&(n=n*this._idealHeight/t,t=this._idealHeight));i.width===n&&i.height===t||(this.scaleTo(n,t),this.markAsDirty(),(this._idealWidth||this._idealHeight)&&this._rootContainer._markAllAsDirty());this.invalidateRect(0,0,i.width-1,i.height-1)}},t.prototype._getGlobalViewport=function(n){var t=n.getEngine();return this._fullscreenViewport.toGlobal(t.getRenderWidth(),t.getRenderHeight())},t.prototype.getProjectedPosition=function(n,t){var u=this.getScene(),f,i;return u?(f=this._getGlobalViewport(u),i=r.Vector3.Project(n,t,u.getTransformMatrix(),f),i.scaleInPlace(this.renderScale),new r.Vector2(i.x,i.y)):r.Vector2.Zero()},t.prototype._checkUpdate=function(n){var f,t,i,s,u;if(!this._layerToDispose||0!=(n.layerMask&this._layerToDispose.layerMask)){if(this._isFullscreen&&this._linkedControls.length){if(f=this.getScene(),!f)return;for(var h=this._getGlobalViewport(f),e=0,o=this._linkedControls;e<o.length;e++)t=o[e],t.isVisible&&(i=t._linkedMesh,i&&!i.isDisposed()?(s=i.getBoundingInfo?i.getBoundingInfo().boundingSphere.center:i.getAbsolutePosition(),u=r.Vector3.Project(s,i.getWorldMatrix(),f.getTransformMatrix(),h),u.z<0||u.z>1?t.notRenderable=!0:(t.notRenderable=!1,u.scaleInPlace(this.renderScale),t._moveToProjectedPosition(u))):r.Tools.SetImmediate(function(){t.linkWithMesh(null)}))}(this._isDirty||this._rootContainer.isDirty)&&(this._isDirty=!1,this._render(),this.update(!0,this.premulAlpha))}},t.prototype._render=function(){var t=this.getSize(),i=t.width,r=t.height,n=this.getContext(),u;n.font="18px Arial";n.strokeStyle="white";this.onBeginLayoutObservable.notifyObservers(this);u=new s(0,0,i,r);this._rootContainer._layout(u,n);this.onEndLayoutObservable.notifyObservers(this);this._isDirty=!1;this._invalidatedRectangle?this._clearMeasure.copyFrom(this._invalidatedRectangle):this._clearMeasure.copyFromFloats(0,0,i,r);n.clearRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height);this._background&&(n.save(),n.fillStyle=this._background,n.fillRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),n.restore());this.onBeginRenderObservable.notifyObservers(this);this._rootContainer._render(n,this._invalidatedRectangle);this.onEndRenderObservable.notifyObservers(this);this._invalidatedRectangle=null},t.prototype._changeCursor=function(n){this._rootCanvas&&(this._rootCanvas.style.cursor=n,this._cursorChanged=!0)},t.prototype._registerLastControlDown=function(n,t){this._lastControlDown[t]=n;this.onControlPickedObservable.notifyObservers(n)},t.prototype._doPicking=function(n,t,i,u,f){var e=this.getScene(),o,s,h;e&&(o=e.getEngine(),s=this.getSize(),this._isFullscreen&&(h=(e.cameraToUseForPointers||e.activeCamera).viewport,n*=s.width/(o.getRenderWidth()*h.width),t*=s.height/(o.getRenderHeight()*h.height)),this._capturingControl[u]?this._capturingControl[u]._processObservables(i,n,t,u,f):(this._cursorChanged=!1,this._rootContainer._processPicking(n,t,i,u,f)||(this._changeCursor(""),i===r.PointerEventTypes.POINTERMOVE&&this._lastControlOver[u]&&(this._lastControlOver[u]._onPointerOut(this._lastControlOver[u]),delete this._lastControlOver[u])),this._cursorChanged||this._changeCursor(""),this._manageFocus()))},t.prototype._cleanControlAfterRemovalFromList=function(n,t){for(var i in n)n.hasOwnProperty(i)&&n[i]===t&&delete n[i]},t.prototype._cleanControlAfterRemoval=function(n){this._cleanControlAfterRemovalFromList(this._lastControlDown,n);this._cleanControlAfterRemovalFromList(this._lastControlOver,n)},t.prototype.attach=function(){var i=this,n=this.getScene(),t;n&&(t=new r.Viewport(0,0,0,0),this._pointerMoveObserver=n.onPrePointerObservable.add(function(u){var e,f,o,s;!n.isPointerCaptured(u.event.pointerId)&&(u.type===r.PointerEventTypes.POINTERMOVE||u.type===r.PointerEventTypes.POINTERUP||u.type===r.PointerEventTypes.POINTERDOWN)&&n&&(e=n.cameraToUseForPointers||n.activeCamera,f=n.getEngine(),e?e.viewport.toGlobalToRef(f.getRenderWidth(),f.getRenderHeight(),t):(t.x=0,t.y=0,t.width=f.getRenderWidth(),t.height=f.getRenderHeight()),o=n.pointerX/f.getHardwareScalingLevel()-t.x,s=n.pointerY/f.getHardwareScalingLevel()-(f.getRenderHeight()-t.y-t.height),i._shouldBlockPointer=!1,i._doPicking(o,s,u.type,u.event.pointerId||0,u.event.button),i._shouldBlockPointer&&(u.skipOnPointerObservable=i._shouldBlockPointer))}),this._attachToOnPointerOut(n))},t.prototype.registerClipboardEvents=function(){self.addEventListener("copy",this.onClipboardCopy,!1);self.addEventListener("cut",this.onClipboardCut,!1);self.addEventListener("paste",this.onClipboardPaste,!1)},t.prototype.unRegisterClipboardEvents=function(){self.removeEventListener("copy",this.onClipboardCopy);self.removeEventListener("cut",this.onClipboardCut);self.removeEventListener("paste",this.onClipboardPaste)},t.prototype.attachToMesh=function(n,t){var i=this,u;void 0===t&&(t=!0);u=this.getScene();u&&(this._pointerObserver=u.onPointerObservable.add(function(t){var u,f,s,h,c,e,l,o,a;if(t.type===r.PointerEventTypes.POINTERMOVE||t.type===r.PointerEventTypes.POINTERUP||t.type===r.PointerEventTypes.POINTERDOWN)if(u=t.event.pointerId||0,t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh===n)f=t.pickInfo.getTextureCoordinates(),f&&(s=i.getSize(),i._doPicking(f.x*s.width,(1-f.y)*s.height,t.type,u,t.event.button));else if(t.type===r.PointerEventTypes.POINTERUP){if(i._lastControlDown[u]&&i._lastControlDown[u]._forcePointerUp(u),delete i._lastControlDown[u],i.focusedControl){if(h=i.focusedControl.keepsFocusWith(),c=!0,h)for(e=0,l=h;e<l.length;e++)if(o=l[e],i!==o._host&&(a=o._host,a._lastControlOver[u]&&a._lastControlOver[u].isAscendant(o))){c=!1;break}c&&(i.focusedControl=null)}}else t.type===r.PointerEventTypes.POINTERMOVE&&(i._lastControlOver[u]&&i._lastControlOver[u]._onPointerOut(i._lastControlOver[u],!0),delete i._lastControlOver[u])}),n.enablePointerMoveEvents=t,this._attachToOnPointerOut(u))},t.prototype.moveFocusToControl=function(n){this.focusedControl=n;this._lastPickedControl=n;this._blockNextFocusCheck=!0},t.prototype._manageFocus=function(){if(this._blockNextFocusCheck)return this._blockNextFocusCheck=!1,void(this._lastPickedControl=this._focusedControl);if(this._focusedControl&&this._focusedControl!==this._lastPickedControl){if(this._lastPickedControl.isFocusInvisible)return;this.focusedControl=null}},t.prototype._attachToOnPointerOut=function(n){var t=this;this._canvasPointerOutObserver=n.getEngine().onCanvasPointerOutObservable.add(function(n){t._lastControlOver[n.pointerId]&&t._lastControlOver[n.pointerId]._onPointerOut(t._lastControlOver[n.pointerId]);delete t._lastControlOver[n.pointerId];t._lastControlDown[n.pointerId]&&t._lastControlDown[n.pointerId]!==t._capturingControl[n.pointerId]&&(t._lastControlDown[n.pointerId]._forcePointerUp(),delete t._lastControlDown[n.pointerId])})},t.CreateForMesh=function(n,i,u,f,e){void 0===i&&(i=1024);void 0===u&&(u=1024);void 0===f&&(f=!0);void 0===e&&(e=!1);var s=new t(n.name+" AdvancedDynamicTexture",i,u,n.getScene(),!0,r.Texture.TRILINEAR_SAMPLINGMODE),o=new r.StandardMaterial("AdvancedDynamicTextureMaterial",n.getScene());return o.backFaceCulling=!1,o.diffuseColor=r.Color3.Black(),o.specularColor=r.Color3.Black(),e?(o.diffuseTexture=s,o.emissiveTexture=s,s.hasAlpha=!0):(o.emissiveTexture=s,o.opacityTexture=s),n.material=o,s.attachToMesh(n,f),s},t.CreateFullscreenUI=function(n,i,u,f){void 0===i&&(i=!0);void 0===u&&(u=null);void 0===f&&(f=r.Texture.BILINEAR_SAMPLINGMODE);var e=new t(n,0,0,u,!1,f),o=new r.Layer(n+"_layer",null,u,!i);return o.texture=e,e._layerToDispose=o,e._isFullscreen=!0,e.attach(),e},t}(r.DynamicTexture),ai=function(){function n(n){this.texture=n;this._captureRenderTime=!1;this._renderTime=new r.PerfCounter;this._captureLayoutTime=!1;this._layoutTime=new r.PerfCounter;this._onBeginRenderObserver=null;this._onEndRenderObserver=null;this._onBeginLayoutObserver=null;this._onEndLayoutObserver=null}return Object.defineProperty(n.prototype,"renderTimeCounter",{get:function(){return this._renderTime},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"layoutTimeCounter",{get:function(){return this._layoutTime},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"captureRenderTime",{get:function(){return this._captureRenderTime},set:function(n){var t=this;n!==this._captureRenderTime&&(this._captureRenderTime=n,n?(this._onBeginRenderObserver=this.texture.onBeginRenderObservable.add(function(){t._renderTime.beginMonitoring()}),this._onEndRenderObserver=this.texture.onEndRenderObservable.add(function(){t._renderTime.endMonitoring(!0)})):(this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"captureLayoutTime",{get:function(){return this._captureLayoutTime},set:function(n){var t=this;n!==this._captureLayoutTime&&(this._captureLayoutTime=n,n?(this._onBeginLayoutObserver=this.texture.onBeginLayoutObservable.add(function(){t._layoutTime.beginMonitoring()}),this._onEndLayoutObserver=this.texture.onEndLayoutObservable.add(function(){t._layoutTime.endMonitoring(!0)})):(this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null))},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver);this._onBeginRenderObserver=null;this.texture.onEndRenderObservable.remove(this._onEndRenderObserver);this._onEndRenderObserver=null;this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver);this._onBeginLayoutObserver=null;this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver);this._onEndLayoutObserver=null;this.texture=null},n}(),ut=function(n){function t(t,i){void 0===i&&(i=0);var r=n.call(this,t.x,t.y,t.z)||this;return r.buttonIndex=i,r}return e(t,n),t}(r.Vector3),ht=function(){function n(n){this.name=n;this._downCount=0;this._enterCount=-1;this._downPointerIds={};this._isVisible=!0;this.onPointerMoveObservable=new r.Observable;this.onPointerOutObservable=new r.Observable;this.onPointerDownObservable=new r.Observable;this.onPointerUpObservable=new r.Observable;this.onPointerClickObservable=new r.Observable;this.onPointerEnterObservable=new r.Observable;this._behaviors=[]}return Object.defineProperty(n.prototype,"position",{get:function(){return this._node?this._node.position:r.Vector3.Zero()},set:function(n){this._node&&(this._node.position=n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaling",{get:function(){return this._node?this._node.scaling:new r.Vector3(1,1,1)},set:function(n){this._node&&(this._node.scaling=n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!0,configurable:!0}),n.prototype.addBehavior=function(n){var i=this,t;return-1!==this._behaviors.indexOf(n)?this:(n.init(),t=this._host.scene,t.isLoading?t.onDataLoadedObservable.addOnce(function(){n.attach(i)}):n.attach(this),this._behaviors.push(n),this)},n.prototype.removeBehavior=function(n){var t=this._behaviors.indexOf(n);return-1===t?this:(this._behaviors[t].detach(),this._behaviors.splice(t,1),this)},n.prototype.getBehaviorByName=function(n){for(var r,t=0,i=this._behaviors;t<i.length;t++)if(r=i[t],r.name===n)return r;return null},Object.defineProperty(n.prototype,"isVisible",{get:function(){return this._isVisible},set:function(n){if(this._isVisible!==n){this._isVisible=n;var t=this.mesh;t&&t.setEnabled(n)}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!0,configurable:!0}),n.prototype.getClassName=function(){return this._getTypeName()},n.prototype._getTypeName=function(){return"Control3D"},Object.defineProperty(n.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mesh",{get:function(){return this._node instanceof r.AbstractMesh?this._node:null},enumerable:!0,configurable:!0}),n.prototype.linkToTransformNode=function(n){return this._node&&(this._node.parent=n),this},n.prototype._prepareNode=function(n){if(!this._node){if(this._node=this._createNode(n),!this.node)return;this._node.metadata=this;this._node.position=this.position;this._node.scaling=this.scaling;var t=this.mesh;t&&(t.isPickable=!0,this._affectMaterial(t))}},n.prototype._createNode=function(){return null},n.prototype._affectMaterial=function(n){n.material=null},n.prototype._onPointerMove=function(n,t){this.onPointerMoveObservable.notifyObservers(t,-1,n,this)},n.prototype._onPointerEnter=function(n){return!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,n,this),this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},n.prototype._onPointerOut=function(n){this._enterCount=0;this.onPointerOutObservable.notifyObservers(this,-1,n,this);this.pointerOutAnimation&&this.pointerOutAnimation()},n.prototype._onPointerDown=function(n,t,i,r){return 0!==this._downCount?(this._downCount++,!1):(this._downCount++,this._downPointerIds[i]=!0,this.onPointerDownObservable.notifyObservers(new ut(t,r),-1,n,this),this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},n.prototype._onPointerUp=function(n,t,i,r,u){this._downCount--;delete this._downPointerIds[i];this._downCount<0?this._downCount=0:0==this._downCount&&(u&&(this._enterCount>0||-1===this._enterCount)&&this.onPointerClickObservable.notifyObservers(new ut(t,r),-1,n,this),this.onPointerUpObservable.notifyObservers(new ut(t,r),-1,n,this),this.pointerUpAnimation&&this.pointerUpAnimation())},n.prototype.forcePointerUp=function(n){if(void 0===n&&(n=null),null!==n)this._onPointerUp(this,r.Vector3.Zero(),n,0,!0);else{for(var t in this._downPointerIds)this._onPointerUp(this,r.Vector3.Zero(),+t,0,!0);this._downCount>0&&(this._downCount=1,this._onPointerUp(this,r.Vector3.Zero(),0,0,!0))}},n.prototype._processObservables=function(n,t,i,u){if(n===r.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,t);var f=this._host._lastControlOver[i];return f&&f!==this&&f._onPointerOut(this),f!==this&&this._onPointerEnter(this),this._host._lastControlOver[i]=this,!0}return n===r.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,t,i,u),this._host._lastControlDown[i]=this,this._host._lastPickedControl=this,!0):n===r.PointerEventTypes.POINTERUP&&(this._host._lastControlDown[i]&&this._host._lastControlDown[i]._onPointerUp(this,t,i,u,!0),delete this._host._lastControlDown[i],!0)},n.prototype._disposeNode=function(){this._node&&(this._node.dispose(),this._node=null)},n.prototype.dispose=function(){this.onPointerDownObservable.clear();this.onPointerEnterObservable.clear();this.onPointerMoveObservable.clear();this.onPointerOutObservable.clear();this.onPointerUpObservable.clear();this.onPointerClickObservable.clear();this._disposeNode();for(var n=0,t=this._behaviors;n<t.length;n++)t[n].detach()},n}(),wt=function(n){function t(t){return n.call(this,t)||this}return e(t,n),t.prototype._getTypeName=function(){return"AbstractButton3D"},t.prototype._createNode=function(){return new r.TransformNode("button"+this.name)},t}(ht),ct=function(n){function t(t){var i=n.call(this,t)||this;return i._contentResolution=512,i._contentScaleRatio=2,i.pointerEnterAnimation=function(){i.mesh&&(i._currentMaterial.emissiveColor=r.Color3.Red())},i.pointerOutAnimation=function(){i._currentMaterial.emissiveColor=r.Color3.Black()},i.pointerDownAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(.95)},i.pointerUpAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(1/.95)},i}return e(t,n),Object.defineProperty(t.prototype,"contentResolution",{get:function(){return this._contentResolution},set:function(n){this._contentResolution!==n&&(this._contentResolution=n,this._resetContent())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentScaleRatio",{get:function(){return this._contentScaleRatio},set:function(n){this._contentScaleRatio!==n&&(this._contentScaleRatio=n,this._resetContent())},enumerable:!0,configurable:!0}),t.prototype._disposeFacadeTexture=function(){this._facadeTexture&&(this._facadeTexture.dispose(),this._facadeTexture=null)},t.prototype._resetContent=function(){this._disposeFacadeTexture();this.content=this._content},Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(n){this._content=n;this._host&&this._host.utilityLayer&&(this._facadeTexture||(this._facadeTexture=new st("Facade",this._contentResolution,this._contentResolution,this._host.utilityLayer.utilityLayerScene,!0,r.Texture.TRILINEAR_SAMPLINGMODE),this._facadeTexture.rootContainer.scaleX=this._contentScaleRatio,this._facadeTexture.rootContainer.scaleY=this._contentScaleRatio,this._facadeTexture.premulAlpha=!0),this._facadeTexture.addControl(n),this._applyFacade(this._facadeTexture))},enumerable:!0,configurable:!0}),t.prototype._applyFacade=function(n){this._currentMaterial.emissiveTexture=n},t.prototype._getTypeName=function(){return"Button3D"},t.prototype._createNode=function(n){for(var t=new Array(6),i=0;i<6;i++)t[i]=new r.Vector4(0,0,0,0);return t[1]=new r.Vector4(0,0,1,1),r.BoxBuilder.CreateBox(this.name+"_rootMesh",{width:1,height:1,depth:.08,faceUV:t},n)},t.prototype._affectMaterial=function(n){var t=new r.StandardMaterial(this.name+"Material",n.getScene());t.specularColor=r.Color3.Black();n.material=t;this._currentMaterial=t;this._resetContent()},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._disposeFacadeTexture();this._currentMaterial&&this._currentMaterial.dispose()},t}(wt),o=function(n){function t(t){var i=n.call(this,t)||this;return i._blockLayout=!1,i._children=[],i}return e(t,n),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blockLayout",{get:function(){return this._blockLayout},set:function(n){this._blockLayout!==n&&(this._blockLayout=n,this._blockLayout||this._arrangeChildren())},enumerable:!0,configurable:!0}),t.prototype.updateLayout=function(){return this._arrangeChildren(),this},t.prototype.containsControl=function(n){return-1!==this._children.indexOf(n)},t.prototype.addControl=function(n){return-1!==this._children.indexOf(n)?this:(n.parent=this,n._host=this._host,this._children.push(n),this._host.utilityLayer&&(n._prepareNode(this._host.utilityLayer.utilityLayerScene),n.node&&(n.node.parent=this.node),this.blockLayout||this._arrangeChildren()),this)},t.prototype._arrangeChildren=function(){},t.prototype._createNode=function(n){return new r.TransformNode("ContainerNode",n)},t.prototype.removeControl=function(n){var t=this._children.indexOf(n);return-1!==t&&(this._children.splice(t,1),n.parent=null,n._disposeNode()),this},t.prototype._getTypeName=function(){return"Container3D"},t.prototype.dispose=function(){for(var t=0,i=this._children;t<i.length;t++)i[t].dispose();this._children=[];n.prototype.dispose.call(this)},t.UNSET_ORIENTATION=0,t.FACEORIGIN_ORIENTATION=1,t.FACEORIGINREVERSED_ORIENTATION=2,t.FACEFORWARD_ORIENTATION=3,t.FACEFORWARDREVERSED_ORIENTATION=4,t}(ht),d=function(n){function t(){var t=n.call(this)||this;return t._columns=10,t._rows=0,t._rowThenColum=!0,t._orientation=o.FACEORIGIN_ORIENTATION,t.margin=0,t}return e(t,n),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(n){var t=this;this._orientation!==n&&(this._orientation=n,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},set:function(n){var t=this;this._columns!==n&&(this._columns=n,this._rowThenColum=!0,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},set:function(n){var t=this;this._rows!==n&&(this._rows=n,this._rowThenColum=!1,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),t.prototype._arrangeChildren=function(){var n,t,s,v,o;this._cellWidth=0;this._cellHeight=0;for(var i=0,u=0,f=0,k=r.Matrix.Invert(this.node.computeWorldMatrix(!0)),h=0,y=this._children;h<y.length;h++)if((o=y[h]).mesh){f++;o.mesh.computeWorldMatrix(!0);var p=o.mesh.getHierarchyBoundingVectors(),c=r.Tmp.Vector3[0],l=r.Tmp.Vector3[1];p.max.subtractToRef(p.min,l);l.scaleInPlace(.5);r.Vector3.TransformNormalToRef(l,k,c);this._cellWidth=Math.max(this._cellWidth,2*c.x);this._cellHeight=Math.max(this._cellHeight,2*c.y)}this._cellWidth+=2*this.margin;this._cellHeight+=2*this.margin;this._rowThenColum?(u=this._columns,i=Math.ceil(f/this._columns)):(i=this._rows,u=Math.ceil(f/this._rows));var w=.5*u*this._cellWidth,b=.5*i*this._cellHeight,a=[],e=0;if(this._rowThenColum)for(n=0;n<i;n++)for(t=0;t<u&&(a.push(new r.Vector3(t*this._cellWidth-w+this._cellWidth/2,n*this._cellHeight-b+this._cellHeight/2,0)),!(++e>f));t++);else for(t=0;t<u;t++)for(n=0;n<i&&(a.push(new r.Vector3(t*this._cellWidth-w+this._cellWidth/2,n*this._cellHeight-b+this._cellHeight/2,0)),!(++e>f));n++);for(e=0,s=0,v=this._children;s<v.length;s++)(o=v[s]).mesh&&(this._mapGridNode(o,a[e]),e++);this._finalProcessing()},t.prototype._finalProcessing=function(){},t}(o),vi=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t._radius=5,t}return e(t,n),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(n){var t=this;this._radius!==n&&(this._radius=n,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),t.prototype._mapGridNode=function(n,t){var u=n.mesh,i;if(u){i=this._cylindricalMapping(t);switch(n.position=i,this.orientation){case o.FACEORIGIN_ORIENTATION:u.lookAt(new r.Vector3(2*i.x,i.y,2*i.z));break;case o.FACEORIGINREVERSED_ORIENTATION:u.lookAt(new r.Vector3(-i.x,i.y,-i.z));break;case o.FACEFORWARDREVERSED_ORIENTATION:u.rotate(r.Axis.Y,Math.PI,r.Space.LOCAL)}}},t.prototype._cylindricalMapping=function(n){var t=new r.Vector3(0,n.y,this._radius),i=n.x/this._radius;return r.Matrix.RotationYawPitchRollToRef(i,0,0,r.Tmp.Matrix[0]),r.Vector3.TransformNormal(t,r.Tmp.Matrix[0])},t}(d);r.Effect.ShadersStore.fluentVertexShader="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 world;\nuniform mat4 viewProjection;\nvarying vec2 vUV;\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float borderWidth;\nuniform vec3 scaleFactor;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\n#endif\nvoid main(void) {\nvUV=uv;\n#ifdef BORDER\nvec3 scale=scaleFactor;\nfloat minScale=min(min(scale.x,scale.y),scale.z);\nfloat maxScale=max(max(scale.x,scale.y),scale.z);\nfloat minOverMiddleScale=minScale/(scale.x+scale.y+scale.z-minScale-maxScale);\nfloat areaYZ=scale.y*scale.z;\nfloat areaXZ=scale.x*scale.z;\nfloat areaXY=scale.x*scale.y;\nfloat scaledBorderWidth=borderWidth;\nif (abs(normal.x) == 1.0)\n{\nscale.x=scale.y;\nscale.y=scale.z;\nif (areaYZ>areaXZ && areaYZ>areaXY)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse if (abs(normal.y) == 1.0)\n{\nscale.x=scale.z;\nif (areaXZ>areaXY && areaXZ>areaYZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse\n{\nif (areaXY>areaYZ && areaXY>areaXZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nfloat scaleRatio=min(scale.x,scale.y)/max(scale.x,scale.y);\nif (scale.x>scale.y)\n{\nscaleInfo.x=1.0-(scaledBorderWidth*scaleRatio);\nscaleInfo.y=1.0-scaledBorderWidth;\n}\nelse\n{\nscaleInfo.x=1.0-scaledBorderWidth;\nscaleInfo.y=1.0-(scaledBorderWidth*scaleRatio);\n}\n#endif\nvec4 worldPos=world*vec4(position,1.0);\n#ifdef HOVERLIGHT\nworldPosition=worldPos.xyz;\n#endif\ngl_Position=viewProjection*worldPos;\n}\n";bt="precision highp float;\nvarying vec2 vUV;\nuniform vec4 albedoColor;\n#ifdef INNERGLOW\nuniform vec4 innerGlowColor;\n#endif\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float edgeSmoothingValue;\nuniform float borderMinValue;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\nuniform vec3 hoverPosition;\nuniform vec4 hoverColor;\nuniform float hoverRadius;\n#endif\n#ifdef TEXTURE\nuniform sampler2D albedoSampler;\n#endif\nvoid main(void) {\nvec3 albedo=albedoColor.rgb;\nfloat alpha=albedoColor.a;\n#ifdef TEXTURE\nalbedo=texture2D(albedoSampler,vUV).rgb;\n#endif\n#ifdef HOVERLIGHT\nfloat pointToHover=(1.0-clamp(length(hoverPosition-worldPosition)/hoverRadius,0.,1.))*hoverColor.a;\nalbedo=clamp(albedo+hoverColor.rgb*pointToHover,0.,1.);\n#else\nfloat pointToHover=1.0;\n#endif\n#ifdef BORDER\nfloat borderPower=10.0;\nfloat inverseBorderPower=1.0/borderPower;\nvec3 borderColor=albedo*borderPower;\nvec2 distanceToEdge;\ndistanceToEdge.x=abs(vUV.x-0.5)*2.0;\ndistanceToEdge.y=abs(vUV.y-0.5)*2.0;\nfloat borderValue=max(smoothstep(scaleInfo.x-edgeSmoothingValue,scaleInfo.x+edgeSmoothingValue,distanceToEdge.x),\nsmoothstep(scaleInfo.y-edgeSmoothingValue,scaleInfo.y+edgeSmoothingValue,distanceToEdge.y));\nborderColor=borderColor*borderValue*max(borderMinValue*inverseBorderPower,pointToHover);\nalbedo+=borderColor;\nalpha=max(alpha,borderValue);\n#endif\n#ifdef INNERGLOW\n\nvec2 uvGlow=(vUV-vec2(0.5,0.5))*(innerGlowColor.a*2.0);\nuvGlow=uvGlow*uvGlow;\nuvGlow=uvGlow*uvGlow;\nalbedo+=mix(vec3(0.0,0.0,0.0),innerGlowColor.rgb,uvGlow.x+uvGlow.y);\n#endif\ngl_FragColor=vec4(albedo,alpha);\n}";r.Effect.ShadersStore.fluentPixelShader=bt;lt=function(n){function t(){var t=n.call(this)||this;return t.INNERGLOW=!1,t.BORDER=!1,t.HOVERLIGHT=!1,t.TEXTURE=!1,t.rebuild(),t}return e(t,n),t}(r.MaterialDefines);g=function(n){function t(t,i){var u=n.call(this,t,i)||this;return u.innerGlowColorIntensity=.5,u.innerGlowColor=new r.Color3(1,1,1),u.alpha=1,u.albedoColor=new r.Color3(.3,.35,.4),u.renderBorders=!1,u.borderWidth=.5,u.edgeSmoothingValue=.02,u.borderMinValue=.1,u.renderHoverLight=!1,u.hoverRadius=1,u.hoverColor=new r.Color4(.3,.3,.3,1),u.hoverPosition=r.Vector3.Zero(),u}return e(t,n),t.prototype.needAlphaBlending=function(){return 1!==this.alpha},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(n,t){var u,i,e,f,c;if(this.isFrozen&&this._wasPreviouslyReady&&t.effect||(t._materialDefines||(t._materialDefines=new lt),u=this.getScene(),i=t._materialDefines,!this.checkReadyOnEveryCall&&t.effect&&i._renderId===u.getRenderId()))return!0;if(i._areTexturesDirty)if(i.INNERGLOW=this.innerGlowColorIntensity>0,i.BORDER=this.renderBorders,i.HOVERLIGHT=this.renderHoverLight,this._albedoTexture){if(!this._albedoTexture.isReadyOrNotBlocking())return!1;i.TEXTURE=!0}else i.TEXTURE=!1;if(e=u.getEngine(),i.isDirty){i.markAsProcessed();u.resetCachedMaterial();f=[r.VertexBuffer.PositionKind];f.push(r.VertexBuffer.NormalKind);f.push(r.VertexBuffer.UVKind);var o=["world","viewProjection","innerGlowColor","albedoColor","borderWidth","edgeSmoothingValue","scaleFactor","borderMinValue","hoverColor","hoverPosition","hoverRadius"],s=["albedoSampler"],h=[];r.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:o,uniformBuffersNames:h,samplers:s,defines:i,maxSimultaneousLights:4});c=i.toString();t.setEffect(u.getEngine().createEffect("fluent",{attributes:f,uniformsNames:o,uniformBuffersNames:h,samplers:s,defines:c,fallbacks:null,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},e))}return!(!t.effect||!t.effect.isReady())&&(i._renderId=u.getRenderId(),this._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(n,t,i){var e=this.getScene(),u=i._materialDefines,f;u&&(f=i.effect,f&&(this._activeEffect=f,this.bindOnlyWorldMatrix(n),this._activeEffect.setMatrix("viewProjection",e.getTransformMatrix()),this._mustRebind(e,f)&&(this._activeEffect.setColor4("albedoColor",this.albedoColor,this.alpha),u.INNERGLOW&&this._activeEffect.setColor4("innerGlowColor",this.innerGlowColor,this.innerGlowColorIntensity),u.BORDER&&(this._activeEffect.setFloat("borderWidth",this.borderWidth),this._activeEffect.setFloat("edgeSmoothingValue",this.edgeSmoothingValue),this._activeEffect.setFloat("borderMinValue",this.borderMinValue),t.getBoundingInfo().boundingBox.extendSize.multiplyToRef(t.scaling,r.Tmp.Vector3[0]),this._activeEffect.setVector3("scaleFactor",r.Tmp.Vector3[0])),u.HOVERLIGHT&&(this._activeEffect.setDirectColor4("hoverColor",this.hoverColor),this._activeEffect.setFloat("hoverRadius",this.hoverRadius),this._activeEffect.setVector3("hoverPosition",this.hoverPosition)),u.TEXTURE&&this._activeEffect.setTexture("albedoSampler",this._albedoTexture)),this._afterBind(t,this._activeEffect)))},t.prototype.getActiveTextures=function(){return n.prototype.getActiveTextures.call(this)},t.prototype.hasTexture=function(t){return!!n.prototype.hasTexture.call(this,t)},t.prototype.dispose=function(t){n.prototype.dispose.call(this,t)},t.prototype.clone=function(n){var i=this;return r.SerializationHelper.Clone(function(){return new t(n,i.getScene())},this)},t.prototype.serialize=function(){var n=r.SerializationHelper.Serialize(this);return n.customType="BABYLON.GUI.FluentMaterial",n},t.prototype.getClassName=function(){return"FluentMaterial"},t.Parse=function(n,i,u){return r.SerializationHelper.Parse(function(){return new t(n.name,i)},n,i,u)},c([Object(r.serialize)(),Object(r.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"innerGlowColorIntensity",void 0),c([Object(r.serializeAsColor3)()],t.prototype,"innerGlowColor",void 0),c([Object(r.serialize)()],t.prototype,"alpha",void 0),c([Object(r.serializeAsColor3)()],t.prototype,"albedoColor",void 0),c([Object(r.serialize)(),Object(r.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderBorders",void 0),c([Object(r.serialize)()],t.prototype,"borderWidth",void 0),c([Object(r.serialize)()],t.prototype,"edgeSmoothingValue",void 0),c([Object(r.serialize)()],t.prototype,"borderMinValue",void 0),c([Object(r.serialize)(),Object(r.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderHoverLight",void 0),c([Object(r.serialize)()],t.prototype,"hoverRadius",void 0),c([Object(r.serializeAsColor4)()],t.prototype,"hoverColor",void 0),c([Object(r.serializeAsVector3)()],t.prototype,"hoverPosition",void 0),c([Object(r.serializeAsTexture)("albedoTexture")],t.prototype,"_albedoTexture",void 0),c([Object(r.expandToProperty)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"albedoTexture",void 0),t}(r.PushMaterial);r._TypeStore.RegisteredTypes["BABYLON.GUI.FluentMaterial"]=g;var yi=function(n){function t(t,i){void 0===i&&(i=!0);var r=n.call(this,t)||this;return r._shareMaterials=!0,r._shareMaterials=i,r.pointerEnterAnimation=function(){r.mesh&&r._frontPlate.setEnabled(!0)},r.pointerOutAnimation=function(){r.mesh&&r._frontPlate.setEnabled(!1)},r}return e(t,n),t.prototype._disposeTooltip=function(){this._tooltipFade=null;this._tooltipTextBlock&&this._tooltipTextBlock.dispose();this._tooltipTexture&&this._tooltipTexture.dispose();this._tooltipMesh&&this._tooltipMesh.dispose();this.onPointerEnterObservable.remove(this._tooltipHoverObserver);this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(n){var i=this,t,u;n?(this._tooltipFade||(this._tooltipMesh=r.PlaneBuilder.CreatePlane("",{size:1},this._backPlate._scene),t=r.PlaneBuilder.CreatePlane("",{size:1,sideOrientation:r.Mesh.DOUBLESIDE},this._backPlate._scene),u=new r.StandardMaterial("",this._backPlate._scene),u.diffuseColor=r.Color3.FromHexString("#212121"),t.material=u,t.isPickable=!1,this._tooltipMesh.addChild(t),t.position.z=.05,this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position.y=.7,this._tooltipMesh.position.z=-.15,this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=st.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new l,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new r.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add(function(){i._tooltipFade&&i._tooltipFade.fadeIn(!0)}),this._tooltipOutObserver=this.onPointerOutObservable.add(function(){i._tooltipFade&&i._tooltipFade.fadeIn(!1)})),this._tooltipTextBlock&&(this._tooltipTextBlock.text=n)):this._disposeTooltip()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(n){this._text!==n&&(this._text=n,this._rebuildContent())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(n){this._imageUrl!==n&&(this._imageUrl=n,this._rebuildContent())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!0,configurable:!0}),t.prototype._getTypeName=function(){return"HolographicButton"},t.prototype._rebuildContent=function(){var i,n,t;this._disposeFacadeTexture();i=new p;(i.isVertical=!0,this._imageUrl)&&(n=new b,n.source=this._imageUrl,n.paddingTop="40px",n.height="180px",n.width="100px",n.paddingBottom="40px",i.addControl(n));this._text&&(t=new l,t.text=this._text,t.color="white",t.height="30px",t.fontSize=24,i.addControl(t));this._frontPlate&&(this.content=i)},t.prototype._createNode=function(t){return this._backPlate=r.BoxBuilder.CreateBox(this.name+"BackMesh",{width:1,height:1,depth:.08},t),this._frontPlate=r.BoxBuilder.CreateBox(this.name+"FrontMesh",{width:1,height:1,depth:.08},t),this._frontPlate.parent=this._backPlate,this._frontPlate.position.z=-.08,this._frontPlate.isPickable=!1,this._frontPlate.setEnabled(!1),this._textPlate=n.prototype._createNode.call(this,t),this._textPlate.parent=this._backPlate,this._textPlate.position.z=-.08,this._textPlate.isPickable=!1,this._backPlate},t.prototype._applyFacade=function(n){this._plateMaterial.emissiveTexture=n;this._plateMaterial.opacityTexture=n},t.prototype._createBackMaterial=function(n){var t=this;this._backMaterial=new g(this.name+"Back Material",n.getScene());this._backMaterial.renderHoverLight=!0;this._pickedPointObserver=this._host.onPickedPointChangedObservable.add(function(n){n?(t._backMaterial.hoverPosition=n,t._backMaterial.hoverColor.a=1):t._backMaterial.hoverColor.a=0})},t.prototype._createFrontMaterial=function(n){this._frontMaterial=new g(this.name+"Front Material",n.getScene());this._frontMaterial.innerGlowColorIntensity=0;this._frontMaterial.alpha=.5;this._frontMaterial.renderBorders=!0},t.prototype._createPlateMaterial=function(n){this._plateMaterial=new r.StandardMaterial(this.name+"Plate Material",n.getScene());this._plateMaterial.specularColor=r.Color3.Black()},t.prototype._affectMaterial=function(n){this._shareMaterials?(this._host._sharedMaterials.backFluentMaterial?this._backMaterial=this._host._sharedMaterials.backFluentMaterial:(this._createBackMaterial(n),this._host._sharedMaterials.backFluentMaterial=this._backMaterial),this._host._sharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._sharedMaterials.frontFluentMaterial:(this._createFrontMaterial(n),this._host._sharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(n),this._createFrontMaterial(n));this._createPlateMaterial(n);this._backPlate.material=this._backMaterial;this._frontPlate.material=this._frontMaterial;this._textPlate.material=this._plateMaterial;this._rebuildContent()},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._disposeTooltip();this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},t}(ct),pi=function(n){function t(t,i){var r=n.call(this,i)||this;return r._currentMesh=t,r.pointerEnterAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1.1)},r.pointerOutAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/1.1)},r.pointerDownAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(.95)},r.pointerUpAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/.95)},r}return e(t,n),t.prototype._getTypeName=function(){return"MeshButton3D"},t.prototype._createNode=function(){var n=this;return this._currentMesh.getChildMeshes().forEach(function(t){t.metadata=n}),this._currentMesh},t.prototype._affectMaterial=function(){},t}(ct),wi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype._mapGridNode=function(n,t){var u=n.mesh,i;if(u){n.position=t.clone();i=r.Tmp.Vector3[0];switch(i.copyFrom(t),this.orientation){case o.FACEORIGIN_ORIENTATION:case o.FACEFORWARD_ORIENTATION:i.addInPlace(new r.Vector3(0,0,1));u.lookAt(i);break;case o.FACEFORWARDREVERSED_ORIENTATION:case o.FACEORIGINREVERSED_ORIENTATION:i.addInPlace(new r.Vector3(0,0,-1));u.lookAt(i)}}},t}(d),bi=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t._iteration=100,t}return e(t,n),Object.defineProperty(t.prototype,"iteration",{get:function(){return this._iteration},set:function(n){var t=this;this._iteration!==n&&(this._iteration=n,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),t.prototype._mapGridNode=function(n,t){var i=n.mesh,u=this._scatterMapping(t);if(i){switch(this.orientation){case o.FACEORIGIN_ORIENTATION:case o.FACEFORWARD_ORIENTATION:i.lookAt(new r.Vector3(0,0,1));break;case o.FACEFORWARDREVERSED_ORIENTATION:case o.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new r.Vector3(0,0,-1))}n.position=u}},t.prototype._scatterMapping=function(n){return n.x=(1-2*Math.random())*this._cellWidth,n.y=(1-2*Math.random())*this._cellHeight,n},t.prototype._finalProcessing=function(){for(var s,h,u,c,e,n=[],o=0,l=this._children;o<l.length;o++)s=l[o],s.mesh&&n.push(s.mesh);for(h=0;h<this._iteration;h++){n.sort(function(n,t){var i=n.position.lengthSquared(),r=t.position.lengthSquared();return i<r?1:i>r?-1:0});for(var a=Math.pow(this.margin,2),v=Math.max(this._cellWidth,this._cellHeight),f=r.Tmp.Vector2[0],t=r.Tmp.Vector3[0],i=0;i<n.length-1;i++)for(u=i+1;u<n.length;u++)i!=u&&(n[u].position.subtractToRef(n[i].position,t),f.x=t.x,f.y=t.y,c=v,e=f.lengthSquared()-a,(e-=Math.min(e,a))<Math.pow(c,2)&&(f.normalize(),t.scaleInPlace(.5*(c-Math.sqrt(e))),n[u].position.addInPlace(t),n[i].position.subtractInPlace(t)))}},t}(d),ki=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t._radius=5,t}return e(t,n),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(n){var t=this;this._radius!==n&&(this._radius=n,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),t.prototype._mapGridNode=function(n,t){var u=n.mesh,i;if(u){i=this._sphericalMapping(t);switch(n.position=i,this.orientation){case o.FACEORIGIN_ORIENTATION:u.lookAt(new r.Vector3(2*i.x,2*i.y,2*i.z));break;case o.FACEORIGINREVERSED_ORIENTATION:u.lookAt(new r.Vector3(-i.x,-i.y,-i.z));break;case o.FACEFORWARDREVERSED_ORIENTATION:u.rotate(r.Axis.Y,Math.PI,r.Space.LOCAL)}}},t.prototype._sphericalMapping=function(n){var t=new r.Vector3(0,0,this._radius),i=n.y/this._radius,u=-n.x/this._radius;return r.Matrix.RotationYawPitchRollToRef(u,i,0,r.Tmp.Matrix[0]),r.Vector3.TransformNormal(t,r.Tmp.Matrix[0])},t}(d),di=function(n){function t(t){void 0===t&&(t=!1);var i=n.call(this)||this;return i._isVertical=!1,i.margin=.1,i._isVertical=t,i}return e(t,n),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(n){var t=this;this._isVertical!==n&&(this._isVertical=n,r.Tools.SetImmediate(function(){t._arrangeChildren()}))},enumerable:!0,configurable:!0}),t.prototype._arrangeChildren=function(){for(var l,n,t,i,f=0,e=0,u=0,h=[],v=r.Matrix.Invert(this.node.computeWorldMatrix(!0)),o=0,c=this._children;o<c.length;o++)(t=c[o]).mesh&&(u++,t.mesh.computeWorldMatrix(!0),t.mesh.getWorldMatrix().multiplyToRef(v,r.Tmp.Matrix[0]),l=t.mesh.getBoundingInfo().boundingBox,n=r.Vector3.TransformNormal(l.extendSize,r.Tmp.Matrix[0]),h.push(n),this._isVertical?e+=n.y:f+=n.x);this._isVertical?e+=(u-1)*this.margin/2:f+=(u-1)*this.margin/2;i=this._isVertical?-e:-f;for(var y=0,s=0,a=this._children;s<a.length;s++)(t=a[s]).mesh&&(u--,n=h[y++],this._isVertical?(t.position.y=i+n.y,t.position.x=0,i+=2*n.y):(t.position.x=i+n.x,t.position.y=0,i+=2*n.x),i+=u>0?this.margin:0)},t}(o),gi=function(){function n(n){var t=this,i;this._lastControlOver={};this._lastControlDown={};this.onPickedPointChangedObservable=new r.Observable;this._sharedMaterials={};this._scene=n||r.EngineStore.LastCreatedScene;this._sceneDisposeObserver=this._scene.onDisposeObservable.add(function(){t._sceneDisposeObserver=null;t._utilityLayer=null;t.dispose()});this._utilityLayer=new r.UtilityLayerRenderer(this._scene);this._utilityLayer.onlyCheckPointerDownEvents=!1;this._utilityLayer.pickUtilitySceneFirst=!1;this._utilityLayer.mainSceneTrackerPredicate=function(n){return n&&n.metadata&&n.metadata._node};this._rootContainer=new o("RootContainer");this._rootContainer._host=this;i=this._utilityLayer.utilityLayerScene;this._pointerOutObserver=this._utilityLayer.onPointerOutObservable.add(function(n){t._handlePointerOut(n,!0)});this._pointerObserver=i.onPointerObservable.add(function(n){t._doPicking(n)});this._utilityLayer.utilityLayerScene.autoClear=!1;this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!1;new r.HemisphericLight("hemi",r.Vector3.Up(),this._utilityLayer.utilityLayerScene)}return Object.defineProperty(n.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"utilityLayer",{get:function(){return this._utilityLayer},enumerable:!0,configurable:!0}),n.prototype._handlePointerOut=function(n,t){var i=this._lastControlOver[n];i&&(i._onPointerOut(i),delete this._lastControlOver[n]);t&&this._lastControlDown[n]&&(this._lastControlDown[n].forcePointerUp(),delete this._lastControlDown[n]);this.onPickedPointChangedObservable.notifyObservers(null)},n.prototype._doPicking=function(n){var f;if(!this._utilityLayer||!this._utilityLayer.utilityLayerScene.activeCamera)return!1;var i=n.event,t=i.pointerId||0,e=i.button,u=n.pickInfo;return!u||!u.hit?(this._handlePointerOut(t,n.type===r.PointerEventTypes.POINTERUP),!1):(f=u.pickedMesh.metadata,u.pickedPoint&&this.onPickedPointChangedObservable.notifyObservers(u.pickedPoint),f._processObservables(n.type,u.pickedPoint,t,e)||n.type===r.PointerEventTypes.POINTERMOVE&&(this._lastControlOver[t]&&this._lastControlOver[t]._onPointerOut(this._lastControlOver[t]),delete this._lastControlOver[t]),n.type===r.PointerEventTypes.POINTERUP&&(this._lastControlDown[i.pointerId]&&(this._lastControlDown[i.pointerId].forcePointerUp(),delete this._lastControlDown[i.pointerId]),"touch"===i.pointerType&&this._handlePointerOut(t,!1)),!0)},Object.defineProperty(n.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!0,configurable:!0}),n.prototype.containsControl=function(n){return this._rootContainer.containsControl(n)},n.prototype.addControl=function(n){return this._rootContainer.addControl(n),this},n.prototype.removeControl=function(n){return this._rootContainer.removeControl(n),this},n.prototype.dispose=function(){var n,t;for(n in this._rootContainer.dispose(),this._sharedMaterials)this._sharedMaterials.hasOwnProperty(n)&&this._sharedMaterials[n].dispose();this._sharedMaterials={};this._pointerOutObserver&&this._utilityLayer&&(this._utilityLayer.onPointerOutObservable.remove(this._pointerOutObserver),this._pointerOutObserver=null);this.onPickedPointChangedObservable.clear();t=this._utilityLayer?this._utilityLayer.utilityLayerScene:null;t&&this._pointerObserver&&(t.onPointerObservable.remove(this._pointerObserver),this._pointerObserver=null);this._scene&&this._sceneDisposeObserver&&(this._scene.onDisposeObservable.remove(this._sceneDisposeObserver),this._sceneDisposeObserver=null);this._utilityLayer&&this._utilityLayer.dispose()},n}();i.d(t,"AdvancedDynamicTexture",function(){return st});i.d(t,"AdvancedDynamicTextureInstrumentation",function(){return ai});i.d(t,"Vector2WithInfo",function(){return nt});i.d(t,"Matrix2D",function(){return tt});i.d(t,"Measure",function(){return s});i.d(t,"MultiLinePoint",function(){return et});i.d(t,"Style",function(){return pt});i.d(t,"ValueAndUnit",function(){return f});i.d(t,"Button",function(){return y});i.d(t,"Checkbox",function(){return at});i.d(t,"ColorPicker",function(){return kt});i.d(t,"Container",function(){return v});i.d(t,"Control",function(){return u});i.d(t,"Ellipse",function(){return dt});i.d(t,"Grid",function(){return h});i.d(t,"Image",function(){return b});i.d(t,"InputText",function(){return w});i.d(t,"InputPassword",function(){return gt});i.d(t,"Line",function(){return ni});i.d(t,"MultiLine",function(){return ti});i.d(t,"RadioButton",function(){return vt});i.d(t,"StackPanel",function(){return p});i.d(t,"SelectorGroup",function(){return rt});i.d(t,"CheckboxGroup",function(){return ii});i.d(t,"RadioGroup",function(){return ri});i.d(t,"SliderGroup",function(){return ui});i.d(t,"SelectionPanel",function(){return fi});i.d(t,"ScrollViewer",function(){return oi});i.d(t,"TextWrapping",function(){return k});i.d(t,"TextBlock",function(){return l});i.d(t,"KeyPropertySet",function(){return si});i.d(t,"VirtualKeyboard",function(){return hi});i.d(t,"Rectangle",function(){return a});i.d(t,"DisplayGrid",function(){return ci});i.d(t,"BaseSlider",function(){return it});i.d(t,"Slider",function(){return yt});i.d(t,"ImageBasedSlider",function(){return li});i.d(t,"ScrollBar",function(){return ot});i.d(t,"name",function(){return"Statics"});i.d(t,"GUI3DManager",function(){return gi});i.d(t,"Vector3WithInfo",function(){return ut});i.d(t,"AbstractButton3D",function(){return wt});i.d(t,"Button3D",function(){return ct});i.d(t,"Container3D",function(){return o});i.d(t,"Control3D",function(){return ht});i.d(t,"CylinderPanel",function(){return vi});i.d(t,"HolographicButton",function(){return yi});i.d(t,"MeshButton3D",function(){return pi});i.d(t,"PlanePanel",function(){return wi});i.d(t,"ScatterPanel",function(){return bi});i.d(t,"SpherePanel",function(){return ki});i.d(t,"StackPanel3D",function(){return di});i.d(t,"VolumeBasedPanel",function(){return d});i.d(t,"FluentMaterialDefines",function(){return lt});i.d(t,"FluentMaterial",function(){return g})},function(n,t,i){"use strict";i.r(t),function(n){var r=i(1),u;i.d(t,"AdvancedDynamicTexture",function(){return r.AdvancedDynamicTexture});i.d(t,"AdvancedDynamicTextureInstrumentation",function(){return r.AdvancedDynamicTextureInstrumentation});i.d(t,"Vector2WithInfo",function(){return r.Vector2WithInfo});i.d(t,"Matrix2D",function(){return r.Matrix2D});i.d(t,"Measure",function(){return r.Measure});i.d(t,"MultiLinePoint",function(){return r.MultiLinePoint});i.d(t,"Style",function(){return r.Style});i.d(t,"ValueAndUnit",function(){return r.ValueAndUnit});i.d(t,"GUI3DManager",function(){return r.GUI3DManager});i.d(t,"Vector3WithInfo",function(){return r.Vector3WithInfo});i.d(t,"Button",function(){return r.Button});i.d(t,"Checkbox",function(){return r.Checkbox});i.d(t,"ColorPicker",function(){return r.ColorPicker});i.d(t,"Container",function(){return r.Container});i.d(t,"Control",function(){return r.Control});i.d(t,"Ellipse",function(){return r.Ellipse});i.d(t,"Grid",function(){return r.Grid});i.d(t,"Image",function(){return r.Image});i.d(t,"InputText",function(){return r.InputText});i.d(t,"InputPassword",function(){return r.InputPassword});i.d(t,"Line",function(){return r.Line});i.d(t,"MultiLine",function(){return r.MultiLine});i.d(t,"RadioButton",function(){return r.RadioButton});i.d(t,"StackPanel",function(){return r.StackPanel});i.d(t,"SelectorGroup",function(){return r.SelectorGroup});i.d(t,"CheckboxGroup",function(){return r.CheckboxGroup});i.d(t,"RadioGroup",function(){return r.RadioGroup});i.d(t,"SliderGroup",function(){return r.SliderGroup});i.d(t,"SelectionPanel",function(){return r.SelectionPanel});i.d(t,"ScrollViewer",function(){return r.ScrollViewer});i.d(t,"TextWrapping",function(){return r.TextWrapping});i.d(t,"TextBlock",function(){return r.TextBlock});i.d(t,"KeyPropertySet",function(){return r.KeyPropertySet});i.d(t,"VirtualKeyboard",function(){return r.VirtualKeyboard});i.d(t,"Rectangle",function(){return r.Rectangle});i.d(t,"DisplayGrid",function(){return r.DisplayGrid});i.d(t,"BaseSlider",function(){return r.BaseSlider});i.d(t,"Slider",function(){return r.Slider});i.d(t,"ImageBasedSlider",function(){return r.ImageBasedSlider});i.d(t,"ScrollBar",function(){return r.ScrollBar});i.d(t,"name",function(){return r.name});i.d(t,"AbstractButton3D",function(){return r.AbstractButton3D});i.d(t,"Button3D",function(){return r.Button3D});i.d(t,"Container3D",function(){return r.Container3D});i.d(t,"Control3D",function(){return r.Control3D});i.d(t,"CylinderPanel",function(){return r.CylinderPanel});i.d(t,"HolographicButton",function(){return r.HolographicButton});i.d(t,"MeshButton3D",function(){return r.MeshButton3D});i.d(t,"PlanePanel",function(){return r.PlanePanel});i.d(t,"ScatterPanel",function(){return r.ScatterPanel});i.d(t,"SpherePanel",function(){return r.SpherePanel});i.d(t,"StackPanel3D",function(){return r.StackPanel3D});i.d(t,"VolumeBasedPanel",function(){return r.VolumeBasedPanel});i.d(t,"FluentMaterialDefines",function(){return r.FluentMaterialDefines});i.d(t,"FluentMaterial",function(){return r.FluentMaterial});u=void 0!==n?n:"undefined"!=typeof window?window:void 0;void 0!==u&&(u.BABYLON=u.BABYLON||{},u.BABYLON.GUI=r)}.call(this,i(3))},function(n){var t=function(){return this}();try{t=t||new Function("return this")()}catch(n){"object"==typeof window&&(t=window)}n.exports=t}])})
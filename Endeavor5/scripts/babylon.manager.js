var TimerPlugin,__extends,BABYLON;String.prototype.endsWith||(String.prototype.endsWith=function(n,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-n.length,t)===n});String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return this.substr(!t||t<0?0:+t,n.length)===n}),function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Stats=t()}(this,function(){"use strict";var n=function(){function i(n){return t.appendChild(n.dom),n}function r(n){for(var i=0;i<t.children.length;i++)t.children[i].style.display=i===n?"block":"none";s=n}var s=0,t=document.createElement("div"),o;t.style.cssText="position:fixed;top:0;right:0;cursor:pointer;opacity:0.9;z-index:10000";t.addEventListener("click",function(n){n.preventDefault();r(++s%t.children.length)},!1);var u=(performance||Date).now(),f=u,e=0,h=i(new n.Panel("FPS","#0f0")),c=i(new n.Panel("MS","#0ff"));return self.performance&&self.performance.memory&&(o=i(new n.Panel("MB","#f08"))),r(0),{REVISION:16,dom:t,addPanel:i,showPanel:r,begin:function(){u=(performance||Date).now()},end:function(){var t,i,r;return e++,t=(performance||Date).now(),(c.update(t-u,200),t>f+1e3)&&(i=1e3*e/(t-f),(n.FpsForeground=i>=30?"#0f0":i>=24?"#ff0":"#f00",h.update(i,100),f=t,e=0,o)&&(r=performance.memory,o.update(r.usedJSHeapSize/1048576,r.jsHeapSizeLimit/1048576))),t},update:function(){u=this.end()},domElement:t,setMode:r}};return n.FpsForeground="#0f0",n.AllBackground="#222",n.Panel=function(t,i){var l=1/0,a=0,c=Math.round,u=c(window.devicePixelRatio||1),v=100*u,y=50*u,p=3*u,w=2*u,e=3*u,f=18*u,o=94*u,s=28*u,h=document.createElement("canvas"),r;return h.width=v,h.height=y,h.style.cssText="width:100px;height:50px",r=h.getContext("2d"),r.font="bold "+12*u+"px Helvetica,Arial,sans-serif",r.textBaseline="top",r.fillStyle=n.AllBackground,r.fillRect(0,0,v,y),r.fillStyle="FPS"===t?n.FpsForeground:i,r.fillText(t,p,w),r.fillRect(e,f,o,s),r.fillStyle=n.AllBackground,r.globalAlpha=.9,r.fillRect(e,f,o,s),{dom:h,update:function(y,b){l=Math.min(l,y);a=Math.max(a,y);r.fillStyle=n.AllBackground;r.globalAlpha=1;r.fillRect(0,0,v,f);r.fillStyle="FPS"===t?n.FpsForeground:i;r.fillText(c(y)+" "+t+" ("+c(l)+"-"+c(a)+")",p,w);r.drawImage(h,e+u,f,o-u,s,e,f,o-u,s);r.fillRect(e+o-u,f,u,s);r.fillStyle=n.AllBackground;r.globalAlpha=.9;r.fillRect(e+o-u,f,u,c((1-y/b)*s))}}},n});__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var c=function(){function t(n,t,i,r){if(void 0===i&&(i=!0),void 0===r&&(r={}),this.register=null,this.tick=!1,this._before=null,this._after=null,this._engine=null,this._scene=null,this._properties=null,this._manager=null,this._entity=null,null==n)throw new Error("Null owner scene object specified.");if(null==t)throw new Error("Null host scene object specified.");this.tick=i;this._entity=n;this._manager=null;this._properties=r;this._engine=t.getEngine();this._scene=t;var u=this;u.register=function(){u.registerInstance(u)};u._before=function(){u.updateInstance(u)};u._after=function(){u.afterInstance(u)}}return t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.after=function(){},t.prototype.destroy=function(){},Object.defineProperty(t.prototype,"entity",{get:function(){return this._entity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"manager",{get:function(){return null==this._manager&&(this._manager=n.SceneManager.GetInstance()),this._manager},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(n,t){null!=this._properties&&(this._properties[n]=t)},t.prototype.getProperty=function(n,t){void 0===t&&(t=null);var i=null;return null!=this._properties&&(i=this._properties[n]),null==i&&(i=t),null!=i?i:null},t.prototype.getClassname=function(){var n=/function (.{1,})\(/.exec(this.constructor.toString());return n&&n.length>1?n[1]:""},t.prototype.getMetadata=function(){return this.manager.findSceneMetadata(this._entity)},t.prototype.getComponent=function(n){var t=this.manager.findSceneComponent(n,this._entity);return null!=t?t:null},t.prototype.getComponents=function(n){var t=this.manager.findSceneComponents(n,this._entity);return null!=t?t:null},t.prototype.getLensFlareSystem=function(n){return this.manager.findSceneLensFlareSystem(n,this._entity)},t.prototype.getLensFlareSystems=function(){return this.manager.findSceneLensFlareSystems(this._entity)},t.prototype.registerInstance=function(n){n.ready&&n.manager.onready(function(){n.ready()});n.scene.registerBeforeRender(n._before);n.scene.registerAfterRender(n._after)},t.prototype.updateInstance=function(n){null!=n&&null!=n.entity&&(n._started?null!=n._before&&n._started&&n.tick&&(n.update(),n.updateIntersectionList&&n.updateIntersectionList()):(n.start(),n._started=!0))},t.prototype.afterInstance=function(n){null!=n&&null!=n.entity&&null!=n._after&&n._started&&n.tick&&n.after()},t.DestroyInstance=function(n){n.tick=!1;n.scene.unregisterBeforeRender(n._before);n.scene.unregisterAfterRender(n._after);try{n.destroy()}catch(t){}n.disposeSceneComponent&&n.disposeSceneComponent();null!=n._prefab&&(n._prefab.dispose(),n._prefab=null);n.entity=null;n._started=!1;n._before=null;n._after=null;n._properties=null;n._engine=null;n._scene=null;n._manager=null;n.register=null;n.dispose=null},t}(),t,i,r,u,f,e,o,s,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,h;n.SceneComponent=c;t=function(t){function i(n,i,r,u){void 0===r&&(r=!0);void 0===u&&(u={});var f=t.call(this,n,i,r,u)||this;return f._camera=null,f._orthoSize=0,f._orthoUpdate=!1,f._camera=n,f}return __extends(i,t),Object.defineProperty(i.prototype,"camera",{get:function(){return this._camera},enumerable:!0,configurable:!0}),i.prototype.setupOrthographicCamera=function(t,i){null!=this.camera&&this._camera.mode===n.Camera.ORTHOGRAPHIC_CAMERA&&(this._orthoSize=t,this.updateOrthographicSize(),this._orthoUpdate===!1&&(this._orthoUpdate=i,this._orthoUpdate===!0&&window.addEventListener("resize",this.updateOrthographicSize)))},i.prototype.updateOrthographicSize=function(){if(null!=this.camera&&0!==this._orthoSize){var t=this.scene.getEngine().getRenderingCanvasClientRect(),r=t.width/t.height,n=this._orthoSize,i=n*r;this._camera.orthoTop=n;this._camera.orthoBottom=-n;this._camera.orthoLeft=-i;this._camera.orthoRight=i}},i.prototype.disposeSceneComponent=function(){this._orthoUpdate===!0&&(window.removeEventListener("resize",this.updateOrthographicSize),this._orthoUpdate=!1,this._orthoSize=0);this._camera=null},i}(n.SceneComponent);n.CameraComponent=t;i=function(n){function t(t,i,r,u){void 0===r&&(r=!0);void 0===u&&(u={});var f=n.call(this,t,i,r,u)||this;return f._light=null,f._light=t,f}return __extends(t,n),Object.defineProperty(t.prototype,"light",{get:function(){return this._light},enumerable:!0,configurable:!0}),t.prototype.disposeSceneComponent=function(){this._light=null},t}(n.SceneComponent);n.LightComponent=i;r=function(t){function i(n,i,r,u){void 0===r&&(r=!0);void 0===u&&(u={});var f=t.call(this,n,i,r,u)||this;return f._mesh=null,f._mesh=n,f}return __extends(i,t),Object.defineProperty(i.prototype,"mesh",{get:function(){return this._mesh},enumerable:!0,configurable:!0}),i.prototype.getChildMesh=function(t,i,r,u){return void 0===i&&(i=n.SearchType.ExactMatch),void 0===r&&(r=!0),void 0===u&&(u=null),this.manager.findSceneChildMesh(t,this._mesh,i,r,u)},i.prototype.getCollisionMesh=function(n,t){return void 0===n&&(n=!0),void 0===t&&(t=null),this.manager.findSceneCollisionMesh(this._mesh,n,t)},i.prototype.getSocketMesh=function(n,t,i){return void 0===t&&(t=!0),void 0===i&&(i=null),this.manager.findSceneSocketMesh(n,this._mesh,t,i)},i.prototype.getSocketMeshes=function(n,t){return void 0===n&&(n=!0),void 0===t&&(t=null),this.manager.findSceneSocketMeshes(this._mesh,n,t)},i.prototype.getParticleSystem=function(n){return this.manager.findSceneParticleSystem(n,this._mesh)},i.prototype.getParticleSystems=function(){return this.manager.findSceneParticleSystems(this._mesh)},Object.defineProperty(i.prototype,"onCollisionEvent",{get:function(){var n=null;return null!=this._mesh.metadata&&this._mesh.metadata.api&&null!=this._mesh.metadata.collisionEvent&&(n=this._mesh.metadata.collisionEvent),n},set:function(n){if(null!=this._mesh.metadata&&this._mesh.metadata.api&&(this._mesh.metadata.collisionEvent=n),null!=this._mesh.physicsImpostor){var t=this._mesh.physicsImpostor;t.onCollideEvent=null!=n?this.updatePhysicsCollisionEvent:null}},enumerable:!0,configurable:!0}),i.prototype.updatePhysicsCollisionEvent=function(n,t){var r,i,u;null!=n.object&&null!=t.object&&(r=n.object,null!=r&&null!=r.metadata&&null!=r.metadata.collisionEvent&&(i=t.object,null!=i&&(u="Untagged",null!=i.metadata&&null!=i.metadata.tagName&&""!==i.metadata.tagName&&(u=i.metadata.tagName),r.metadata.collisionEvent(i,u))))},i.prototype.disposeSceneComponent=function(){if(null!=this._mesh){if(null!=this._mesh.skeleton&&null!=this._mesh.skeleton.bones&&this._mesh.skeleton.bones.length>0&&this._mesh.skeleton.bones.forEach(function(n){null!=n&&null!=n.metadata&&(n.metadata=null)}),null!=this._mesh.physicsImpostor){var n=this._mesh.physicsImpostor;null!=n.onCollideEvent&&(n.onCollideEvent=null)}null!=this._mesh.metadata&&this._mesh.metadata.api&&(this._mesh.metadata.collisionEvent=null)}this._mesh=null},i}(n.SceneComponent);n.MeshComponent=r;u=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.start=function(){var n=this,t,i;n.setupOrthographicCamera&&(t=this.getProperty("orthoSize",5),i=this.getProperty("resizeCameras",!0),n.setupOrthographicCamera(t,i))},t}(n.CameraComponent);n.OrthoController=u;f=function(){function t(t){this._entity=null;this.slerpIdentity=null;this._entity=t;this.slerpIdentity=n.Quaternion.Identity()}return t.prototype.rotate=function(t,i,r,u){void 0===u&&(u=n.RotateOrder.ZXY);var f=null;return null!=this._entity&&(null==this._entity.rotationQuaternion&&(this._entity.rotationQuaternion=n.Quaternion.RotationYawPitchRoll(this._entity.rotation.y,this._entity.rotation.x,this._entity.rotation.z)),f=u===n.RotateOrder.XYZ?this._entity.addRotation(t,0,0).addRotation(0,i,0).addRotation(0,0,r):u===n.RotateOrder.XZY?this._entity.addRotation(t,0,0).addRotation(0,0,r).addRotation(0,i,0):u===n.RotateOrder.ZXY?this._entity.addRotation(0,0,r).addRotation(t,0,0).addRotation(0,i,0):u===n.RotateOrder.ZYX?this._entity.addRotation(0,0,r).addRotation(0,i,0).addRotation(t,0,0):u===n.RotateOrder.YZX?this._entity.addRotation(0,i,0).addRotation(0,0,r).addRotation(t,0,0):this._entity.addRotation(t,i,r)),f},t.prototype.lookAtPosition=function(t,i,r,u,f,e){void 0===i&&(i=0);var o=null;return null!=this._entity&&(null==this._entity.rotationQuaternion&&(this._entity.rotationQuaternion=n.Quaternion.RotationYawPitchRoll(this._entity.rotation.y,this._entity.rotation.x,this._entity.rotation.z)),null!=this.slerpIdentity&&i>0&&this.slerpIdentity.copyFrom(this._entity.rotationQuaternion),o=this._entity.lookAt(t,r,u,f,e),null!=this.slerpIdentity&&i>0&&n.Quaternion.SlerpToRef(this.slerpIdentity,this._entity.rotationQuaternion,i,this._entity.rotationQuaternion)),o},t.prototype.dispose=function(){this._entity=null;this.slerpIdentity=null},t}();n.MeshRotator=f;e=function(){function n(n){this._metadata=null;this._metadata=n}return Object.defineProperty(n.prototype,"type",{get:function(){return this._metadata.type},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"prefab",{get:function(){return this._metadata.prefab},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._metadata.state},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"objectId",{get:function(){return this._metadata.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"objectName",{get:function(){return this._metadata.objectName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tagName",{get:function(){return this._metadata.tagName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"layerIndex",{get:function(){return this._metadata.layerIndex},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"layerName",{get:function(){return this._metadata.layerName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"areaIndex",{get:function(){return this._metadata.areaIndex},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"navAgent",{get:function(){return this._metadata.navAgent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"meshLink",{get:function(){return this._metadata.meshLink},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"meshObstacle",{get:function(){return this._metadata.meshObstacle},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shadowCastingMode",{get:function(){return this._metadata.shadowCastingMode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"socketList",{get:function(){return this._metadata.socketList},enumerable:!0,configurable:!0}),n.prototype.setProperty=function(n,t){null!=this._metadata.properties&&(this._metadata.properties[n]=t)},n.prototype.getProperty=function(n,t){void 0===t&&(t=null);var i=null;return null!=this._metadata.properties&&(i=this._metadata.properties[n]),null==i&&(i=t),null!=i?i:null},n}();n.ObjectMetadata=e;o=function(){function n(){}return n}();n.MachineState=o;s=function(){function n(){}return n}();n.TransitionCheck=s;!function(n){n[n.NoScale=1]="NoScale";n[n.Deg2Rad=.0174532924]="Deg2Rad";n[n.Rad2Deg=57.29578]="Rad2Deg";n[n.DiagonalSpeed=.7071]="DiagonalSpeed";n[n.MinimumTimeout=.25]="MinimumTimeout";n[n.SpeedCompensator=1.05]="SpeedCompensator"}(l=n.Statics||(n.Statics={}));!function(n){n[n.YXZ=0]="YXZ";n[n.YZX=1]="YZX";n[n.XYZ=2]="XYZ";n[n.XZY=3]="XZY";n[n.ZXY=4]="ZXY";n[n.ZYX=5]="ZYX"}(a=n.RotateOrder||(n.RotateOrder={}));!function(n){n[n.Clip=0]="Clip";n[n.Tree=1]="Tree"}(v=n.MotionType||(n.MotionType={}));!function(n){n[n.Float=1]="Float";n[n.Int=3]="Int";n[n.Bool=4]="Bool";n[n.Trigger=9]="Trigger"}(y=n.AnimatorParameterType||(n.AnimatorParameterType={}));!function(n){n[n.ExactMatch=0]="ExactMatch";n[n.StartsWith=1]="StartsWith";n[n.EndsWith=2]="EndsWith";n[n.IndexOf=3]="IndexOf"}(p=n.SearchType||(n.SearchType={}));!function(n){n[n.One=1]="One";n[n.Two=2]="Two";n[n.Three=3]="Three";n[n.Four=4]="Four"}(w=n.PlayerNumber||(n.PlayerNumber={}));!function(n){n[n.None=-1]="None";n[n.Generic=0]="Generic";n[n.Xbox360=1]="Xbox360"}(b=n.GamepadType||(n.GamepadType={}));!function(n){n[n.Left=0]="Left";n[n.Right=1]="Right"}(k=n.JoystickButton||(n.JoystickButton={}));!function(n){n[n.Left=0]="Left";n[n.Right=1]="Right"}(d=n.Xbox360Trigger||(n.Xbox360Trigger={}));!function(n){n[n.Left=0]="Left";n[n.Middle=1]="Middle";n[n.Right=2]="Right"}(g=n.UserInputPointer||(n.UserInputPointer={}));!function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical";n[n.ClientX=2]="ClientX";n[n.ClientY=3]="ClientY";n[n.MouseX=4]="MouseX";n[n.MouseY=5]="MouseY";n[n.Wheel=6]="Wheel"}(nt=n.UserInputAxis||(n.UserInputAxis={}));!function(n){n[n.BackSpace=8]="BackSpace";n[n.Tab=9]="Tab";n[n.Enter=13]="Enter";n[n.Shift=16]="Shift";n[n.Ctrl=17]="Ctrl";n[n.Alt=18]="Alt";n[n.Pause=19]="Pause";n[n.Break=19]="Break";n[n.CapsLock=20]="CapsLock";n[n.Escape=27]="Escape";n[n.SpaceBar=32]="SpaceBar";n[n.PageUp=33]="PageUp";n[n.PageDown=34]="PageDown";n[n.End=35]="End";n[n.Home=36]="Home";n[n.LeftArrow=37]="LeftArrow";n[n.UpArrow=38]="UpArrow";n[n.RightArrow=39]="RightArrow";n[n.DownArrow=40]="DownArrow";n[n.Insert=45]="Insert";n[n.Delete=46]="Delete";n[n.Num0=48]="Num0";n[n.Num1=49]="Num1";n[n.Num2=50]="Num2";n[n.Num3=51]="Num3";n[n.Num4=52]="Num4";n[n.Num5=53]="Num5";n[n.Num6=54]="Num6";n[n.Num7=55]="Num7";n[n.Num8=56]="Num8";n[n.Num9=57]="Num9";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.LeftWindowKey=91]="LeftWindowKey";n[n.RightWindowKey=92]="RightWindowKey";n[n.SelectKey=93]="SelectKey";n[n.Numpad0=96]="Numpad0";n[n.Numpad1=97]="Numpad1";n[n.Numpad2=98]="Numpad2";n[n.Numpad3=99]="Numpad3";n[n.Numpad4=100]="Numpad4";n[n.Numpad5=101]="Numpad5";n[n.Numpad6=102]="Numpad6";n[n.Numpad7=103]="Numpad7";n[n.Numpad8=104]="Numpad8";n[n.Numpad9=105]="Numpad9";n[n.Multiply=106]="Multiply";n[n.Add=107]="Add";n[n.Subtract=109]="Subtract";n[n.DecimalPoint=110]="DecimalPoint";n[n.Divide=111]="Divide";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F3=114]="F3";n[n.F4=115]="F4";n[n.F5=116]="F5";n[n.F6=117]="F6";n[n.F7=118]="F7";n[n.F8=119]="F8";n[n.F9=120]="F9";n[n.F10=121]="F10";n[n.F11=122]="F11";n[n.F12=123]="F12";n[n.NumLock=144]="NumLock";n[n.ScrollLock=145]="ScrollLock";n[n.SemiColon=186]="SemiColon";n[n.EqualSign=187]="EqualSign";n[n.Comma=188]="Comma";n[n.Dash=189]="Dash";n[n.Period=190]="Period";n[n.ForwardSlash=191]="ForwardSlash";n[n.GraveAccent=192]="GraveAccent";n[n.OpenBracket=219]="OpenBracket";n[n.BackSlash=220]="BackSlash";n[n.CloseBraket=221]="CloseBraket";n[n.SingleQuote=222]="SingleQuote"}(tt=n.UserInputKey||(n.UserInputKey={}));!function(n){n[n.DirectVelocity=0]="DirectVelocity";n[n.AppliedForces=1]="AppliedForces";n[n.CheckCollision=2]="CheckCollision"}(it=n.MovementType||(n.MovementType={}));!function(n){n[n.Top=0]="Top";n[n.Left=1]="Left";n[n.Right=2]="Right";n[n.Bottom=3]="Bottom"}(rt=n.CollisionContact||(n.CollisionContact={}));!function(n){n[n.AABB=0]="AABB";n[n.OBB=1]="OBB"}(ut=n.IntersectionPrecision||(n.IntersectionPrecision={}));!function(n){n[n.If=1]="If";n[n.IfNot=2]="IfNot";n[n.Greater=3]="Greater";n[n.Less=4]="Less";n[n.Equals=6]="Equals";n[n.NotEqual=7]="NotEqual"}(ft=n.ConditionMode||(n.ConditionMode={}));!function(n){n[n.None=0]="None";n[n.Source=1]="Source";n[n.Destination=2]="Destination";n[n.SourceThenDestination=3]="SourceThenDestination";n[n.DestinationThenSource=4]="DestinationThenSource"}(et=n.InterruptionSource||(n.InterruptionSource={}));!function(n){n[n.Simple1D=0]="Simple1D";n[n.SimpleDirectional2D=1]="SimpleDirectional2D";n[n.FreeformDirectional2D=2]="FreeformDirectional2D";n[n.FreeformCartesian2D=3]="FreeformCartesian2D";n[n.Direct=4]="Direct";n[n.Clip=5]="Clip"}(ot=n.BlendTreeType||(n.BlendTreeType={}));!function(n){n[n.Lower=0]="Lower";n[n.Upper=1]="Upper"}(st=n.BlendTreePosition||(n.BlendTreePosition={}));h=function(){function n(){}return n.JoystickRightHandleColor="yellow",n.JoystickLeftSensibility=1,n.JoystickRightSensibility=1,n.JoystickDeadStickValue=.1,n.GamepadDeadStickValue=.25,n.GamepadLStickXInverted=!1,n.GamepadLStickYInverted=!1,n.GamepadRStickXInverted=!1,n.GamepadRStickYInverted=!1,n.GamepadLStickSensibility=1,n.GamepadRStickSensibility=1,n.PointerAngularSensibility=1,n.PointerWheelDeadZone=.1,n}();n.UserInputOptions=h}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(t){var i=this;if(this._url="/",this._time=0,this._timing=!1,this._filename=null,this._input=!1,this._scene=null,this._navmesh=null,this._navigation=null,this._loadQueueIndex=0,this._loadQueueCount=0,this._loadQueueScenes=null,this._localReadyState=null,this._localSceneReady=!1,this._sunlightDirection=null,this._sunlightIdentifier=null,this._environmentTextureName=null,this._playerOneCamera=null,this._playerTwoCamera=null,this._playerThreeCamera=null,this._playerFourCamera=null,this._defaultControllers=!0,this._leftControllerStick=null,this._rightControllerStick=null,this._leftControllerPrefab=null,this._rightControllerPrefab=null,this._onready=[],null==t)throw new Error("Null host scene obejct specified.");this._url="/";this._time=0;this._timing=!0;this._filename=null;this._scene=t;this._input=!1;this._onready=[];this._vrhelper=null;this._navmesh=null;this._navigation=null;this._loadQueueIndex=0;this._loadQueueCount=0;this._loadQueueScenes=null;this._localSceneReady=!1;this._localReadyState={state:"localReadyState"};this._sunlightDirection=n.Vector3.Zero();this._sunlightIdentifier=null;this._playerOneCamera=null;this._playerTwoCamera=null;this._playerThreeCamera=null;this._playerFourCamera=null;this._defaultControllers=!0;this._leftControllerStick=null;this._rightControllerStick=null;this._leftControllerPrefab=null;this._rightControllerPrefab=null;this._environmentTextureName=null;n.SceneManager.me=this;n.SceneManager.engine=this._scene.getEngine();n.SceneManager.prefabs={};n.SceneManager.orphans=null;n.SceneManager.physicsViewer=null;n.SceneManager.enableLocking=!1;n.SceneManager.pointerLocked=!1;n.SceneManager.stereoCameras=!0;n.SceneManager.multiPlayerView=!1;n.SceneManager.multiPlayerCount=1;n.SceneManager.rightHanded=this._scene.useRightHandedSystem;n.SceneManager.showRenderStats=!1;n.SceneManager.sceneRenderStats=0;n.SceneManager.staticVertexLimit=!1;n.SceneManager.showDebugSockets=!1;n.SceneManager.showPhysicsImposter=!1;n.SceneManager.colliderVisibility=.25;n.SceneManager.socketColliderSize=.125;this.addLoadingState(this._localReadyState);n.SceneManager.engine.webGLVersion<2&&n.Tools.Warn("Babylon.js performance monitor detected webgl version 1.");document.addEventListener("pointerlockchange",this.pointerLockHandler);document.addEventListener("mspointerlockchange",this.pointerLockHandler);document.addEventListener("mozpointerlockchange",this.pointerLockHandler);document.addEventListener("webkitpointerlockchange",this.pointerLockHandler);this._scene.registerBeforeRender(this._beforeRender);this._scene.registerAfterRender(this._afterRender);this._scene.onDispose=function(){i.dispose()}}return t.GetVersion=function(){return"3.3.0"},t.GetInstance=function(){return n.SceneManager.me?n.SceneManager.me:null},t.GetStatistics=function(){return n.SceneManager.showRenderStats===!0&&null!=n.SceneManager.renderStatsInstance?n.SceneManager.renderStatsInstance:null},t.CreateScene=function(t){var i=new n.Scene(t);return n.Utilities.RegisterSceneManager(i),i},t.LoadScene=function(t,i,r,u,f,e,o){return n.SceneManager.AppendScene(t,i,n.SceneManager.CreateScene(r),u,f,e,o)},t.AppendScene=function(t,i,r,u,f,e,o){var s=r,h;return null==s.manager&&n.Utilities.RegisterSceneManager(r),null!=s.manager&&(s.manager._url=t),h=function(t){n.Utilities.ParseSceneMetadata(t);n.Utilities.ExecuteSceneReady(t);null!=u&&u(t)},n.SceneLoader.Append(t,i,r,h,f,e,o)},t.ImportMeshes=function(t,i,r,u,f,e,o,s){var c=u,h;return null==c.manager&&n.Utilities.RegisterSceneManager(u),h=function(t,i,r,e){n.Utilities.ParseImportMetadata(t,u);null!=f&&f(t,i,r,e)},n.SceneLoader.ImportMesh(t,i,r,u,h,e,o,s)},t.AttachComponent=function(t,i,r,u){void 0===r&&(r=!0);void 0===u&&(u={});n.Utilities.RegisterSceneComponent(t,i,r,u)},t.OnWindowLoad=function(n){null!=n&&(window.ontoolkitload=n)},t.OnDeviceReady=function(n){null!=n&&(window.ontoolkitdevice=n)},t.ExecuteWhenReady=function(t){null!=t&&n.SceneManager.readies.push(t)},t.IsOculusBrowser=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/OculusBrowser/i)&&(n=!0),n},t.IsSamsungBrowser=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/SamsungBrowser/i)&&(n=!0),n},t.IsWindowsPhone=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Windows Phone/i)&&(n=!0),n},t.IsBlackBerry=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/BlackBerry/i)&&(n=!0),n},t.IsOperaMini=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Opera Mini/i)&&(n=!0),n},t.IsAndroid=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Android/i)&&(n=!0),n},t.IsWebOS=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/webOS/i)&&(n=!0),n},t.IsIOS=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPhone|iPad|iPod/i)&&(n=!0),n},t.IsIPHONE=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPhone/i)&&(n=!0),n},t.IsIPAD=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPad/i)&&(n=!0),n},t.IsIPOD=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/iPod/i)&&(n=!0),n},t.IsIE11=function(){return void 0!==navigator.msMaxTouchPoints},t.IsMobile=function(){var t=!1,n;return null!=navigator&&null!=navigator.userAgent&&(n=navigator.userAgent,(n.match(/Android/i)||n.match(/webOS/i)||n.match(/iPhone|iPad|iPod/i)||n.match(/BlackBerry/i)||n.match(/Opera Mini/i)||n.match(/Windows Phone/i))&&(t=!0)),t},t.IsCordova=function(){return null!=window.cordova},t.IsWindows=function(){return"undefined"!=typeof Windows&&"undefined"!=typeof Windows.UI&&"undefined"!=typeof Windows.System&&"undefined"!=typeof Windows.Foundation},t.IsPlaystation=function(){var n=!1;return null!=navigator&&null!=navigator.userAgent&&navigator.userAgent.match(/Playstation/i)&&(n=!0),n},t.IsXboxOne=function(){var t=!1,i;return n.SceneManager.IsWindows()&&"undefined"!=typeof Windows.System.Profile&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo.versionInfo&&"undefined"!=typeof Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily&&(i=Windows.System.Profile.AnalyticsInfo.versionInfo.deviceFamily,i.match(/Xbox/i)&&(t=!0)),t},t.IsXboxLive=function(){return n.SceneManager.IsWindows()&&"undefined"!=typeof Microsoft&&"undefined"!=typeof Microsoft.Xbox&&"undefined"!=typeof Microsoft.Xbox.Services},t.IsWebAssembly=function(){return null!=window.WebAssembly},t.IsStereoCameras=function(){return n.SceneManager.stereoCameras},t.IsMultiPlayerView=function(){return n.SceneManager.multiPlayerView},t.GetMultiPlayerCount=function(){return n.SceneManager.multiPlayerCount},t.IsFirelightEnabled=function(){return null!=window.FMODModule},t.GetFirelightAudioMode=function(){return null!=window.firelightAudio?window.firelightAudio:0},t.CreateGenericPromise=function(n){return window.createGenericPromise?window.createGenericPromise(n):null},t.ResolveGenericPromise=function(n){return window.resolveGenericPromise?window.resolveGenericPromise(n):null},t.GetQueryStringParam=function(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},t.AlertMessage=function(t,i){void 0===i&&(i="Babylon.js");var r=null;return n.SceneManager.IsWindows()?r=new Windows.UI.Popups.MessageDialog(t,i).showAsync():window.alert(t),r},t.GetWebGLVersionString=function(){var r="WebGL - Unknown",i,t;return null!=n.SceneManager.engine&&(i=n.SceneManager.engine,null!=i&&(t=i.getGlInfo(),null!=t&&(r=t.version+" - "+t.renderer))),r},t.GetWebGLVersionNumber=function(){var i=0,t;return null!=n.SceneManager.engine&&(t=n.SceneManager.engine,null!=t&&(i=t.webGLVersion)),i},t.GetWebVRLeftController=function(){return n.SceneManager.me?n.SceneManager.me._leftControllerStick:null},t.GetWebVRRightController=function(){return n.SceneManager.me?n.SceneManager.me._rightControllerStick:null},t.GetWebVRLeftControllerPrefab=function(){return n.SceneManager.me?n.SceneManager.me._leftControllerPrefab:null},t.GetWebVRRightControllerPrefab=function(){return n.SceneManager.me?n.SceneManager.me._rightControllerPrefab:null},t.ShowWebVRDefaultControllers=function(t,i){void 0===t&&(t=null);void 0===i&&(i=null);n.SceneManager.me&&(null!=n.SceneManager.me._leftControllerStick&&(n.SceneManager.me._leftControllerStick.mesh.setEnabled(!1),n.SceneManager.me._leftControllerStick.attachToMesh(n.SceneManager.me._leftControllerStick.defaultModel),n.SceneManager.me._leftControllerStick.mesh.setEnabled(!0),n.SceneManager.me._defaultControllers=!0),null!=n.SceneManager.me._rightControllerStick&&(n.SceneManager.me._rightControllerStick.mesh.setEnabled(!1),n.SceneManager.me._rightControllerStick.attachToMesh(n.SceneManager.me._rightControllerStick.defaultModel),n.SceneManager.me._rightControllerStick.mesh.setEnabled(!0),n.SceneManager.me._defaultControllers=!0),null!=n.SceneManager.me.webvr&&(null!=t&&(n.SceneManager.me.webvr.displayGaze=t),null!=i&&(n.SceneManager.me.webvr.displayLaserPointer=i)))},t.ShowWebVRCustomControllers=function(t,i){void 0===t&&(t=null);void 0===i&&(i=null);n.SceneManager.me&&(null!=n.SceneManager.me._leftControllerStick&&(n.SceneManager.me._leftControllerStick.mesh.setEnabled(!1),n.SceneManager.me._leftControllerStick.attachToMesh(n.SceneManager.me._leftControllerPrefab),n.SceneManager.me._leftControllerStick.mesh.setEnabled(!0),n.SceneManager.me._defaultControllers=!1),null!=n.SceneManager.me._rightControllerStick&&(n.SceneManager.me._rightControllerStick.mesh.setEnabled(!1),n.SceneManager.me._rightControllerStick.attachToMesh(n.SceneManager.me._rightControllerPrefab),n.SceneManager.me._rightControllerStick.mesh.setEnabled(!0),n.SceneManager.me._defaultControllers=!1),null!=n.SceneManager.me.webvr&&(null!=t&&(n.SceneManager.me.webvr.displayGaze=t),null!=i&&(n.SceneManager.me.webvr.displayLaserPointer=i)))},Object.defineProperty(t,"StaticIndex",{get:function(){return 30},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PrefabIndex",{get:function(){return 31},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webvr",{get:function(){return this._vrhelper},set:function(n){this._vrhelper=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this._time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaTime",{get:function(){return null!=n.SceneManager.engine?n.SceneManager.engine.getDeltaTime()/1e3:0},enumerable:!0,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype._beforeRender=function(){n.SceneManager.showRenderStats===!0&&null!=n.SceneManager.renderStatsInstance&&n.SceneManager.renderStatsInstance.begin()},t.prototype._afterRender=function(){n.SceneManager.showRenderStats===!0&&null!=n.SceneManager.renderStatsInstance&&n.SceneManager.renderStatsInstance.end();var t=n.SceneManager.me;null!=t&&(t._timing&&(t._time+=t.deltaTime,t._time>=n.SceneManager.max&&(t._time=0)),t._input&&n.SceneManager.updateUserInput())},t.prototype._parseSceneMetadata=function(){var i,r,u,t;null!=this._scene.metadata&&null!=this._scene.metadata.properties&&((this._scene.metadata.properties.sceneFilename&&null!=this._scene.metadata.properties.sceneFilename&&(this._filename=this._scene.metadata.properties.sceneFilename),this._scene.metadata.properties.sunlightIndentifier&&null!=this._scene.metadata.properties.sunlightIndentifier&&(this._sunlightIdentifier=this._scene.metadata.properties.sunlightIndentifier),this._scene.metadata.properties.sunlightDirection&&null!=this._scene.metadata.properties.sunlightDirection)&&(i=this._scene.metadata.properties.sunlightDirection,null!=i&&i.length>=3&&(this._sunlightDirection=new n.Vector3(i[0],i[1],i[2]))),this._scene.metadata.properties.environmentTextureName&&null!=this._scene.metadata.properties.environmentTextureName&&(this._environmentTextureName=this._scene.metadata.properties.environmentTextureName),this._scene.metadata.properties.colliderVisibility&&null!=this._scene.metadata.properties.colliderVisibility&&(n.SceneManager.colliderVisibility=this._scene.metadata.properties.colliderVisibility),this._scene.metadata.properties.socketColliderSize&&null!=this._scene.metadata.properties.socketColliderSize&&(n.SceneManager.socketColliderSize=this._scene.metadata.properties.socketColliderSize),this._scene.metadata.properties.sceneRenderStats&&null!=this._scene.metadata.properties.sceneRenderStats&&(n.SceneManager.sceneRenderStats=this._scene.metadata.properties.sceneRenderStats),this._scene.metadata.properties.hasOwnProperty("showRenderStats")&&(n.SceneManager.showRenderStats=this._scene.metadata.properties.showRenderStats),this._scene.metadata.properties.hasOwnProperty("showDebugSockets")&&(n.SceneManager.showDebugSockets=this._scene.metadata.properties.showDebugSockets),this._scene.metadata.properties.hasOwnProperty("showPhysicsImposter")&&(n.SceneManager.showPhysicsImposter=this._scene.metadata.properties.showPhysicsImposter),this._scene.metadata.properties.hasOwnProperty("staticVertexLimit")&&(n.SceneManager.staticVertexLimit=this._scene.metadata.properties.staticVertexLimit),r=(this._scene.metadata.properties.physicsEngine?this._scene.metadata.properties.physicsEngine:"cannon",!!this._scene.metadata.properties.enablePhysics&&this._scene.metadata.properties.enablePhysics),r===!0&&(u=new n.CannonJSPlugin(!1,10),this._scene.enablePhysics(this._scene.gravity,u)));t=[];n.SceneManager.parseSceneCameras(this._scene.cameras,this._scene,t);n.SceneManager.parseSceneLights(this._scene.lights,this._scene,t);n.SceneManager.parseSceneMeshes(this._scene.meshes,this._scene,t);t.length>0&&(t.sort(function(n,t){return n.order<t.order?-1:n.order>t.order?1:0}),t.forEach(function(n){n.instance.register()}));n.SceneManager.IsIE11()||"undefined"!=typeof Stats&&n.SceneManager.showRenderStats===!0&&null==n.SceneManager.renderStatsInstance&&(n.SceneManager.renderStatsInstance=new Stats,n.SceneManager.renderStatsInstance.showPanel(n.SceneManager.sceneRenderStats),document.body.appendChild(n.SceneManager.renderStatsInstance.dom))},t.prototype.dispose=function(){this._scene.unregisterBeforeRender(this._beforeRender);this._scene.unregisterAfterRender(this._afterRender);document.removeEventListener("pointerlockchange",this.pointerLockHandler);document.removeEventListener("mspointerlockchange",this.pointerLockHandler);document.removeEventListener("mozpointerlockchange",this.pointerLockHandler);document.removeEventListener("webkitpointerlockchange",this.pointerLockHandler);n.SceneManager.me=null;n.SceneManager.engine=null;n.SceneManager.prefabs=null;n.SceneManager.orphans=null;n.SceneManager.stereoCameras=!0;n.SceneManager.rightHanded=!0;null!=n.SceneManager.orphans&&(n.SceneManager.orphans.dispose(),n.SceneManager.orphans=null);null!=n.SceneManager.physicsViewer&&(n.SceneManager.physicsViewer.dispose(),n.SceneManager.physicsViewer=null);this.disableUserInput();this._time=0;this._navmesh=null;this._timing=!1;this._onready=null;this._navigation=null;this._defaultControllers=!0;this._leftControllerStick=null;this._rightControllerStick=null;this._playerOneCamera=null;null!=this._playerTwoCamera&&(this._playerTwoCamera.dispose(),this._playerTwoCamera=null);null!=this._playerThreeCamera&&(this._playerThreeCamera.dispose(),this._playerThreeCamera=null);null!=this._playerFourCamera&&(this._playerFourCamera.dispose(),this._playerFourCamera=null);null!=this._leftControllerPrefab&&(this._leftControllerPrefab.dispose(),this._leftControllerPrefab=null);null!=this._rightControllerPrefab&&(this._rightControllerPrefab.dispose(),this._rightControllerPrefab=null);null!=this._vrhelper&&(this._vrhelper.dispose(),this._vrhelper=null);var t=this._scene;t.manager&&(t.manager=null);t=null;this._scene=null},t.prototype.alert=function(t,i){return void 0===i&&(i="Babylon.js"),n.SceneManager.AlertMessage(t,i)},t.prototype.once=function(n){var r=this,i,t;null!=n&&(i=!1,t=null,t=function(){r._scene.unregisterBeforeRender(t);t=null;i===!1&&(i=!0,n())},this._scene.registerBeforeRender(t))},t.prototype.delay=function(n,t){var r=this,i=null;return i=window.requestTimeout(function(){null!=i&&r.cancelDelay(i);null!=n&&n()},t)},t.prototype.cancelDelay=function(n){window.clearRequestTimeout(n)},t.prototype.repeat=function(n,t){return window.requestInterval(n,t)},t.prototype.cancelRepeat=function(n){window.clearRequestInterval(n)},t.prototype.enableTime=function(){this._time=0;this._timing=!0},t.prototype.disableTime=function(){this._time=0;this._timing=!1},t.prototype.safeDestroy=function(t,i,r){void 0===i&&(i=5);void 0===r&&(r=!1);r===!0&&t.setEnabled(!1);i>0?this.delay(function(){n.SceneManager.DestroyComponents(t);n.SceneManager.DisposeOwner(t)},i):(n.SceneManager.DestroyComponents(t),n.SceneManager.DisposeOwner(t))},t.prototype.getMainCamera=function(t){void 0===t&&(t=n.PlayerNumber.One);var i=null;switch(t){case n.PlayerNumber.One:i=this._playerOneCamera;break;case n.PlayerNumber.Two:i=this._playerTwoCamera;break;case n.PlayerNumber.Three:i=this._playerThreeCamera;break;case n.PlayerNumber.Four:i=this._playerFourCamera}return i},t.prototype.getSceneName=function(){return null!=this._filename&&""!==this._filename?this._filename:"Unknown.babylon"},t.prototype.getScenePath=function(){return this._url},t.prototype.getSunlight=function(){return null!=this._sunlightIdentifier&&""!==this._sunlightIdentifier?this._scene.getLightByID(this._sunlightIdentifier):null},t.prototype.getSunlightDirection=function(){return this._sunlightDirection},t.prototype.getEnvironmentTextureName=function(){return this._environmentTextureName},t.prototype.addLoadingState=function(n){this._scene._addPendingData(n)},t.prototype.removeLoadingState=function(n){this._scene._removePendingData(n)},t.prototype.onready=function(n){null!=n&&(this._localSceneReady===!0?n():this._onready.push(n))},t.prototype._executeWhenReady=function(){null!=this._scene.metadata&&null!=this._scene.metadata.imports?(this._loadQueueIndex=0,this._loadQueueScenes=this._scene.metadata.imports,this._loadQueueScenes.length>0?(this._loadQueueCount=this._loadQueueScenes.length,this._loadQueueImports()):this._executeLocalReady()):this._executeLocalReady()},t.prototype._executeLocalReady=function(){var u=this,t,i,r;(null!=n.SceneManager.readies&&n.SceneManager.readies.length>0&&n.SceneManager.readies.forEach(function(n){n(u._scene,u)}),n.SceneManager.readies=[],null!=this._onready&&this._onready.length>0&&(this._onready.forEach(function(n){n()}),this._onready=null),this._localSceneReady=!0,null!=this._scene.metadata&&null!=this._scene.metadata.properties)&&(this._scene.metadata.properties.enableUserInput===!0&&(t=this._scene.metadata.properties.userInput,i=t.joystickInputValue,0!==i&&this._scene.metadata.properties.virtualJoystickAttached===!0&&(i=0,n.Tools.Warn("Virtual joystick camera attached, disabled manual joystick input.")),this.enableUserInput({preventDefault:this._scene.metadata.properties.preventDefault,useCapture:this._scene.metadata.properties.useCapture,enableVirtualJoystick:1===i||2===i&&n.SceneManager.IsMobile(),disableRightStick:t.disableRightStick}),r=t.joystickRightColorText,null!=r&&""!==r&&(n.UserInputOptions.JoystickRightHandleColor=r),n.UserInputOptions.JoystickLeftSensibility=t.joystickLeftLevel,n.UserInputOptions.JoystickRightSensibility=t.joystickRightLevel,n.UserInputOptions.JoystickDeadStickValue=t.joystickDeadStick,n.UserInputOptions.GamepadDeadStickValue=t.padDeadStick,n.UserInputOptions.GamepadLStickXInverted=t.padLStickXInvert,n.UserInputOptions.GamepadLStickYInverted=t.padLStickYInvert,n.UserInputOptions.GamepadRStickXInverted=t.padRStickXInvert,n.UserInputOptions.GamepadRStickYInverted=t.padRStickYInvert,n.UserInputOptions.GamepadLStickSensibility=t.padLStickLevel,n.UserInputOptions.GamepadRStickSensibility=t.padRStickLevel,n.UserInputOptions.PointerAngularSensibility=t.mouseAngularLevel,n.UserInputOptions.PointerWheelDeadZone=t.wheelDeadZone),this._scene.metadata.properties.pointerLock===!0&&(this.attachPointerLock(),this.enablePointerLock()));null!=this._localReadyState&&(this.removeLoadingState(this._localReadyState),this._localReadyState=null)},t.prototype._loadQueueImports=function(){var i=this,r=this._loadQueueIndex+1,t;r>this._loadQueueCount?(this._loadQueueIndex=0,this._loadQueueCount=0,this._loadQueueScenes=null,this._executeLocalReady()):(t=this._loadQueueScenes[this._loadQueueIndex],n.Tools.Log("Babylon.js importing scene meshes from: "+t),this._loadQueueIndex++,navigator.project.importMeshes(t,function(){i._loadQueueImports()},null,function(t,r){n.Tools.Warn(r);i._loadQueueImports()}))},t.prototype.popupDebug=function(n){void 0===n&&(n=0);this._scene.debugLayer&&(this._scene.debugLayer.hide(),this._scene.debugLayer.show({enablePopup:!0,globalRoot:null}))},t.prototype.toggleDebug=function(t,i,r){var u;(void 0===t&&(t=!1),void 0===i&&(i=0),void 0===r&&(r=null),this._scene.debugLayer)&&(n.SceneManager.debugLayerVisible===!0?((n.SceneManager.debugLayerVisible=!1,null!=n.SceneManager.renderStatsInstance&&null!=n.SceneManager.renderStatsInstance.dom)&&(u=n.SceneManager.renderStatsInstance.dom,u.style.visibility="visible"),this._scene.debugLayer.hide()):((n.SceneManager.debugLayerVisible=!0,null!=n.SceneManager.renderStatsInstance&&null!=n.SceneManager.renderStatsInstance.dom)&&(u=n.SceneManager.renderStatsInstance.dom,u.style.visibility="hidden"),this._scene.debugLayer.show({enablePopup:t,globalRoot:r})))},t.prototype.setMultiPlayerViewLayout=function(t){var u=!1,r=n.Scalar.Clamp(t,1,4),i;return n.SceneManager.IsMultiPlayerView()?(i=[],null!=this._playerOneCamera&&null!=this._playerTwoCamera&&null!=this._playerThreeCamera&&null!=this._playerFourCamera?1===r?(this._playerOneCamera.viewport=new n.Viewport(0,0,1,1),this._playerTwoCamera.viewport=new n.Viewport(0,0,0,0),this._playerTwoCamera.setEnabled(!1),this._playerThreeCamera.viewport=new n.Viewport(0,0,0,0),this._playerThreeCamera.setEnabled(!1),this._playerFourCamera.viewport=new n.Viewport(0,0,0,0),this._playerFourCamera.setEnabled(!1),i.push(this._playerOneCamera)):2===r?(n.SceneManager.stereoCameras===!0?(this._playerOneCamera.viewport=new n.Viewport(0,0,.5,1),this._playerTwoCamera.viewport=new n.Viewport(.5,0,.5,1)):(this._playerOneCamera.viewport=new n.Viewport(0,.5,1,.5),this._playerTwoCamera.viewport=new n.Viewport(0,0,1,.5)),this._playerTwoCamera.setEnabled(!0),this._playerThreeCamera.viewport=new n.Viewport(0,0,0,0),this._playerThreeCamera.setEnabled(!1),this._playerFourCamera.viewport=new n.Viewport(0,0,0,0),this._playerFourCamera.setEnabled(!1),i.push(this._playerOneCamera),i.push(this._playerTwoCamera)):3===r?(this._playerOneCamera.viewport=new n.Viewport(0,0,.5,1),this._playerTwoCamera.viewport=new n.Viewport(.5,.5,.5,.5),this._playerTwoCamera.setEnabled(!0),this._playerThreeCamera.viewport=new n.Viewport(.5,0,.5,.5),this._playerThreeCamera.setEnabled(!0),this._playerFourCamera.viewport=new n.Viewport(0,0,0,0),this._playerFourCamera.setEnabled(!1),i.push(this._playerOneCamera),i.push(this._playerTwoCamera),i.push(this._playerThreeCamera)):4===r&&(this._playerOneCamera.viewport=new n.Viewport(0,.5,.5,.5),this._playerTwoCamera.viewport=new n.Viewport(0,0,.5,.5),this._playerTwoCamera.setEnabled(!0),this._playerThreeCamera.viewport=new n.Viewport(.5,.5,.5,.5),this._playerThreeCamera.setEnabled(!0),this._playerFourCamera.viewport=new n.Viewport(.5,0,.5,.5),this._playerFourCamera.setEnabled(!0),i.push(this._playerOneCamera),i.push(this._playerTwoCamera),i.push(this._playerThreeCamera),i.push(this._playerFourCamera)):n.Tools.Warn("Babylon.js camera rig failed to initialize multi player cameras"),i.length>0?(n.SceneManager.multiPlayerCount=r,this._scene.activeCameras=i,u=!0):n.Tools.Warn("Babylon.js camera rig failed to initialize multi player views")):n.Tools.Warn("Babylon.js camera rig multi player view option not enabled"),u},t.prototype.rayCast=function(n,t,i){return this._scene.pickWithRay(n,t,i)},t.prototype.multiRayCast=function(n,t){return this._scene.multiPickWithRay(n,t)},t.prototype.getMaterialInstance=function(n,t){void 0===t&&(t=null);var i=this._scene.getMaterialByName(n);return null==i&&null!=t&&(i=t(n)),null!=i?i:null},t.prototype.hasPrefabMesh=function(t){var i="Prefab."+t;return null!=n.SceneManager.prefabs[i]},t.prototype.getPrefabMesh=function(t){var i=null,r="Prefab."+t;return this.hasPrefabMesh(t)&&(i=n.SceneManager.prefabs[r]),i},t.prototype.instantiatePrefab=function(t,i,r,u,f,e){var a=this,o,c,v,s,y,l,h;return void 0===r&&(r=null),void 0===u&&(u=null),void 0===f&&(f=null),void 0===e&&(e=null),o=null,null!=this._scene&&(c="Prefab."+t,this.hasPrefabMesh(t)?(v=this.getPrefabMesh(t),null!=v?(o=v.clone(i,e,!1,!1),null!=o)?(o.name=n.Utilities.ReplaceAll(o.name,"Prefab.",""),o.parent!==e&&(o.parent=e),null!=r&&(o.position=r),null!=u&&(o.rotation=u),null!=f&&(o.scaling=f),s=null,y=o.getChildMeshes(!1),null!=y&&(s=y),null==s?s=[o]:s.unshift(o),l={},s.forEach(function(t){var r,u,f,i;if(t.name=n.Utilities.ReplaceAll(t.name,"Prefab.",""),t.setEnabled(!0),null!=t.metadata&&null!=t.metadata.shadowCastingMode&&0!==t.metadata.shadowCastingMode&&a._scene.lights.forEach(function(n){var i=n.getShadowGenerator();null!=i&&i.getShadowMap().renderList.push(t)}),null!=t.source){if(null==t.skeleton&&null!=t.source.skeleton&&(r=t.source.skeleton.name+".Skeleton",u=r+"."+t.source.skeleton.id,t.skeleton=t.source.skeleton.clone(r,u),l[t.source.id]=t.id,null!=t.skeleton&&null!=t.skeleton.bones&&null!=t.source.skeleton.bones&&t.skeleton.bones.length===t.source.skeleton.bones.length))for(f=t.skeleton.bones.length,i=0;i<f;i++)null==t.skeleton.bones[i].metadata&&null!=t.source.skeleton.bones[i].metadata&&(t.skeleton.bones[i].metadata=t.source.skeleton.bones[i].metadata)}else n.Tools.Warn("Babylon.js encountered a null clone source for: "+t.name)}),h=[],s.forEach(function(t){var f,i;if(null!=t.metadata&&null!=t.metadata.properties&&t.metadata.properties.sharedSkeletonId&&""!==t.metadata.properties.sharedSkeletonId&&(t.metadata.properties.sharedSkeletonId=l[t.metadata.properties.sharedSkeletonId]),null!=t.metadata&&t.metadata.tagName&&null!=t.metadata.tagName&&"[INSTANCE]"===t.metadata.tagName)if(t.metadata.properties&&null!=t.metadata.properties&&t.metadata.properties.prefabSource&&null!=t.metadata.properties.prefabSource&&""!==t.metadata.properties.prefabSource){var e=t.metadata.properties.prefabSource,o=t.metadata.properties.prefabOffset,r=t.metadata.properties.prefabPosition,u=a._scene.getMeshByID(e);null!=u?(f=t.name,i=u.createInstance(f),null!=i?(i.parent=t.parent,null!=u.metadata&&(i.metadata=n.SceneManager.CloneMetadata(u.metadata)),o===!0&&null!=r&&r.length>=3&&(i.position=new n.Vector3(r[0],r[1],r[2])),h.push(i),a.safeDestroy(t)):n.Tools.Warn("===> Failed to create instance: "+f)):n.Tools.Warn("===> Failed to locate prefab source: "+e)}else n.Tools.Warn("===> Failed to parse prefab metadata: "+t.name);else h.push(t)}),l=null,null!=h&&h.length>0&&n.Utilities.ParseImportMetadata(h,this._scene)):n.Tools.Warn("Failed to create prefab of: "+c):n.Tools.Warn("Failed to lookup prefab map: "+c)):n.Tools.Warn("Unable to locate prefab master: "+c)),o},t.prototype.tween=function(t,i,r,u,f,e,o,s,h,c,l){void 0===e&&(e=30);void 0===o&&(o=null);void 0===s&&(s=1);void 0===h&&(h=null);void 0===c&&(c=n.Animation.ANIMATIONLOOPMODE_RELATIVE);void 0===l&&(l=!1);var a="Tween_"+this.time.toString();return n.Animation.CreateAndStartAnimation(a,t,i,e,f,r,u,c,o,h)},t.prototype.tweenKeys=function(t,i,r,u,f,e,o,s,h,c,l){void 0===f&&(f=30);void 0===e&&(e=null);void 0===o&&(o=1);void 0===s&&(s=null);void 0===h&&(h=n.Animation.ANIMATIONTYPE_VECTOR3);void 0===c&&(c=n.Animation.ANIMATIONLOOPMODE_RELATIVE);void 0===l&&(l=!1);var v=null!=f&&f>0?f:30,y="Tween_"+this.time.toString(),a=new n.Animation(y,i,v,h,c,l);return null!=e&&a.setEasingFunction(e),a.setKeys(r),this._scene.beginDirectAnimation(t,[a],0,u,c==n.Animation.ANIMATIONLOOPMODE_RELATIVE,o,s)},t.prototype.tweenFloat=function(t,i,r,u,f,e,o,s,h,c,l){void 0===e&&(e=30);void 0===o&&(o=null);void 0===s&&(s=1);void 0===h&&(h=null);void 0===c&&(c=n.Animation.ANIMATIONLOOPMODE_RELATIVE);void 0===l&&(l=!1);var v=null!=e&&e>0?e:30,y=[{frame:0,value:r},{frame:f,value:u}],p="Tween_"+this.time.toString(),w=n.Animation.ANIMATIONTYPE_FLOAT,a=new n.Animation(p,i,v,w,c,l);return null!=o&&a.setEasingFunction(o),a.setKeys(y),this._scene.beginDirectAnimation(t,[a],0,f,c==n.Animation.ANIMATIONLOOPMODE_RELATIVE,s,h)},t.prototype.playAnimationClip=function(n,t,i,r,u,f,e){var a,p,g,nt;void 0===i&&(i=0);void 0===r&&(r=1);void 0===u&&(u=!0);void 0===f&&(f=null);void 0===e&&(e=null);var h=null,o=-1,s=-1,y=0,c=!1,b=!1,k=null,l=this.findSceneAnimationClip(n,t);if((null!=l&&(b=!0,k=e,o===-1&&(o=l.start,s=l.stop,y=l.behavior,c=l.behavior<2)),u)&&(a=t.getChildMeshes(!1),null!=a&&a.length>0))for(p=0;p<a.length;p++){var w=a[p],d=null,v=this.findSceneAnimationClip(n,w);null!=v&&(b===!1&&(b=!0,d=e),o===-1&&(o=v.start,s=v.stop,y=v.behavior,c=v.behavior<2),o>=0&&s>=0)&&(this.setAnimationProperties(w,y,i),g=null,null!=f?this._scene.beginDirectAnimation(w,f,o,s,c,r,d):this._scene.beginAnimation(w,o,s,c,r,d),null!=g&&(null==h&&(h=[]),h.push(g)))}return o>=0&&s>=0&&(this.setAnimationProperties(t,y,i),nt=null,null!=f?this._scene.beginDirectAnimation(t,f,o,s,c,r,k):this._scene.beginAnimation(t,o,s,c,r,k),null!=nt&&(null==h&&(h=[]),h.push(nt))),h},t.prototype.getAnimationClips=function(n,t,i){var r,u,f,e;if(void 0===t&&(t=!0),void 0===i&&(i=!1),r=this.findSceneAnimationClips(n),null==r&&t===!0&&(u=n.getChildMeshes(i),null!=u&&u.length>0))for(f=0;f<u.length;f++)if(e=u[f],r=this.findSceneAnimationClips(e),null!=r)break;return r},t.prototype.getAnimationTargets=function(n,t,i){var r,f,e,u;if(void 0===t&&(t=!0),void 0===i&&(i=!1),r=null,(null!=n.metadata&&null!=n.metadata.animationClips&&n.metadata.animationClips.length>0&&(null==r&&(r=[]),r.push(n)),t===!0)&&(f=n.getChildMeshes(i),null!=f&&f.length>0))for(e=0;e<f.length;e++)u=f[e],null!=u&&null!=u.metadata&&null!=u.metadata.animationClips&&u.metadata.animationClips.length>0&&(null==r&&(r=[]),r.push(u));return r},t.prototype.setAnimationProperties=function(t,i,r){if(null!=t&&(null!=t.animations&&t.animations.length>0&&n.SceneManager.SetAnimationLooping(t,i),t instanceof n.AbstractMesh)){var u=t;null!=u.skeleton&&n.SceneManager.SetSkeletonProperties(u.skeleton,i,r)}},t.prototype.applyForce=function(n,t,i){null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&null!=t&&n.physicsImpostor.applyForce(t,i)},t.prototype.applyImpulse=function(n,t,i){null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&null!=t&&n.physicsImpostor.applyImpulse(t,i)},t.prototype.applyFriction=function(n,t){null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&null!=n.physicsImpostor.physicsBody.material&&n.physicsImpostor.physicsBody.material.friction!==t&&(n.physicsImpostor.physicsBody.material.friction=t)},t.prototype.getMass=function(n){var t=-1;return null!=n&&null!=n.physicsImpostor&&(t=n.physicsImpostor.mass),t},t.prototype.setMass=function(n,t){null!=n&&null!=n.physicsImpostor&&(n.physicsImpostor.mass=t)},t.prototype.getRestitution=function(n){var t=-1;return null!=n&&null!=n.physicsImpostor&&(t=n.physicsImpostor.restitution),t},t.prototype.setRestitution=function(n,t){null!=n&&null!=n.physicsImpostor&&(n.physicsImpostor.restitution=t)},t.prototype.getFrictionLevel=function(n){var t=0;return null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&null!=n.physicsImpostor.physicsBody.material&&(t=n.physicsImpostor.physicsBody.material.friction),t},t.prototype.getLinearVelocity=function(n){var t=null;return null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&(t=n.physicsImpostor.getLinearVelocity()),t},t.prototype.setLinearVelocity=function(n,t){null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&null!=t&&n.physicsImpostor.setLinearVelocity(t)},t.prototype.getAngularVelocity=function(n){var t=null;return null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&(t=n.physicsImpostor.getAngularVelocity()),t},t.prototype.setAngularVelocity=function(n,t){null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&null!=t&&n.physicsImpostor.setAngularVelocity(t)},t.prototype.showDebugImposter=function(t){null!=t&&null!=t.physicsImpostor&&null!=t.physicsImpostor.physicsBody&&(null==n.SceneManager.physicsViewer&&(n.SceneManager.physicsViewer=new n.Debug.PhysicsViewer(this._scene)),null!=n.SceneManager.physicsViewer&&n.SceneManager.physicsViewer.showImpostor(t.physicsImpostor))},t.prototype.hideDebugImposter=function(t){null!=t&&null!=t.physicsImpostor&&null!=t.physicsImpostor.physicsBody&&null!=n.SceneManager.physicsViewer&&n.SceneManager.physicsViewer.hideImpostor(t.physicsImpostor)},t.prototype.checkCollisionContact=function(n,t,i,r){void 0===r&&(r=.5);var u=!1;return null!=n&&null!=n.physicsImpostor&&null!=n.physicsImpostor.physicsBody&&(u=!0),u},t.prototype.moveWithCollisions=function(n,t){null!=n&&null!=t&&n.moveWithCollisions(t)},t.prototype.moveWithTranslation=function(n,t){null!=n&&null!=t&&n.position.addInPlace(t)},t.prototype.turnWithRotation=function(t,i){void 0===i&&(i=0);null!=t&&0!=i&&t.rotate(n.Axis.Y,i*n.Statics.Deg2Rad)},t.prototype.findSceneComponent=function(n,t){var f=null,i,r,u;if(null==t)throw new Error("Null owner scene obejct specified.");if(null!=t.metadata&&t.metadata.api&&(i=t.metadata,null!=i.components&&i.components.length>0))for(r=0;r<i.components.length;r++)if(u=i.components[r],null!=u.instance&&u.klass===n){f=u.instance;break}return null!=f?f:null},t.prototype.findSceneComponents=function(n,t){var f=null,i,r,u;if(null==t)throw new Error("Null owner scene obejct specified.");if(null!=t.metadata&&t.metadata.api&&(i=t.metadata,null!=i.components&&i.components.length>0))for(r=0;r<i.components.length;r++)u=i.components[r],null!=u.instance&&u.klass===n&&f.push(u.instance);return null!=f?f:null},t.prototype.findSceneMetadata=function(t){var i=null,r;return null!=t.metadata&&t.metadata.api&&(r=t.metadata,i=new n.ObjectMetadata(r)),i},t.prototype.findSceneChildMesh=function(t,i,r,u,f){void 0===r&&(r=n.SearchType.StartsWith);void 0===u&&(u=!0);void 0===f&&(f=null);var e=(null!=r?r:n.SearchType.StartsWith,i.getChildMeshes(u,f));return n.SceneManager.FindMesh(t,e,r)},t.prototype.findSceneCollisionMesh=function(n,t,i){var r,u,e,f;if(void 0===t&&(t=!0),void 0===i&&(i=null),r=null,u=n.getChildMeshes(t,i),null!=u&&u.length>0)for(e=0;e<u.length;e++)if(f=u[e],"Collider"===f.name||f.name.indexOf("_Collider")>=0||f.name.indexOf(":Collider")>=0){r=f;break}return null==r&&(r=n),r},t.prototype.findSceneSkeleton=function(n){var r=null,u=null!=this._scene.skeletons?this._scene.skeletons.length:0,t,i,f;if(u>0)for(t=0,t=0;t<u;t++)if(i=this._scene.skeletons[t],f=""+i.id,f===n){r=i;break}return r},t.prototype.findSceneSocketMesh=function(t,i,r,u){var f,e,o,s;if(void 0===r&&(r=!0),void 0===u&&(u=null),f=n.SceneManager.LocateOwnerSocketMesh(t,i),null==f&&(e=i.getChildMeshes(r,u),null!=e&&e.length>0))for(o=0;o<e.length;o++)if(s=e[o],f=n.SceneManager.LocateOwnerSocketMesh(t,s),null!=f)break;return f},t.prototype.findSceneSocketMeshes=function(t,i,r){var u,f,e,o;if(void 0===i&&(i=!0),void 0===r&&(r=null),u=n.SceneManager.LocateOwnerSocketMeshes(t),null==u&&(f=t.getChildMeshes(i,r),null!=f&&f.length>0))for(e=0;e<f.length;e++)if(o=f[e],u=n.SceneManager.LocateOwnerSocketMeshes(o),null!=u)break;return u},t.prototype.findSceneAnimationClip=function(n,t){var u=null,i,r;if(null!=t&&null!=t.metadata&&t.metadata.api&&(i=t.metadata,null!=i.animationClips&&i.animationClips.length>0))if(null!=n&&""!==n){for(r=0,r=0;r<i.animationClips.length;r++)if(i.animationClips[r].name===n){u=i.animationClips[r];break}}else u=i.animationClips[0];return u},t.prototype.findSceneAnimationClips=function(n){var i=null,t;return null!=n&&null!=n.metadata&&n.metadata.api&&(t=n.metadata,null!=t.animationClips&&t.animationClips.length>0&&(i=t.animationClips)),i},t.prototype.findSceneParticleSystem=function(n,t){var u=null,f,i,r;if(null==t)throw new Error("Null owner scene obejct specified.");if(null!=this._scene.particleSystems&&this._scene.particleSystems.length>0)for(f=this._scene.particleSystems.length,i=0;i<f;i++)if(r=this._scene.particleSystems[i],r.emitter===t&&r.name===n){u=r;break}return u},t.prototype.findSceneParticleSystems=function(n){var t=[];if(null==n)throw new Error("Null owner scene obejct specified.");return null!=this._scene.particleSystems&&this._scene.particleSystems.length>0&&this._scene.particleSystems.forEach(function(i){i.emitter===n&&t.push(i)}),t},t.prototype.findSceneLensFlareSystem=function(n,t){var u=null,f,i,r;if(null==t)throw new Error("Null owner scene obejct specified.");if(null!=this._scene.lensFlareSystems&&this._scene.lensFlareSystems.length>0)for(f=this._scene.lensFlareSystems.length,i=0;i<f;i++)if(r=this._scene.lensFlareSystems[i],r.getEmitter()===t&&r.name===n){u=r;break}return u},t.prototype.findSceneLensFlareSystems=function(n){var t=[];if(null==n)throw new Error("Null owner scene obejct specified.");return null!=this._scene.lensFlareSystems&&this._scene.lensFlareSystems.length>0&&this._scene.lensFlareSystems.forEach(function(i){i.getEmitter()===n&&t.push(i)}),t},t.prototype.enablePointerLock=function(){n.SceneManager.enableLocking=!0},t.prototype.disablePointerLock=function(){n.SceneManager.enableLocking=!1},t.prototype.pointerLockHandler=function(){var t=document.pointerLockElement||document.msPointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null;n.SceneManager.pointerLocked=t?!0:!1},t.prototype.attachPointerLock=function(){this._scene.onPointerObservable.add(function(){if(n.SceneManager.enableLocking===!0&&n.SceneManager.pointerLocked===!1){var t=n.SceneManager.engine.getRenderingCanvas();null!=t&&(null!=t.requestPointerLock?t.requestPointerLock():null!=t.msRequestPointerLock?t.msRequestPointerLock():null!=t.mozRequestPointerLock?t.mozRequestPointerLock():null!=t.webkitRequestPointerLock&&t.webkitRequestPointerLock())}},n.PointerEventTypes.POINTERDOWN)},t.prototype.resetUserInput=function(){n.SceneManager.keymap={};n.SceneManager.wheel=0;n.SceneManager.clientx=0;n.SceneManager.clienty=0;n.SceneManager.mousex=0;n.SceneManager.mousey=0;n.SceneManager.vertical=0;n.SceneManager.horizontal=0;n.SceneManager.mousex2=0;n.SceneManager.mousey2=0;n.SceneManager.vertical2=0;n.SceneManager.horizontal2=0;n.SceneManager.mousex3=0;n.SceneManager.mousey3=0;n.SceneManager.vertical3=0;n.SceneManager.horizontal3=0;n.SceneManager.mousex4=0;n.SceneManager.mousey4=0;n.SceneManager.vertical4=0;n.SceneManager.horizontal4=0;n.SceneManager.x_wheel=0;n.SceneManager.x_mousex=0;n.SceneManager.x_mousey=0;n.SceneManager.x_vertical=0;n.SceneManager.x_horizontal=0;n.SceneManager.k_mousex=0;n.SceneManager.k_mousey=0;n.SceneManager.k_vertical=0;n.SceneManager.k_horizontal=0;n.SceneManager.j_mousex=0;n.SceneManager.j_mousey=0;n.SceneManager.j_vertical=0;n.SceneManager.j_horizontal=0;n.SceneManager.g_mousex1=0;n.SceneManager.g_mousey1=0;n.SceneManager.g_vertical1=0;n.SceneManager.g_horizontal1=0;n.SceneManager.g_mousex2=0;n.SceneManager.g_mousey2=0;n.SceneManager.g_vertical2=0;n.SceneManager.g_horizontal2=0;n.SceneManager.g_mousex3=0;n.SceneManager.g_mousey3=0;n.SceneManager.g_vertical3=0;n.SceneManager.g_horizontal3=0;n.SceneManager.g_mousex4=0;n.SceneManager.g_mousey4=0;n.SceneManager.g_vertical4=0;n.SceneManager.g_horizontal4=0;n.SceneManager.enableLocking=!1;n.SceneManager.pointerLocked=!1;n.SceneManager.preventDefault=!1;n.SceneManager.mouseButtonUp=[];n.SceneManager.mouseButtonDown=[];n.SceneManager.mouseButtonPress=[];n.SceneManager.keyButtonUp=[];n.SceneManager.keyButtonDown=[];n.SceneManager.keyButtonPress=[];n.SceneManager.gamepad1ButtonUp=[];n.SceneManager.gamepad1ButtonDown=[];n.SceneManager.gamepad1ButtonPress=[];n.SceneManager.gamepad1DpadUp=[];n.SceneManager.gamepad1DpadDown=[];n.SceneManager.gamepad1DpadPress=[];n.SceneManager.gamepad1LeftTrigger=[];n.SceneManager.gamepad1RightTrigger=[];n.SceneManager.gamepad2ButtonUp=[];n.SceneManager.gamepad2ButtonDown=[];n.SceneManager.gamepad2ButtonPress=[];n.SceneManager.gamepad2DpadUp=[];n.SceneManager.gamepad2DpadDown=[];n.SceneManager.gamepad2DpadPress=[];n.SceneManager.gamepad2LeftTrigger=[];n.SceneManager.gamepad2RightTrigger=[];n.SceneManager.gamepad3ButtonUp=[];n.SceneManager.gamepad3ButtonDown=[];n.SceneManager.gamepad3ButtonPress=[];n.SceneManager.gamepad3DpadUp=[];n.SceneManager.gamepad3DpadDown=[];n.SceneManager.gamepad3DpadPress=[];n.SceneManager.gamepad3LeftTrigger=[];n.SceneManager.gamepad3RightTrigger=[];n.SceneManager.gamepad4ButtonUp=[];n.SceneManager.gamepad4ButtonDown=[];n.SceneManager.gamepad4ButtonPress=[];n.SceneManager.gamepad4DpadUp=[];n.SceneManager.gamepad4DpadDown=[];n.SceneManager.gamepad4DpadPress=[];n.SceneManager.gamepad4LeftTrigger=[];n.SceneManager.gamepad4RightTrigger=[]},t.prototype.enableUserInput=function(t){void 0===t&&(t=null);var r=!(null==t||!t.preventDefault)&&t.preventDefault,i=!(null==t||!t.useCapture)&&t.useCapture,u=!(null==t||!t.enableVirtualJoystick)&&t.enableVirtualJoystick,f=!(null==t||!t.disableRightStick)&&t.disableRightStick;this._input||(this.resetUserInput(),document.documentElement.tabIndex=1,document.documentElement.addEventListener("keyup",n.SceneManager.inputKeyUpHandler,i),document.documentElement.addEventListener("keydown",n.SceneManager.inputKeyDownHandler,i),document.documentElement.addEventListener("pointerup",n.SceneManager.inputPointerUpHandler,i),document.documentElement.addEventListener("pointerdown",n.SceneManager.inputPointerDownHandler,i),document.documentElement.addEventListener("pointermove",n.SceneManager.inputPointerMoveHandler,i),document.documentElement.addEventListener("onwheel"in document?"wheel":"mousewheel",n.SceneManager.inputPointerWheelHandler,i),n.SceneManager.preventDefault=r,null==n.SceneManager.GamepadManager&&(n.SceneManager.GamepadManager=new n.GamepadManager,n.SceneManager.GamepadManager.onGamepadConnectedObservable.add(n.SceneManager.inputManagerGamepadConnected),n.SceneManager.GamepadManager.onGamepadDisconnectedObservable.add(n.SceneManager.inputManagerGamepadDisconnected)),n.SceneManager.virtualJoystick===!1&&(n.SceneManager.virtualJoystick=u,n.SceneManager.virtualJoystick===!0&&(null==n.SceneManager.leftJoystick&&(n.SceneManager.leftJoystick=new n.VirtualJoystick(!0),n.SceneManager.leftJoystick.setJoystickSensibility(5*n.UserInputOptions.JoystickLeftSensibility)),f===!1&&null==n.SceneManager.rightJoystick&&(n.SceneManager.rightJoystick=new n.VirtualJoystick(!1),n.SceneManager.rightJoystick.reverseUpDown=!0,n.SceneManager.rightJoystick.setJoystickSensibility(5*n.UserInputOptions.JoystickRightSensibility),n.SceneManager.rightJoystick.setJoystickColor(n.UserInputOptions.JoystickRightHandleColor)))),this._input=!0,document.documentElement.focus())},t.prototype.disableUserInput=function(t){void 0===t&&(t=!1);this._input&&(document.documentElement.removeEventListener("keyup",n.SceneManager.inputKeyUpHandler,t),document.documentElement.removeEventListener("keydown",n.SceneManager.inputKeyDownHandler,t),document.documentElement.removeEventListener("pointerup",n.SceneManager.inputPointerUpHandler,t),document.documentElement.removeEventListener("pointerdown",n.SceneManager.inputPointerDownHandler,t),document.documentElement.removeEventListener("pointermove",n.SceneManager.inputPointerMoveHandler,t),document.documentElement.removeEventListener("onwheel"in document?"wheel":"mousewheel",n.SceneManager.inputPointerWheelHandler,t),n.SceneManager.preventDefault=!1,this.resetUserInput(),this._input=!1)},t.prototype.getUserInput=function(t,i){void 0===i&&(i=n.PlayerNumber.One);var r=0;if(this._input)switch(t){case n.UserInputAxis.Vertical:case n.UserInputAxis.Horizontal:r=i===n.PlayerNumber.Four?t===n.UserInputAxis.Horizontal?n.SceneManager.horizontal4:n.SceneManager.vertical4:i===n.PlayerNumber.Three?t===n.UserInputAxis.Horizontal?n.SceneManager.horizontal3:n.SceneManager.vertical3:i===n.PlayerNumber.Two?t===n.UserInputAxis.Horizontal?n.SceneManager.horizontal2:n.SceneManager.vertical2:t===n.UserInputAxis.Horizontal?n.SceneManager.horizontal:n.SceneManager.vertical;break;case n.UserInputAxis.MouseX:case n.UserInputAxis.MouseY:r=i===n.PlayerNumber.Four?t===n.UserInputAxis.MouseX?n.SceneManager.mousex4:n.SceneManager.mousey4:i===n.PlayerNumber.Three?t===n.UserInputAxis.MouseX?n.SceneManager.mousex3:n.SceneManager.mousey3:i===n.PlayerNumber.Two?t===n.UserInputAxis.MouseX?n.SceneManager.mousex2:n.SceneManager.mousey2:t===n.UserInputAxis.MouseX?n.SceneManager.mousex:n.SceneManager.mousey;break;case n.UserInputAxis.ClientX:case n.UserInputAxis.ClientY:i===n.PlayerNumber.One&&(r=t===n.UserInputAxis.ClientX?n.SceneManager.clientx:n.SceneManager.clienty);break;case n.UserInputAxis.Wheel:i===n.PlayerNumber.One&&(r=n.SceneManager.wheel)}return r},t.prototype.onKeyboardUp=function(t){this._input&&n.SceneManager.keyButtonUp.push(t)},t.prototype.onKeyboardDown=function(t){this._input&&n.SceneManager.keyButtonDown.push(t)},t.prototype.onKeyboardPress=function(t,i){this._input&&n.SceneManager.keyButtonPress.push({index:t,action:i})},t.prototype.getKeyboardInput=function(t){var r=!1,i;return this._input&&(i="k:"+t.toString(),null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i])),r},t.prototype.onPointerUp=function(t){this._input&&n.SceneManager.mouseButtonUp.push(t)},t.prototype.onPointerDown=function(t){this._input&&n.SceneManager.mouseButtonDown.push(t)},t.prototype.onPointerPress=function(t,i){this._input&&n.SceneManager.mouseButtonPress.push({index:t,action:i})},t.prototype.getPointerInput=function(t){var r=!1,i;return this._input&&(i="p:"+t.toString(),null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i])),r},t.prototype.getLeftJoystick=function(){return this._input?n.SceneManager.leftJoystick:null},t.prototype.getRightJoystick=function(){return this._input?n.SceneManager.rightJoystick:null},t.prototype.getJoystickPress=function(t){var i=!1;return this._input&&(t===n.JoystickButton.Left&&null!=n.SceneManager.leftJoystick&&n.SceneManager.leftJoystick.pressed===!0?i=!0:t===n.JoystickButton.Right&&null!=n.SceneManager.rightJoystick&&n.SceneManager.rightJoystick.pressed===!0&&(i=!0)),i},t.prototype.disposeVirtualJoysticks=function(){this._input&&(null!=n.SceneManager.leftJoystick&&(n.SceneManager.leftJoystick.releaseCanvas(),n.SceneManager.leftJoystick=null),null!=n.SceneManager.rightJoystick&&(n.SceneManager.rightJoystick.releaseCanvas(),n.SceneManager.rightJoystick=null),n.SceneManager.virtualJoystick=!1)},t.prototype.onGamepadButtonUp=function(t,i){if(void 0===i&&(i=n.PlayerNumber.One),this._input)switch(i){case n.PlayerNumber.One:n.SceneManager.gamepad1ButtonUp.push(t);break;case n.PlayerNumber.Two:n.SceneManager.gamepad2ButtonUp.push(t);break;case n.PlayerNumber.Three:n.SceneManager.gamepad3ButtonUp.push(t);break;case n.PlayerNumber.Four:n.SceneManager.gamepad4ButtonUp.push(t)}},t.prototype.onGamepadButtonDown=function(t,i){if(void 0===i&&(i=n.PlayerNumber.One),this._input)switch(i){case n.PlayerNumber.One:n.SceneManager.gamepad1ButtonDown.push(t);break;case n.PlayerNumber.Two:n.SceneManager.gamepad2ButtonDown.push(t);break;case n.PlayerNumber.Three:n.SceneManager.gamepad3ButtonDown.push(t);break;case n.PlayerNumber.Four:n.SceneManager.gamepad4ButtonDown.push(t)}},t.prototype.onGamepadButtonPress=function(t,i,r){if(void 0===r&&(r=n.PlayerNumber.One),this._input)switch(r){case n.PlayerNumber.One:n.SceneManager.gamepad1ButtonPress.push({index:t,action:i});break;case n.PlayerNumber.Two:n.SceneManager.gamepad2ButtonPress.push({index:t,action:i});break;case n.PlayerNumber.Three:n.SceneManager.gamepad3ButtonPress.push({index:t,action:i});break;case n.PlayerNumber.Four:n.SceneManager.gamepad4ButtonPress.push({index:t,action:i})}},t.prototype.getGamepadButtonInput=function(t,i){var u,r;if(void 0===i&&(i=n.PlayerNumber.One),u=!1,this._input){r=null;switch(i){case n.PlayerNumber.One:r="b1:"+t.toString();break;case n.PlayerNumber.Two:r="b2:"+t.toString();break;case n.PlayerNumber.Three:r="b3:"+t.toString();break;case n.PlayerNumber.Four:r="b4:"+t.toString()}null!=r&&null!=n.SceneManager.keymap[r]&&(u=n.SceneManager.keymap[r])}return u},t.prototype.onGamepadDirectionUp=function(t,i){if(void 0===i&&(i=n.PlayerNumber.One),this._input)switch(i){case n.PlayerNumber.One:n.SceneManager.gamepad1DpadUp.push(t);break;case n.PlayerNumber.Two:n.SceneManager.gamepad2DpadUp.push(t);break;case n.PlayerNumber.Three:n.SceneManager.gamepad3DpadUp.push(t);break;case n.PlayerNumber.Four:n.SceneManager.gamepad4DpadUp.push(t)}},t.prototype.onGamepadDirectionDown=function(t,i){if(void 0===i&&(i=n.PlayerNumber.One),this._input)switch(i){case n.PlayerNumber.One:n.SceneManager.gamepad1DpadDown.push(t);break;case n.PlayerNumber.Two:n.SceneManager.gamepad2DpadDown.push(t);break;case n.PlayerNumber.Three:n.SceneManager.gamepad3DpadDown.push(t);break;case n.PlayerNumber.Four:n.SceneManager.gamepad4DpadDown.push(t)}},t.prototype.onGamepadDirectionPress=function(t,i,r){if(void 0===r&&(r=n.PlayerNumber.One),this._input)switch(r){case n.PlayerNumber.One:n.SceneManager.gamepad1DpadPress.push({index:t,action:i});break;case n.PlayerNumber.Two:n.SceneManager.gamepad2DpadPress.push({index:t,action:i});break;case n.PlayerNumber.Three:n.SceneManager.gamepad3DpadPress.push({index:t,action:i});break;case n.PlayerNumber.Four:n.SceneManager.gamepad4DpadPress.push({index:t,action:i})}},t.prototype.getGamepadDirectionInput=function(t,i){var u,r;if(void 0===i&&(i=n.PlayerNumber.One),u=!1,this._input){r=null;switch(i){case n.PlayerNumber.One:r="d1:"+t.toString();break;case n.PlayerNumber.Two:r="d2:"+t.toString();break;case n.PlayerNumber.Three:r="d3:"+t.toString();break;case n.PlayerNumber.Four:r="d4:"+t.toString()}null!=r&&null!=n.SceneManager.keymap[r]&&(u=n.SceneManager.keymap[r])}return u},t.prototype.onGamepadTriggerLeft=function(t,i){if(void 0===i&&(i=n.PlayerNumber.One),this._input)switch(i){case n.PlayerNumber.One:n.SceneManager.gamepad1LeftTrigger.push(t);break;case n.PlayerNumber.Two:n.SceneManager.gamepad2LeftTrigger.push(t);break;case n.PlayerNumber.Three:n.SceneManager.gamepad3LeftTrigger.push(t);break;case n.PlayerNumber.Four:n.SceneManager.gamepad4LeftTrigger.push(t)}},t.prototype.onGamepadTriggerRight=function(t,i){if(void 0===i&&(i=n.PlayerNumber.One),this._input)switch(i){case n.PlayerNumber.One:n.SceneManager.gamepad1RightTrigger.push(t);break;case n.PlayerNumber.Two:n.SceneManager.gamepad2RightTrigger.push(t);break;case n.PlayerNumber.Three:n.SceneManager.gamepad3RightTrigger.push(t);break;case n.PlayerNumber.Four:n.SceneManager.gamepad4RightTrigger.push(t)}},t.prototype.getGamepadTriggerInput=function(t,i){var u,r;if(void 0===i&&(i=n.PlayerNumber.One),u=0,this._input){r=null;switch(i){case n.PlayerNumber.One:r="t1:"+t.toString();break;case n.PlayerNumber.Two:r="t2:"+t.toString();break;case n.PlayerNumber.Three:r="t3:"+t.toString();break;case n.PlayerNumber.Four:r="t4:"+t.toString()}null!=r&&null!=n.SceneManager.keymap[r]&&(u=n.SceneManager.keymap[r])}return u},t.prototype.getGamepad=function(t){void 0===t&&(t=n.PlayerNumber.One);var i=null;if(this._input)switch(t){case n.PlayerNumber.One:i=n.SceneManager.gamepad1;break;case n.PlayerNumber.Two:i=n.SceneManager.gamepad2;break;case n.PlayerNumber.Three:i=n.SceneManager.gamepad3;break;case n.PlayerNumber.Four:i=n.SceneManager.gamepad4}return i},t.prototype.getGamepadType=function(t){void 0===t&&(t=n.PlayerNumber.One);var i=n.GamepadType.None;if(this._input)switch(t){case n.PlayerNumber.One:i=n.SceneManager.gamepad1Type;break;case n.PlayerNumber.Two:i=n.SceneManager.gamepad2Type;break;case n.PlayerNumber.Three:i=n.SceneManager.gamepad3Type;break;case n.PlayerNumber.Four:i=n.SceneManager.gamepad4Type}return i},t.prototype.updateCameraInput=function(t,i,r,u){if(void 0===u&&(u=n.PlayerNumber.One),null!=t){var f=this.getUserInput(n.UserInputAxis.Horizontal,u),e=this.getUserInput(n.UserInputAxis.Vertical,u),o=this.getUserInput(n.UserInputAxis.MouseX,u),s=this.getUserInput(n.UserInputAxis.MouseY,u);this.updateCameraPosition(t,f,e,i);this.updateCameraRotation(t,o,s,r)}},t.prototype.updateCameraPosition=function(t,i,r,u){if(null!=t){var f=t._computeLocalCameraSpeed()*u;n.SceneManager.TempMatrix.reset();n.Matrix.RotationYawPitchRollToRef(t.rotation.y,t.rotation.x,0,n.SceneManager.TempMatrix);n.SceneManager.AuxVector3.copyFromFloats(0,0,0);n.SceneManager.TempVector3.copyFromFloats(i*f,0,r*f);n.Vector3.TransformCoordinatesToRef(n.SceneManager.TempVector3,n.SceneManager.TempMatrix,n.SceneManager.AuxVector3);t.cameraDirection.addInPlace(n.SceneManager.AuxVector3)}},t.prototype.updateCameraRotation=function(t,i,r,u){null!=t&&(n.SceneManager.TempVector2.copyFromFloats(r*u,i*u),t.cameraRotation.addInPlace(n.SceneManager.TempVector2))},t.prototype.getNavigationTool=function(){return null==this._navigation&&(this._navigation=new Navigation),this._navigation},t.prototype.getNavigationZone=function(){return"scene"},t.prototype.findNavigationPath=function(n,t){if(null==this._navigation||null==this._navmesh||null==n||null==t)return null;var i=this.getNavigationZone(),r=this._navigation.getGroup(i,n);return this._navigation.findPath(n,t,i,r)},t.prototype.hasNavigationMesh=function(){return null!=this._navmesh},t.prototype.getNavigationMesh=function(){return this._navmesh},t.prototype.buildNavigationMesh=function(t){if(null!=t){console.log("Building navigation mesh...");this._navmesh=t;var i=this.getNavigationTool(),r=i.buildNodes(this._navmesh);null!=r?i.setZoneData(this.getNavigationZone(),r):n.Tools.Warn("Babylon.js failed to set scene navigation zone")}},t.prototype.getNavigationPoint=function(t,i,r){var e=this,f,u;return(void 0===i&&(i=2),void 0===r&&(r=Number.MAX_VALUE),null==this._navmesh||null==t)?null:(f=new n.Ray(t,new n.Vector3(0,-1,0),r),u=this._scene.pickWithRay(f,function(n){return n===e._navmesh}),u.hit&&u.pickedPoint?u.pickedPoint:null)},t.prototype.moveNavigationAgent=function(t,i,r,u,f){var h;if(i&&i.length>0){for(var o=0,s=[{frame:0,value:t.position}],e=0;e<i.length;e++)o+=n.Vector3.Distance(s[e].value,i[e]),s.push({frame:o,value:i[e]});h=new n.Animation("Move","position",3,n.Animation.ANIMATIONTYPE_VECTOR3,n.Animation.ANIMATIONLOOPMODE_RELATIVE);h.setKeys(s);t.animations.push(h);this._scene.beginAnimation(t,0,o,u,r,f)}},t.prototype.getNavigationAgents=function(){return this._scene.getMeshesByTags("[NAVAGENT]")},t.prototype.getNavigationAgentInfo=function(t){return new n.NavigationAgent(t)},t.prototype.getNavigationAreaTable=function(){return null!=this._navmesh.metadata&&null!=this._navmesh.metadata.properties&&null!=this._navmesh.metadata.properties.table?this._navmesh.metadata.properties.table:[]},t.prototype.getNavigationAreaIndexes=function(){return null!=this._navmesh.metadata&&null!=this._navmesh.metadata.properties&&null!=this._navmesh.metadata.properties.areas?this._navmesh.metadata.properties.areas:[]},t.prototype.getNavigationAreaName=function(n){var r="",t,i;if(null!=this._navmesh.metadata&&null!=this._navmesh.metadata.properties&&null!=this._navmesh.metadata.properties.table&&(t=this._navmesh.metadata.properties.table,null!=t))for(i=0;i<t.length;i++)if(t[i].index===n){r=t[i].area;break}return r},t.prototype.getNavigationAreaCost=function(n){var r=-1,t,i;if(null!=this._navmesh.metadata&&null!=this._navmesh.metadata.properties&&(t=this._navmesh.metadata.properties.table,null!=t))for(i=0;i<t.length;i++)if(t[i].index===n){r=t[i].cost;break}return r},t.inputKeyDownHandler=function(t){var i="k:"+t.keyCode.toString(),r=!1;switch(null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]),n.SceneManager.keymap[i]=!0,t.keyCode){case 39:case 68:n.SceneManager.k_horizontal=1;break;case 37:case 65:n.SceneManager.k_horizontal=-1;break;case 38:case 87:n.SceneManager.k_vertical=1;break;case 40:case 83:n.SceneManager.k_vertical=-1}return null!=n.SceneManager.keyButtonDown&&n.SceneManager.keyButtonDown.length>0&&n.SceneManager.keyButtonDown.forEach(function(n){n(t.keyCode)}),r||null!=n.SceneManager.keyButtonPress&&n.SceneManager.keyButtonPress.length>0&&n.SceneManager.keyButtonPress.forEach(function(n){n.index===t.keyCode&&n.action()}),n.SceneManager.preventDefault&&t.preventDefault(),!0},t.inputKeyUpHandler=function(t){var i="k:"+t.keyCode.toString();switch(n.SceneManager.keymap[i]=!1,t.keyCode){case 39:case 37:case 68:case 65:n.SceneManager.k_horizontal=0;break;case 38:case 40:case 87:case 83:n.SceneManager.k_vertical=0}return null!=n.SceneManager.keyButtonUp&&n.SceneManager.keyButtonUp.length>0&&n.SceneManager.keyButtonUp.forEach(function(n){n(t.keyCode)}),n.SceneManager.preventDefault&&t.preventDefault(),!0},t.inputPointerWheelHandler=function(t){var i=t.deltaY?-t.deltaY:t.wheelDelta/40;return n.SceneManager.x_wheel=Math.abs(i)>n.UserInputOptions.PointerWheelDeadZone?0+i:0,n.SceneManager.preventDefault&&t.preventDefault(),!0},t.inputPointerDownHandler=function(t){0===t.button&&(n.SceneManager.previousPosition={x:t.clientX,y:t.clientY});var i="p:"+t.button.toString(),r=!1;return null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]),n.SceneManager.keymap[i]=!0,null!=n.SceneManager.mouseButtonDown&&n.SceneManager.mouseButtonDown.length>0&&n.SceneManager.mouseButtonDown.forEach(function(n){n(t.button)}),r||null!=n.SceneManager.mouseButtonPress&&n.SceneManager.mouseButtonPress.length>0&&n.SceneManager.mouseButtonPress.forEach(function(n){n.index===t.button&&n.action()}),n.SceneManager.preventDefault&&t.preventDefault(),!0},t.inputPointerUpHandler=function(t){0===t.button&&null!=n.SceneManager.previousPosition&&(n.SceneManager.previousPosition=null,n.SceneManager.k_mousex=0,n.SceneManager.k_mousey=0);var i="p:"+t.button.toString();return n.SceneManager.keymap[i]=!1,null!=n.SceneManager.mouseButtonUp&&n.SceneManager.mouseButtonUp.length>0&&n.SceneManager.mouseButtonUp.forEach(function(n){n(t.button)}),n.SceneManager.preventDefault&&t.preventDefault(),!0},t.inputPointerMoveHandler=function(t){var u,f,r,i;return n.SceneManager.virtualJoystick===!1&&null!=n.SceneManager.previousPosition&&(n.SceneManager.clientx=t.clientX,n.SceneManager.clienty=t.clientY,u=t.clientX-n.SceneManager.previousPosition.x,f=t.clientY-n.SceneManager.previousPosition.y,n.SceneManager.previousPosition={x:t.clientX,y:t.clientY},r=u*(n.UserInputOptions.PointerAngularSensibility/10),i=f*(n.UserInputOptions.PointerAngularSensibility/10),0!=r&&(n.SceneManager.k_mousex=r),0!=i&&(n.SceneManager.k_mousey=n.SceneManager.rightHanded?-i:i)),n.SceneManager.preventDefault&&t.preventDefault(),!0},t.inputVirtualJoysticks=function(){var t,r,u,i,f,e;null!=n.SceneManager.leftJoystick&&(t=n.SceneManager.leftJoystick.deltaPosition,n.SceneManager.leftJoystick.pressed||(t=t.scale(.9)),r=t.x,u=t.y,t.x=Math.abs(r)>n.UserInputOptions.JoystickDeadStickValue?0+r:0,t.y=Math.abs(u)>n.UserInputOptions.JoystickDeadStickValue?0+u:0,n.SceneManager.j_horizontal=t.x,n.SceneManager.j_vertical=t.y);null!=n.SceneManager.rightJoystick&&(i=n.SceneManager.rightJoystick.deltaPosition,n.SceneManager.rightJoystick.pressed||(i=i.scale(.9)),f=i.x,e=i.y,i.x=Math.abs(f)>n.UserInputOptions.JoystickDeadStickValue?0+f:0,i.y=Math.abs(e)>n.UserInputOptions.JoystickDeadStickValue?0+e:0,n.SceneManager.j_mousex=i.x,n.SceneManager.j_mousey=i.y)},t.inputOneButtonDownHandler=function(t){if(null!=n.SceneManager.gamepad1){var i="b1:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad1ButtonDown&&n.SceneManager.gamepad1ButtonDown.length>0&&n.SceneManager.gamepad1ButtonDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad1ButtonPress&&n.SceneManager.gamepad1ButtonPress.length>0&&n.SceneManager.gamepad1ButtonPress.forEach(function(n){n.index===t&&n.action()})}},t.inputOneButtonUpHandler=function(t){if(null!=n.SceneManager.gamepad1){var i="b1:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad1ButtonUp&&n.SceneManager.gamepad1ButtonUp.length>0&&n.SceneManager.gamepad1ButtonUp.forEach(function(n){n(t)})}},t.inputOneXboxDPadDownHandler=function(t){if(null!=n.SceneManager.gamepad1){var i="d1:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad1DpadDown&&n.SceneManager.gamepad1DpadDown.length>0&&n.SceneManager.gamepad1DpadDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad1DpadPress&&n.SceneManager.gamepad1DpadPress.length>0&&n.SceneManager.gamepad1DpadPress.forEach(function(n){n.index===t&&n.action()})}},t.inputOneXboxDPadUpHandler=function(t){if(null!=n.SceneManager.gamepad1){var i="d1:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad1DpadUp&&n.SceneManager.gamepad1DpadUp.length>0&&n.SceneManager.gamepad1DpadUp.forEach(function(n){n(t)})}},t.inputOneXboxLeftTriggerHandler=function(t){null!=n.SceneManager.gamepad1&&(n.SceneManager.keymap["t1:0"]=t,null!=n.SceneManager.gamepad1LeftTrigger&&n.SceneManager.gamepad1LeftTrigger.length>0&&n.SceneManager.gamepad1LeftTrigger.forEach(function(n){n(t)}))},t.inputOneXboxRightTriggerHandler=function(t){null!=n.SceneManager.gamepad1&&(n.SceneManager.keymap["t1:1"]=t,null!=n.SceneManager.gamepad1RightTrigger&&n.SceneManager.gamepad1RightTrigger.length>0&&n.SceneManager.gamepad1RightTrigger.forEach(function(n){n(t)}))},t.inputOneLeftStickHandler=function(t){if(null!=n.SceneManager.gamepad1){var i=t,r=i.x*n.UserInputOptions.GamepadLStickSensibility,u=i.y*n.UserInputOptions.GamepadLStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_horizontal1=n.UserInputOptions.GamepadLStickXInverted?-i.x:i.x;n.SceneManager.g_vertical1=n.UserInputOptions.GamepadLStickYInverted?i.y:-i.y}},t.inputOneRightStickHandler=function(t){if(null!=n.SceneManager.gamepad1){var i=t,r=i.x*n.UserInputOptions.GamepadRStickSensibility,u=i.y*n.UserInputOptions.GamepadRStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_mousex1=n.UserInputOptions.GamepadRStickXInverted?-i.x:i.x;n.SceneManager.g_mousey1=n.UserInputOptions.GamepadRStickYInverted?-i.y:i.y}},t.inputTwoButtonDownHandler=function(t){if(null!=n.SceneManager.gamepad2){var i="b2:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad2ButtonDown&&n.SceneManager.gamepad2ButtonDown.length>0&&n.SceneManager.gamepad2ButtonDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad2ButtonPress&&n.SceneManager.gamepad2ButtonPress.length>0&&n.SceneManager.gamepad2ButtonPress.forEach(function(n){n.index===t&&n.action()})}},t.inputTwoButtonUpHandler=function(t){if(null!=n.SceneManager.gamepad2){var i="b2:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad2ButtonUp&&n.SceneManager.gamepad2ButtonUp.length>0&&n.SceneManager.gamepad2ButtonUp.forEach(function(n){n(t)})}},t.inputTwoXboxDPadDownHandler=function(t){if(null!=n.SceneManager.gamepad2){var i="d2:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad2DpadDown&&n.SceneManager.gamepad2DpadDown.length>0&&n.SceneManager.gamepad2DpadDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad2DpadPress&&n.SceneManager.gamepad2DpadPress.length>0&&n.SceneManager.gamepad2DpadPress.forEach(function(n){n.index===t&&n.action()})}},t.inputTwoXboxDPadUpHandler=function(t){if(null!=n.SceneManager.gamepad2){var i="d2:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad2DpadUp&&n.SceneManager.gamepad2DpadUp.length>0&&n.SceneManager.gamepad2DpadUp.forEach(function(n){n(t)})}},t.inputTwoXboxLeftTriggerHandler=function(t){null!=n.SceneManager.gamepad2&&(n.SceneManager.keymap["t2:0"]=t,null!=n.SceneManager.gamepad2LeftTrigger&&n.SceneManager.gamepad2LeftTrigger.length>0&&n.SceneManager.gamepad2LeftTrigger.forEach(function(n){n(t)}))},t.inputTwoXboxRightTriggerHandler=function(t){null!=n.SceneManager.gamepad2&&(n.SceneManager.keymap["t2:1"]=t,null!=n.SceneManager.gamepad2RightTrigger&&n.SceneManager.gamepad2RightTrigger.length>0&&n.SceneManager.gamepad2RightTrigger.forEach(function(n){n(t)}))},t.inputTwoLeftStickHandler=function(t){if(null!=n.SceneManager.gamepad2){var i=t,r=i.x*n.UserInputOptions.GamepadLStickSensibility,u=i.y*n.UserInputOptions.GamepadLStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_horizontal2=n.UserInputOptions.GamepadLStickXInverted?-i.x:i.x;n.SceneManager.g_vertical2=n.UserInputOptions.GamepadLStickYInverted?i.y:-i.y}},t.inputTwoRightStickHandler=function(t){if(null!=n.SceneManager.gamepad2){var i=t,r=i.x*n.UserInputOptions.GamepadRStickSensibility,u=i.y*n.UserInputOptions.GamepadRStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_mousex2=n.UserInputOptions.GamepadRStickXInverted?-i.x:i.x;n.SceneManager.g_mousey2=n.UserInputOptions.GamepadRStickYInverted?-i.y:i.y}},t.inputThreeButtonDownHandler=function(t){if(null!=n.SceneManager.gamepad3){var i="b3:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad3ButtonDown&&n.SceneManager.gamepad3ButtonDown.length>0&&n.SceneManager.gamepad3ButtonDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad3ButtonPress&&n.SceneManager.gamepad3ButtonPress.length>0&&n.SceneManager.gamepad3ButtonPress.forEach(function(n){n.index===t&&n.action()})}},t.inputThreeButtonUpHandler=function(t){if(null!=n.SceneManager.gamepad3){var i="b3:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad3ButtonUp&&n.SceneManager.gamepad3ButtonUp.length>0&&n.SceneManager.gamepad3ButtonUp.forEach(function(n){n(t)})}},t.inputThreeXboxDPadDownHandler=function(t){if(null!=n.SceneManager.gamepad3){var i="d3:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad3DpadDown&&n.SceneManager.gamepad3DpadDown.length>0&&n.SceneManager.gamepad3DpadDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad3DpadPress&&n.SceneManager.gamepad3DpadPress.length>0&&n.SceneManager.gamepad3DpadPress.forEach(function(n){n.index===t&&n.action()})}},t.inputThreeXboxDPadUpHandler=function(t){if(null!=n.SceneManager.gamepad3){var i="d3:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad3DpadUp&&n.SceneManager.gamepad3DpadUp.length>0&&n.SceneManager.gamepad3DpadUp.forEach(function(n){n(t)})}},t.inputThreeXboxLeftTriggerHandler=function(t){null!=n.SceneManager.gamepad3&&(n.SceneManager.keymap["t3:0"]=t,null!=n.SceneManager.gamepad3LeftTrigger&&n.SceneManager.gamepad3LeftTrigger.length>0&&n.SceneManager.gamepad3LeftTrigger.forEach(function(n){n(t)}))},t.inputThreeXboxRightTriggerHandler=function(t){null!=n.SceneManager.gamepad3&&(n.SceneManager.keymap["t3:1"]=t,null!=n.SceneManager.gamepad3RightTrigger&&n.SceneManager.gamepad3RightTrigger.length>0&&n.SceneManager.gamepad3RightTrigger.forEach(function(n){n(t)}))},t.inputThreeLeftStickHandler=function(t){if(null!=n.SceneManager.gamepad3){var i=t,r=i.x*n.UserInputOptions.GamepadLStickSensibility,u=i.y*n.UserInputOptions.GamepadLStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_horizontal3=n.UserInputOptions.GamepadLStickXInverted?-i.x:i.x;n.SceneManager.g_vertical3=n.UserInputOptions.GamepadLStickYInverted?i.y:-i.y}},t.inputThreeRightStickHandler=function(t){if(null!=n.SceneManager.gamepad3){var i=t,r=i.x*n.UserInputOptions.GamepadRStickSensibility,u=i.y*n.UserInputOptions.GamepadRStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_mousex3=n.UserInputOptions.GamepadRStickXInverted?-i.x:i.x;n.SceneManager.g_mousey3=n.UserInputOptions.GamepadRStickYInverted?-i.y:i.y}},t.inputFourButtonDownHandler=function(t){if(null!=n.SceneManager.gamepad4){var i="b4:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad4ButtonDown&&n.SceneManager.gamepad4ButtonDown.length>0&&n.SceneManager.gamepad4ButtonDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad4ButtonPress&&n.SceneManager.gamepad4ButtonPress.length>0&&n.SceneManager.gamepad4ButtonPress.forEach(function(n){n.index===t&&n.action()})}},t.inputFourButtonUpHandler=function(t){if(null!=n.SceneManager.gamepad4){var i="b4:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad4ButtonUp&&n.SceneManager.gamepad4ButtonUp.length>0&&n.SceneManager.gamepad4ButtonUp.forEach(function(n){n(t)})}},t.inputFourXboxDPadDownHandler=function(t){if(null!=n.SceneManager.gamepad4){var i="d4:"+t.toString(),r=!1;null!=n.SceneManager.keymap[i]&&(r=n.SceneManager.keymap[i]);n.SceneManager.keymap[i]=!0;null!=n.SceneManager.gamepad4DpadDown&&n.SceneManager.gamepad4DpadDown.length>0&&n.SceneManager.gamepad4DpadDown.forEach(function(n){n(t)});r||null!=n.SceneManager.gamepad4DpadPress&&n.SceneManager.gamepad4DpadPress.length>0&&n.SceneManager.gamepad4DpadPress.forEach(function(n){n.index===t&&n.action()})}},t.inputFourXboxDPadUpHandler=function(t){if(null!=n.SceneManager.gamepad4){var i="d4:"+t.toString();n.SceneManager.keymap[i]=!1;null!=n.SceneManager.gamepad4DpadUp&&n.SceneManager.gamepad4DpadUp.length>0&&n.SceneManager.gamepad4DpadUp.forEach(function(n){n(t)})}},t.inputFourXboxLeftTriggerHandler=function(t){null!=n.SceneManager.gamepad4&&(n.SceneManager.keymap["t4:0"]=t,null!=n.SceneManager.gamepad4LeftTrigger&&n.SceneManager.gamepad4LeftTrigger.length>0&&n.SceneManager.gamepad4LeftTrigger.forEach(function(n){n(t)}))},t.inputFourXboxRightTriggerHandler=function(t){null!=n.SceneManager.gamepad4&&(n.SceneManager.keymap["t4:1"]=t,null!=n.SceneManager.gamepad4RightTrigger&&n.SceneManager.gamepad4RightTrigger.length>0&&n.SceneManager.gamepad4RightTrigger.forEach(function(n){n(t)}))},t.inputFourLeftStickHandler=function(t){if(null!=n.SceneManager.gamepad4){var i=t,r=i.x*n.UserInputOptions.GamepadLStickSensibility,u=i.y*n.UserInputOptions.GamepadLStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_horizontal4=n.UserInputOptions.GamepadLStickXInverted?-i.x:i.x;n.SceneManager.g_vertical4=n.UserInputOptions.GamepadLStickYInverted?i.y:-i.y}},t.inputFourRightStickHandler=function(t){if(null!=n.SceneManager.gamepad4){var i=t,r=i.x*n.UserInputOptions.GamepadRStickSensibility,u=i.y*n.UserInputOptions.GamepadRStickSensibility;i.x=Math.abs(r)>n.UserInputOptions.GamepadDeadStickValue?0+r:0;i.y=Math.abs(u)>n.UserInputOptions.GamepadDeadStickValue?0+u:0;n.SceneManager.g_mousex4=n.UserInputOptions.GamepadRStickXInverted?-i.x:i.x;n.SceneManager.g_mousey4=n.UserInputOptions.GamepadRStickYInverted?-i.y:i.y}},t.inputManagerGamepadConnected=function(t,i){var r,o,u,s,f,h,e,c;null==n.SceneManager.gamepad1&&0===t.index&&((n.SceneManager.gamepad1=t,n.Tools.Log("Gamepad One Connected: "+n.SceneManager.gamepad1.id),n.SceneManager.gamepad1.id.search("Xbox 360")!==-1||n.SceneManager.gamepad1.id.search("Xbox One")!==-1||n.SceneManager.gamepad1.id.search("xinput")!==-1)?(n.SceneManager.gamepad1Type=n.GamepadType.Xbox360,r=n.SceneManager.gamepad1,r.onbuttonup(n.SceneManager.inputOneButtonUpHandler),r.onbuttondown(n.SceneManager.inputOneButtonDownHandler),r.onleftstickchanged(n.SceneManager.inputOneLeftStickHandler),r.onrightstickchanged(n.SceneManager.inputOneRightStickHandler),r.ondpadup(n.SceneManager.inputOneXboxDPadUpHandler),r.ondpaddown(n.SceneManager.inputOneXboxDPadDownHandler),r.onlefttriggerchanged(n.SceneManager.inputOneXboxLeftTriggerHandler),r.onrighttriggerchanged(n.SceneManager.inputOneXboxRightTriggerHandler)):(n.SceneManager.gamepad1Type=n.GamepadType.Generic,o=n.SceneManager.gamepad1,o.onbuttonup(n.SceneManager.inputOneButtonUpHandler),o.onbuttondown(n.SceneManager.inputOneButtonDownHandler),o.onleftstickchanged(n.SceneManager.inputOneLeftStickHandler),o.onrightstickchanged(n.SceneManager.inputOneRightStickHandler)));null==n.SceneManager.gamepad2&&1===t.index&&((n.SceneManager.gamepad2=t,n.Tools.Log("Gamepad Two Connected: "+n.SceneManager.gamepad2.id),n.SceneManager.gamepad2.id.search("Xbox 360")!==-1||n.SceneManager.gamepad2.id.search("Xbox One")!==-1||n.SceneManager.gamepad2.id.search("xinput")!==-1)?(n.SceneManager.gamepad2Type=n.GamepadType.Xbox360,u=n.SceneManager.gamepad2,u.onbuttonup(n.SceneManager.inputTwoButtonUpHandler),u.onbuttondown(n.SceneManager.inputTwoButtonDownHandler),u.onleftstickchanged(n.SceneManager.inputTwoLeftStickHandler),u.onrightstickchanged(n.SceneManager.inputTwoRightStickHandler),u.ondpadup(n.SceneManager.inputTwoXboxDPadUpHandler),u.ondpaddown(n.SceneManager.inputTwoXboxDPadDownHandler),u.onlefttriggerchanged(n.SceneManager.inputTwoXboxLeftTriggerHandler),u.onrighttriggerchanged(n.SceneManager.inputTwoXboxRightTriggerHandler)):(n.SceneManager.gamepad2Type=n.GamepadType.Generic,s=n.SceneManager.gamepad2,s.onbuttonup(n.SceneManager.inputTwoButtonUpHandler),s.onbuttondown(n.SceneManager.inputTwoButtonDownHandler),s.onleftstickchanged(n.SceneManager.inputTwoLeftStickHandler),s.onrightstickchanged(n.SceneManager.inputTwoRightStickHandler)));null==n.SceneManager.gamepad3&&2===t.index&&((n.SceneManager.gamepad3=t,n.Tools.Log("Gamepad Three Connected: "+n.SceneManager.gamepad3.id),n.SceneManager.gamepad3.id.search("Xbox 360")!==-1||n.SceneManager.gamepad3.id.search("Xbox One")!==-1||n.SceneManager.gamepad3.id.search("xinput")!==-1)?(n.SceneManager.gamepad3Type=n.GamepadType.Xbox360,f=n.SceneManager.gamepad3,f.onbuttonup(n.SceneManager.inputThreeButtonUpHandler),f.onbuttondown(n.SceneManager.inputThreeButtonDownHandler),f.onleftstickchanged(n.SceneManager.inputThreeLeftStickHandler),f.onrightstickchanged(n.SceneManager.inputThreeRightStickHandler),f.ondpadup(n.SceneManager.inputThreeXboxDPadUpHandler),f.ondpaddown(n.SceneManager.inputThreeXboxDPadDownHandler),f.onlefttriggerchanged(n.SceneManager.inputThreeXboxLeftTriggerHandler),f.onrighttriggerchanged(n.SceneManager.inputThreeXboxRightTriggerHandler)):(n.SceneManager.gamepad3Type=n.GamepadType.Generic,h=n.SceneManager.gamepad3,h.onbuttonup(n.SceneManager.inputThreeButtonUpHandler),h.onbuttondown(n.SceneManager.inputThreeButtonDownHandler),h.onleftstickchanged(n.SceneManager.inputThreeLeftStickHandler),h.onrightstickchanged(n.SceneManager.inputThreeRightStickHandler)));null==n.SceneManager.gamepad4&&3===t.index&&((n.SceneManager.gamepad4=t,n.Tools.Log("Gamepad Four Connected: "+n.SceneManager.gamepad4.id),n.SceneManager.gamepad4.id.search("Xbox 360")!==-1||n.SceneManager.gamepad4.id.search("Xbox One")!==-1||n.SceneManager.gamepad4.id.search("xinput")!==-1)?(n.SceneManager.gamepad4Type=n.GamepadType.Xbox360,e=n.SceneManager.gamepad4,e.onbuttonup(n.SceneManager.inputFourButtonUpHandler),e.onbuttondown(n.SceneManager.inputFourButtonDownHandler),e.onleftstickchanged(n.SceneManager.inputFourLeftStickHandler),e.onrightstickchanged(n.SceneManager.inputFourRightStickHandler),e.ondpadup(n.SceneManager.inputFourXboxDPadUpHandler),e.ondpaddown(n.SceneManager.inputFourXboxDPadDownHandler),e.onlefttriggerchanged(n.SceneManager.inputFourXboxLeftTriggerHandler),e.onrighttriggerchanged(n.SceneManager.inputFourXboxRightTriggerHandler)):(n.SceneManager.gamepad4Type=n.GamepadType.Generic,c=n.SceneManager.gamepad4,c.onbuttonup(n.SceneManager.inputFourButtonUpHandler),c.onbuttondown(n.SceneManager.inputFourButtonDownHandler),c.onleftstickchanged(n.SceneManager.inputFourLeftStickHandler),c.onrightstickchanged(n.SceneManager.inputFourRightStickHandler)));null!=n.SceneManager.GamepadConnected&&n.SceneManager.GamepadConnected(t,i)},t.inputManagerGamepadDisconnected=function(t,i){null!=n.SceneManager.GamepadDisconnected&&n.SceneManager.GamepadDisconnected(t,i)},t.inputManagerLeftControllerMainButton=function(){},t.inputManagerLeftControllerPadState=function(){},t.inputManagerLeftControllerPadValues=function(){},t.inputManagerLeftControllerAuxButton=function(){},t.inputManagerLeftControllerTriggered=function(){},t.inputManagerRightControllerMainButton=function(){},t.inputManagerRightControllerPadState=function(){},t.inputManagerRightControllerPadValues=function(){},t.inputManagerRightControllerAuxButton=function(){},t.inputManagerRightControllerTriggered=function(){},t.inputManagerControllerConnected=function(){},t.updateUserInput=function(){n.SceneManager.inputVirtualJoysticks();n.SceneManager.x_horizontal=0;n.SceneManager.x_vertical=0;n.SceneManager.x_mousex=0;n.SceneManager.x_mousey=0;0!==n.SceneManager.j_horizontal?n.SceneManager.x_horizontal=n.SceneManager.j_horizontal:0!==n.SceneManager.k_horizontal?n.SceneManager.x_horizontal=n.SceneManager.k_horizontal:0!==n.SceneManager.g_horizontal1&&(n.SceneManager.x_horizontal=n.SceneManager.g_horizontal1);0!==n.SceneManager.j_vertical?n.SceneManager.x_vertical=n.SceneManager.j_vertical:0!==n.SceneManager.k_vertical?n.SceneManager.x_vertical=n.SceneManager.k_vertical:0!==n.SceneManager.g_vertical1&&(n.SceneManager.x_vertical=n.SceneManager.g_vertical1);0!==n.SceneManager.j_mousex?n.SceneManager.x_mousex=n.SceneManager.j_mousex:0!==n.SceneManager.k_mousex?n.SceneManager.x_mousex=n.SceneManager.k_mousex:0!==n.SceneManager.g_mousex1&&(n.SceneManager.x_mousex=n.SceneManager.g_mousex1);0!==n.SceneManager.j_mousey?n.SceneManager.x_mousey=n.SceneManager.j_mousey:0!==n.SceneManager.k_mousey?n.SceneManager.x_mousey=n.SceneManager.k_mousey:0!==n.SceneManager.g_mousey1&&(n.SceneManager.x_mousey=n.SceneManager.g_mousey1);n.SceneManager.horizontal=n.SceneManager.x_horizontal;n.SceneManager.vertical=n.SceneManager.x_vertical;n.SceneManager.mousex=n.SceneManager.x_mousex;n.SceneManager.mousey=n.SceneManager.x_mousey;n.SceneManager.wheel=n.SceneManager.x_wheel;n.SceneManager.horizontal2=n.SceneManager.g_horizontal2;n.SceneManager.vertical2=n.SceneManager.g_vertical2;n.SceneManager.mousex2=n.SceneManager.g_mousex2;n.SceneManager.mousey2=n.SceneManager.g_mousey2;n.SceneManager.horizontal3=n.SceneManager.g_horizontal3;n.SceneManager.vertical3=n.SceneManager.g_vertical3;n.SceneManager.mousex3=n.SceneManager.g_mousex3;n.SceneManager.mousey3=n.SceneManager.g_mousey3;n.SceneManager.horizontal4=n.SceneManager.g_horizontal4;n.SceneManager.vertical4=n.SceneManager.g_vertical4;n.SceneManager.mousex4=n.SceneManager.g_mousex4;n.SceneManager.mousey4=n.SceneManager.g_mousey4;n.SceneManager.x_mousey=0},t.parseSceneCameras=function(t,i,r){null!=t&&t.length>0&&t.forEach(function(t){if(null!=t.metadata&&t.metadata.api&&t.metadata.parsed===!1){t.metadata.parsed=!0;t.metadata.clone=function(){return n.SceneManager.CloneMetadata(t.metadata)};n.SceneManager.setupCameraRigOptions(t,i);var u=t.metadata;null!=u.components&&u.components.length>0&&u.components.forEach(function(u){if(null!=u.klass&&""!==u.klass&&"BABYLON.SceneComponent"!==u.klass&&"BABYLON.OrthoController"!==u.klass){var f=n.Utilities.InstantiateClass(u.klass);null!=f&&(u.instance=new f(t,i,u.update,u.properties),null!=u.instance&&null!=r&&r.push(u))}})}})},t.parseSceneLights=function(t,i,r){null!=t&&t.length>0&&t.forEach(function(t){if(null!=t.metadata&&t.metadata.api&&t.metadata.parsed===!1){t.metadata.parsed=!0;t.metadata.clone=function(){return n.SceneManager.CloneMetadata(t.metadata)};var u=t.metadata;null!=u.components&&u.components.length>0&&u.components.forEach(function(u){if(null!=u.klass&&""!==u.klass&&"BABYLON.SceneComponent"!==u.klass&&"BABYLON.OrthoController"!==u.klass){var f=n.Utilities.InstantiateClass(u.klass);null!=f&&(u.instance=new f(t,i,u.update,u.properties),null!=u.instance&&null!=r&&r.push(u))}})}})},t.parseSceneMeshes=function(t,i,r){null!=t&&t.length>0&&(t.forEach(function(t){var u,f,e,o;if(null!=t.metadata&&t.metadata.api&&t.metadata.parsed===!1)if(t.metadata.parsed=!0,t.metadata.clone=function(){return n.SceneManager.CloneMetadata(t.metadata)},n.SceneManager.setupSharedSkeleton(t,i),t.metadata.prefab===!0)t.setEnabled(!1),n.SceneManager.prefabs[t.name]=t;else if(n.SceneManager.setupLodGroups(t,i,!1),"SceneNavigationMesh"===t.name&&null!=i.metadata.properties.hasNavigationMesh&&i.metadata.properties.hasNavigationMesh===!0&&(n.SceneManager.GetInstance().hasNavigationMesh()===!1?n.SceneManager.GetInstance().buildNavigationMesh(t):n.Tools.Warn("Scene navigation mesh already exists. Ignoring navigation zone building for mesh: "+t.name)),u=t.metadata,(null!=u.components&&u.components.length>0&&u.components.forEach(function(u){if(null!=u.klass&&""!==u.klass&&"BABYLON.SceneComponent"!==u.klass&&"BABYLON.OrthoController"!==u.klass){var f=n.Utilities.InstantiateClass(u.klass);null!=f&&(u.instance=new f(t,i,u.update,u.properties),null!=u.instance&&null!=r&&r.push(u))}}),n.SceneManager.setupSocketMeshes(t,i),null!=t.metadata&&t.metadata.properties&&null!=t.metadata.properties)&&(t.metadata.properties.defaultEllipsoid&&null!=t.metadata.properties.defaultEllipsoid&&t.metadata.properties.defaultEllipsoid.length>=3&&(f=t.metadata.properties.defaultEllipsoid,t.ellipsoid=new n.Vector3(f[0],f[1],f[2])),t.metadata.properties.ellipsoidOffset&&null!=t.metadata.properties.ellipsoidOffset&&t.metadata.properties.ellipsoidOffset.length>=3&&(e=t.metadata.properties.ellipsoidOffset,t.ellipsoidOffset=new n.Vector3(e[0],e[1],e[2])),t.metadata.properties.hasOwnProperty("freezeWorldMatrix")&&t.metadata.properties.freezeWorldMatrix===!0&&t.freezeWorldMatrix(),t.metadata.properties.hasOwnProperty("convertToUnIndexed")&&t.metadata.properties.convertToUnIndexed===!0&&t.convertToUnIndexedMesh(),t.metadata.properties.hasOwnProperty("convertToFlatShaded")&&t.metadata.properties.convertToFlatShaded===!0&&t.convertToFlatShadedMesh(),t.metadata.properties.hasOwnProperty("pickableWithRay")&&(t.isPickable=t.metadata.properties.pickableWithRay)),o=n.SceneManager.setupTerrainMeshes(t,i),o===!1&&null!=t.metadata.properties&&null!=t.metadata.properties.physicsTag){var h=(t.metadata.properties.physicsTag,t.metadata.properties.physicsMass),c=t.metadata.properties.physicsDetach,s=t.metadata.properties.physicsFriction,l=t.metadata.properties.physicsRestitution,a=t.metadata.properties.physicsImpostor,v=t.metadata.properties.physicsRotation,y=t.metadata.properties.physicsCollisions,p=t.metadata.properties.physicsCollisionGroup,w=t.metadata.properties.physicsCollisionMask,b=t.metadata.properties.physicsEnginePlugin;c===!0&&null!=t.parent&&(n.Utilities.ResetPhysicsPosition(t.position,t.parent),t.parent=null);t.physicsImpostor=new n.PhysicsImpostor(t,a,{mass:h,friction:s,restitution:l},i);n.SceneManager.setupPhysicsImpostor(t,b,s,y,v,p,w)}}),n.SceneManager.postParseSceneMeshes(t,i))},t.postParseSceneMeshes=function(t){var i,u,r,e,f;if(null!=t&&t.length>0&&(i={},t.forEach(function(t){if(null!=t.metadata&&t.metadata.api&&n.SceneManager.staticVertexLimit===!1&&t.metadata.layerIndex===n.SceneManager.StaticIndex&&t.name.indexOf("_StaticMesh_")>=0){t.metadata.layerIndex=-99;var u=t.material.id,r=null;i.hasOwnProperty(u)?r=i[u]:(r=[],i[u]=r);r.push(t)}}),n.SceneManager.staticVertexLimit===!1))for(u in i)i.hasOwnProperty(u)&&(r=i[u],null!=r&&r.length>1&&(e=r[0].parent,f=n.Mesh.MergeMeshes(r,!0,!0),null!=f&&(f.parent=e)))},t.setupLodGroups=function(t){var i;if(null!=t&&null!=t.metadata&&t.metadata.properties&&null!=t.metadata.properties&&t.metadata.properties.lodGroupInfo&&null!=t.metadata.properties.lodGroupInfo){var u=0,e=t.metadata.properties.lodGroupInfo,f=e.lodDetails,o=e.startCulling,r=t.getChildMeshes(!1);(null==r?r=[t]:r.unshift(t),null!=f&&f.length>0)&&(i=null,f.forEach(function(f){var o=f.lodRenderers,h=f.startRange;if(null!=o&&o.length>0){var c=o[0],s=c.name,e=n.SceneManager.FindMesh(s,r,n.SearchType.IndexOf);null!=e?(null==i&&(i=e,i.setEnabled(!1)),e!=i&&(e.parent=i,i.addLODLevel(h,e))):n.Tools.Warn("Babylon.js cannot locate lod renderer: '"+s+"' for: "+t.name+" at group index: "+u.toString())}else n.Tools.Warn("Babylon.js no level of detail renderers found for: "+t.name+" at group index: "+u.toString());u++}),null!=i&&(o>0&&i.addLODLevel(o,null),i.setEnabled(!0)));t.metadata.properties.lodGroupInfo=null}},t.setupTerrainMeshes=function(t,i){var c=!1,s,h,tt,o,it,rt;if(null!=t&&null!=t.metadata&&t.metadata.properties&&null!=t.metadata.properties&&t.metadata.properties.terrain===!0){c=!0;var r=0,ut=(t.metadata.properties.segments?t.metadata.properties.segments:1,t.metadata.properties.colliders?t.metadata.properties.colliders:1),l=null!=t.metadata.properties.physicsTag,a=(t.metadata.properties.physicsTag?t.metadata.properties.physicsTag:"",t.metadata.properties.physicsMass?t.metadata.properties.physicsMass:0),v=!!t.metadata.properties.physicsDetach&&t.metadata.properties.physicsDetach,f=t.metadata.properties.physicsFriction?t.metadata.properties.physicsFriction:0,y=t.metadata.properties.physicsRestitution?t.metadata.properties.physicsRestitution:0,p=t.metadata.properties.physicsImpostor?t.metadata.properties.physicsImpostor:0,w=t.metadata.properties.physicsRotation?t.metadata.properties.physicsRotation:0,b=!!t.metadata.properties.physicsCollisions&&t.metadata.properties.physicsCollisions,k=t.metadata.properties.physicsCollisionGroup?t.metadata.properties.physicsCollisionGroup:0,d=t.metadata.properties.physicsCollisionMask?t.metadata.properties.physicsCollisionMask:0,g=t.metadata.properties.physicsEnginePlugin?t.metadata.properties.physicsEnginePlugin:0,nt=t.metadata.properties.terrainLodGroupInfo?t.metadata.properties.terrainLodGroupInfo:null,ft=!!t.metadata.properties.terrainCollision&&t.metadata.properties.terrainCollision,e=null!=nt?nt.lodDetails:null,u=null;if(null!=e&&e.length>0)for(r=0,r=0;r<e.length;r++)s=e[r],h=s.startingPercent,h<1&&(tt=s.startRange,null==u&&(u=[]),u.push(new n.SimplificationSettings(h,tt,!0)));o=t.getChildMeshes(!0);(null!=o&&o.length>0&&o.forEach(function(t){var r=t,e=r.name.indexOf(".Collider.")>=0;e===!1&&null!=u&&r.simplify(u,!0,n.SimplificationType.QUADRATIC);r.checkCollisions=ft;ut>1?e===!0&&l===!0&&(r.parent=null,v===!0&&null!=r.parent&&(n.Utilities.ResetPhysicsPosition(r.position,r.parent),r.parent=null),r.physicsImpostor=new n.PhysicsImpostor(r,p,{mass:a,friction:f,restitution:y},i),n.SceneManager.setupPhysicsImpostor(r,g,f,b,w,k,d)):l===!0&&(r.parent=null,v===!0&&null!=r.parent&&(n.Utilities.ResetPhysicsPosition(r.position,r.parent),r.parent=null),r.physicsImpostor=new n.PhysicsImpostor(r,p,{mass:a,friction:f,restitution:y},i),n.SceneManager.setupPhysicsImpostor(r,g,f,b,w,k,d))}),r=0,t.metadata.properties.treeInstances&&null!=t.metadata.properties.treeInstances&&t.metadata.properties.treeInstances.length>0)&&(it=t.metadata.properties.treeInstances,it.forEach(function(i){r++;var f=i.prefab,o=i.heightScale,u=i.position,s=i.rotation,e=i.widthScale,h=f+"_"+r.toString(),c=t,l=new n.Vector3(u[0],u[1],u[2]),a=new n.Vector3(0,s,0),v=new n.Vector3(e,o,e);n.SceneManager.GetInstance().onready(function(){n.SceneManager.GetInstance().instantiatePrefab(f,h,l,a,v,c)})}));(r=0,t.metadata.properties.detailPrototypes&&null!=t.metadata.properties.detailPrototypes&&t.metadata.properties.detailPrototypes.length>0)&&(rt=t.metadata.properties.detailPrototypes,rt.forEach(function(){}))}return c},t.setupSocketMeshes=function(t,i){if(null!=t&&null!=t.metadata.socketList&&t.metadata.socketList.length>0&&null!=t.skeleton&&null!=t.skeleton.bones&&t.skeleton.bones.length>0){var r=t.metadata.socketList;r.forEach(function(r){if(t.skeleton.bones.length>=r.boneIndex+1){var f=t.skeleton.bones[r.boneIndex],u=r.boneName+".Socket.";null!=t.parent&&(u+=t.parent.name+".");u+=t.name+"."+n.Tools.RandomId();n.SceneManager.showDebugSockets===!0?(r.socketMesh=n.Mesh.CreateBox(u,n.SceneManager.socketColliderSize,i),r.socketMesh.visibility=n.SceneManager.colliderVisibility):r.socketMesh=new n.Mesh(u,i);r.socketMesh.position=new n.Vector3(r.positionX,r.positionY,r.positionZ);r.socketMesh.rotation=new n.Vector3(r.rotationX,r.rotationY,r.rotationZ);r.socketMesh.checkCollisions=!1;r.socketMesh.attachToBone(f,t)}})}},t.setupSharedSkeleton=function(t,i){if(null!=t&&null!=t.metadata&&t.metadata.properties&&null!=t.metadata.properties&&t.metadata.properties.sharedSkeletonId&&""!==t.metadata.properties.sharedSkeletonId){var u=t.metadata.properties.sharedSkeletonId,r=i.getMeshByID(u);null!=r&&null!=r.skeleton?(t.metadata.animationClips=null,t.skeleton=r.skeleton):n.Tools.Warn("Failed to locate source skeleton: "+u)}},t.setupPhysicsImpostor=function(t,i,r,u,f,e,o){void 0===e&&(e=1);void 0===o&&(o=1);null!=t&&null!=t.physicsImpostor&&(t.physicsImpostor.executeNativeFunction(function(s,h){h?0===i&&(h.linearDamping=r,h.angularDamping=r,h.collisionResponse=u,h.collisionFilterGroup=e,h.collisionFilterMask=o,h.angularVelocity.x=0,h.angularVelocity.y=0,h.angularVelocity.z=0,h.velocity.x=0,h.velocity.y=0,h.velocity.z=0,1===f&&(h.fixedRotation=!0,h.updateMassProperties())):n.Tools.Warn("[Physics Native Function]: Null imposter body encountered for physcis mesh "+t.name+". Check physics mesh has no parent transform.")}),n.SceneManager.showPhysicsImposter===!0&&n.SceneManager.GetInstance().showDebugImposter(t))},t.setupCameraRigOptions=function(t,i){var e,it,s,rt,h,u,b,f,k,r,ft,et,d,gt;if(null!=t&&null!=t.metadata&&null!=t.metadata.properties){t.metadata.properties.mainCamera&&null==n.SceneManager.GetInstance()._playerOneCamera&&(t.viewport=new n.Viewport(0,0,1,1),n.SceneManager.GetInstance()._playerOneCamera=t,t.metadata.properties.hasOwnProperty("stereoscopicSideBySide")&&(n.SceneManager.stereoCameras=t.metadata.properties.stereoscopicSideBySide));var g=t.metadata.properties.followTarget,ni=t.metadata.properties.followRadius,ti=t.metadata.properties.followHeightOffset,ii=t.metadata.properties.followRotationOffset,ri=t.metadata.properties.followCameraAcceleration,ui=t.metadata.properties.followMaxCameraSpeed,nt=t.metadata.properties.followTarget,ot=t.metadata.properties.arcRotateAlpha,st=t.metadata.properties.arcRotateBeta,ht=t.metadata.properties.arcRotateRadius,fi=t.metadata.properties.arcRotateTarget,ei=t.metadata.properties.arcRotateLowerRadiusLimit,oi=t.metadata.properties.arcRotateUpperRadiusLimit,si=t.metadata.properties.arcRotateCollisionRadius,hi=t.metadata.properties.arcRotateWheelDeltaPercentage,ci=t.metadata.properties.webvrUniversalCamera,li=t.metadata.properties.webvrDisplayGazeIcon,ai=t.metadata.properties.webvrEnableInteractions,ct=t.metadata.properties.webvrEnableTeleportation,lt=t.metadata.properties.webvrDeviceOrientationCamera,at=t.metadata.properties.webvrFallbackFreeCamera,tt=t.metadata.properties.webvrControllerPrefabs,vt=t.metadata.properties.webvrInitialController,c=t.metadata.properties.webvrLeftControllerPrefab,l=t.metadata.properties.webvrRightControllerPrefab,yt=t.metadata.properties.webvrDisplayLaserBeam,vi=t.metadata.properties.webvrUseCustomButton,a=t.metadata.properties.webvrButtonElementID,pt=t.metadata.properties.webvrRayCastLength,wt=t.metadata.properties.webvrDefaultHeight,bt=t.metadata.properties.webvrPositionScale,v=t.metadata.properties.webvrFloorMeshesTags,y=null;if(t.metadata.properties.cameraType)if(e=t.metadata.properties.cameraType,"UniversalCamera"===e){if(t.metadata.properties.mainCamera&&t.metadata.properties.localMultiPlayerViewCamera){var o=t,p=o.name,kt=p+".2",w=o.clone(kt);w.name=kt;w.viewport=new n.Viewport(0,0,0,0);w.setEnabled(!1);n.SceneManager.GetInstance()._playerTwoCamera=w;it=p+".3";s=o.clone(it);s.name=it;s.viewport=new n.Viewport(0,0,0,0);s.setEnabled(!1);n.SceneManager.GetInstance()._playerThreeCamera=s;rt=p+".4";h=o.clone(rt);h.name=rt;h.viewport=new n.Viewport(0,0,0,0);h.setEnabled(!1);n.SceneManager.GetInstance()._playerFourCamera=h;o.name=p+".1";n.SceneManager.multiPlayerView=!0}}else"FollowCamera"===e?(u=t,null!=g&&""!==g&&(b=i.getMeshByID(g),null!=b&&(u.position=b.position.clone(),u.lockedTarget=b)),u.radius=ni,u.heightOffset=ti,u.rotationOffset=ii,u.cameraAcceleration=ri,u.maxCameraSpeed=ui):"ArcFollowCamera"===e?(f=t,null!=nt&&""!==nt&&(k=i.getMeshByID(nt),null!=k&&(f.position=k.position.clone(),f.lockedTarget=k)),f.alpha=ot,f.beta=st,f.radius=ht):"ArcRotateCamera"===e&&(r=t,r.alpha=ot,r.beta=st,r.radius=ht,r.target=n.Vector3.FromArray(fi),r.lowerRadiusLimit=ei,r.upperRadiusLimit=oi,r.collisionRadius=n.Vector3.FromArray(si),r.wheelDeltaPercentage=hi);if(t.mode===n.Camera.ORTHOGRAPHIC_CAMERA){var yi=t.metadata.properties.orthographicSize||5,dt="BABYLON.OrthoController",pi=null==i.metadata||null==i.metadata.properties||!i.metadata.properties.hasOwnProperty("resizeCameras")||i.metadata.properties.resizeCameras,ut=t.metadata;null==ut.components&&(ut.components=[]);ft=n.Utilities.InstantiateClass(dt);null!=ft&&(et={orthoSize:yi,resizeCameras:pi},d=new ft(t,i,!1,et),null!=d&&(gt={order:1e3,name:"EditorScriptComponent",klass:dt,update:!1,properties:et,instance:d,tag:{}},ut.components.push(gt),d.register()))}t.metadata.properties.mainCamera&&ci===!0&&n.SceneManager.GetInstance().onready(function(){var r=!1,u=null,f,e,t;vi===!0&&null!=a&&""!==a&&(f=document.getElementById(a),null!=f?(r=!0,u=f):n.Tools.Warn("Babylon.js failed to locate webvr button element id: "+a));e=null;null!=v&&""!==v||(v="Navigation");ct===!0&&(y=i.getMeshesByTags(v));e=ct===!0&&null!=y&&y.length>0?{createDeviceOrientationCamera:lt,createFallbackVRDeviceOrientationFreeCamera:at,laserToggle:yt,useCustomVRButton:r,customVRButton:u,rayLength:pt,defaultHeight:wt,positionScale:bt,floorMeshes:y}:{createDeviceOrientationCamera:lt,createFallbackVRDeviceOrientationFreeCamera:at,laserToggle:yt,useCustomVRButton:r,customVRButton:u,rayLength:pt,defaultHeight:wt,positionScale:bt};tt===!0&&(n.SceneManager.me._leftControllerPrefab=n.SceneManager.me.instantiatePrefab(c,c),null!=n.SceneManager.me._leftControllerPrefab&&n.SceneManager.me._leftControllerPrefab.setEnabled(!1),n.SceneManager.me._rightControllerPrefab=n.SceneManager.me.instantiatePrefab(l,l),null!=n.SceneManager.me._rightControllerPrefab&&n.SceneManager.me._rightControllerPrefab.setEnabled(!1),null==n.SceneManager.me._leftControllerPrefab&&null!=n.SceneManager.me._rightControllerPrefab?(n.SceneManager.me._leftControllerPrefab=n.SceneManager.me.instantiatePrefab(l,c),null!=n.SceneManager.me._leftControllerPrefab&&n.SceneManager.me._leftControllerPrefab.setEnabled(!1)):null==n.SceneManager.me._rightControllerPrefab&&null!=n.SceneManager.me._leftControllerPrefab&&(n.SceneManager.me._rightControllerPrefab=n.SceneManager.me.instantiatePrefab(c,l),null!=n.SceneManager.me._rightControllerPrefab&&n.SceneManager.me._rightControllerPrefab.setEnabled(!1)));n.SceneManager.me._defaultControllers=!0;t=i.createDefaultVRExperience(e);null!=t&&(t.displayGaze=li,ai===!0&&t.enableInteractions(),t.onControllerMeshLoadedObservable.add(function(t){"left"===t.hand?(n.SceneManager.me._leftControllerStick=t,n.SceneManager.me._leftControllerStick.onMainButtonStateChangedObservable.add(n.SceneManager.inputManagerLeftControllerMainButton),n.SceneManager.me._leftControllerStick.onPadStateChangedObservable.add(n.SceneManager.inputManagerLeftControllerPadState),n.SceneManager.me._leftControllerStick.onPadValuesChangedObservable.add(n.SceneManager.inputManagerLeftControllerPadValues),n.SceneManager.me._leftControllerStick.onSecondaryButtonStateChangedObservable.add(n.SceneManager.inputManagerLeftControllerAuxButton),n.SceneManager.me._leftControllerStick.onTriggerStateChangedObservable.add(n.SceneManager.inputManagerLeftControllerTriggered),tt===!0&&0===vt&&(null!=n.SceneManager.me._leftControllerPrefab?(n.SceneManager.me._leftControllerStick.mesh.setEnabled(!1),n.SceneManager.me._leftControllerStick.attachToMesh(n.SceneManager.me._leftControllerPrefab),n.SceneManager.me._leftControllerStick.mesh.setEnabled(!0),n.SceneManager.me._defaultControllers=!1):n.Tools.Warn("Babylon.js failed to instantiate left controller prefab. Using default controller."))):"right"===t.hand&&(n.SceneManager.me._rightControllerStick=t,n.SceneManager.me._rightControllerStick.onMainButtonStateChangedObservable.add(n.SceneManager.inputManagerRightControllerMainButton),n.SceneManager.me._rightControllerStick.onPadStateChangedObservable.add(n.SceneManager.inputManagerRightControllerPadState),n.SceneManager.me._rightControllerStick.onPadValuesChangedObservable.add(n.SceneManager.inputManagerRightControllerPadValues),n.SceneManager.me._rightControllerStick.onSecondaryButtonStateChangedObservable.add(n.SceneManager.inputManagerRightControllerAuxButton),n.SceneManager.me._rightControllerStick.onTriggerStateChangedObservable.add(n.SceneManager.inputManagerRightControllerTriggered),tt===!0&&0===vt&&(null!=n.SceneManager.me._rightControllerPrefab?(n.SceneManager.me._rightControllerStick.mesh.setEnabled(!1),n.SceneManager.me._rightControllerStick.attachToMesh(n.SceneManager.me._rightControllerPrefab),n.SceneManager.me._rightControllerStick.mesh.setEnabled(!0),n.SceneManager.me._defaultControllers=!1):n.Tools.Warn("Babylon.js failed to instantiate left controller prefab. Using default controller.")))}));n.SceneManager.GetInstance()._vrhelper=t})}},t.LocateOwnerSocketMesh=function(t,i,r){var f,u;if(void 0===r&&(r=n.SearchType.StartsWith),f=null,null!=i&&i.metadata&&null!=i.metadata&&i.metadata.socketList&&null!=i.metadata.socketList&&i.metadata.socketList.length>0)for(var s=i.metadata.socketList,o=null!=r?r:n.SearchType.StartsWith,e=0,e=0;e<s.length;e++)if(u=s[e],o===n.SearchType.StartsWith){if(n.Utilities.StartsWith(u.boneName,t)){f=u.socketMesh;break}}else if(o===n.SearchType.EndsWith){if(n.Utilities.EndsWith(u.boneName,t)){f=u.socketMesh;break}}else if(o===n.SearchType.IndexOf){if(u.boneName.indexOf(t)>=0){f=u.socketMesh;break}}else if(u.boneName===t){f=u.socketMesh;break}return f},t.LocateOwnerSocketMeshes=function(n){var t=null,i;return null!=n&&n.metadata&&null!=n.metadata&&n.metadata.socketList&&null!=n.metadata.socketList&&n.metadata.socketList.length>0&&(t=[],i=n.metadata.socketList,i.forEach(function(n){t.push(n.socketMesh)})),t},t.LocateOwnerAnimationTrack=function(t,i,r,u){var e,o,s,h,l,f,c;if(void 0===r&&(r=!0),void 0===u&&(u=null),e=null,null!=i&&i instanceof n.AbstractMesh&&(o=i,null!=o.skeleton&&null!=o.skeleton.bones&&o.skeleton.bones.length>0&&o.skeleton.bones[0]&&(s=o.skeleton.bones[0],null!=s.animations&&s.animations.length>t&&null!=s.animations[t]&&(e=s.animations[t]))),(null==e&&null!=i.animations&&i.animations.length>t&&null!=i.animations[t]&&(e=i.animations[t]),null==e&&i instanceof n.AbstractMesh)&&(h=i.getChildMeshes(r,u),null!=h&&h.length>0))for(l=0;l<h.length;l++){if(f=h[l],null!=f.skeleton&&null!=f.skeleton.bones&&f.skeleton.bones.length>0&&f.skeleton.bones[0]&&(c=f.skeleton.bones[0],null!=c.animations&&c.animations.length>t&&null!=c.animations[t])){e=c.animations[t];break}if(null==e&&null!=f.animations&&f.animations.length>0&&f.animations.length>t&&null!=f.animations[t]){e=f.animations[t];break}}return e},t.DestroyComponents=function(t,i){if(void 0===i&&(i=!0),null!=t&&null!=t.metadata&&t.metadata.api){var r=t.metadata;null!=r.components&&r.components.length>0&&r.components.forEach(function(t){null!=t.instance&&(n.SceneComponent.DestroyInstance(t.instance),t.instance=null)});null!=r.socketList&&r.socketList.length>0&&r.socketList.forEach(function(n){null!=n.socketMesh&&(n.socketMesh.dispose(),n.socketMesh=null)});i&&(null!=t.metadata.components&&(t.metadata.components=null),null!=t.metadata.properties&&(t.metadata.properties=null),null!=t.metadata.socketList&&(t.metadata.socketList=null),null!=t.metadata.animationClips&&(t.metadata.animationClips=null),null!=t.metadata.animationEvents&&(t.metadata.animationEvents=null),null!=t.metadata.collisionEvent&&(t.metadata.collisionEvent=null),t.metadata=null)}},t.DisposeOwner=function(t){if(t.name,t instanceof n.AbstractMesh){var i=t;null!=i.physicsImpostor&&(i.physicsImpostor.dispose(),i.physicsImpostor=null)}t.dispose()},t.SetAnimationLooping=function(n,t){if(null!=n&&null!=n.animations&&n.animations.length>0)for(var r=n.animations,i=0;i<r.length;i++)r[i].loopMode=t},t.SetSkeletonLooping=function(t,i){null!=t&&(null==t.animationPropertiesOverride&&(t.animationPropertiesOverride=new n.AnimationPropertiesOverride),t.animationPropertiesOverride.loopMode=i)},t.SetSkeletonBlending=function(t,i){null!=t&&(null==t.animationPropertiesOverride&&(t.animationPropertiesOverride=new n.AnimationPropertiesOverride),t.animationPropertiesOverride.enableBlending=i>0,t.animationPropertiesOverride.blendingSpeed=i)},t.SetSkeletonProperties=function(t,i,r){null!=t&&(null==t.animationPropertiesOverride&&(t.animationPropertiesOverride=new n.AnimationPropertiesOverride),t.animationPropertiesOverride.loopMode=i,t.animationPropertiesOverride.enableBlending=r>0,t.animationPropertiesOverride.blendingSpeed=r)},t.FindMesh=function(t,i,r){var f,e,o,u;if(void 0===r&&(r=n.SearchType.StartsWith),f=null,e=null!=r?r:n.SearchType.StartsWith,null!=i&&i.length>0)for(o=0;o<i.length;o++)if(u=i[o],e===n.SearchType.StartsWith){if(n.Utilities.StartsWith(u.name,t)){f=u;break}}else if(e===n.SearchType.EndsWith){if(n.Utilities.EndsWith(u.name,t)){f=u;break}}else if(e===n.SearchType.IndexOf){if(u.name.indexOf(t)>=0){f=u;break}}else if(u.name===t){f=u;break}return f},t.CloneValue=function(t,i){return t?t instanceof n.Mesh?null:t instanceof n.SubMesh?t.clone(i):t.clone?t.clone():t:null},t.CloneMetadata=function(t){var h=null,r,u,f,e,o,i,c,s;return null!=t&&(r={},n.SceneManager.DeepCopyProperties(t.properties,r),u={},n.SceneManager.DeepCopyProperties(t.navAgent,u),f={},n.SceneManager.DeepCopyProperties(t.meshLink,f),e={},n.SceneManager.DeepCopyProperties(t.meshObstacle,e),o=[],null!=t.socketList&&t.socketList.length>0&&t.socketList.forEach(function(t){var i={};n.SceneManager.DeepCopyProperties(t,i);o.push(i)}),i=[],null!=t.animationClips&&t.animationClips.length>0&&t.animationClips.forEach(function(t){var r={};n.SceneManager.DeepCopyProperties(t,r);i.push(r)}),c=[],null!=t.animationEvents&&t.animationEvents.length>0&&t.animationEvents.forEach(function(t){var i={};n.SceneManager.DeepCopyProperties(t,i);c.push(i)}),s=[],null!=t.components&&t.components.length>0&&t.components.forEach(function(t){var i={};n.SceneManager.DeepCopyProperties(t.properties,i);s.push({name:t.name,klass:t.klass,order:t.order,tag:t.tag,update:t.update,properties:i,instance:null})}),h={api:!0,type:t.type,parsed:!1,prefab:!1,state:{},objectName:t.objectName,objectId:n.Tools.RandomId(),tagName:t.tagName,layerIndex:t.prefab===!1?t.layerIndex:0,layerName:t.prefab===!1?t.layerName:"Default",areaIndex:t.areaIndex,shadowCastingMode:t.shadowCastingMode,navAgent:u,meshLink:f,meshObstacle:e,socketList:o,animationClips:i,animationEvents:i,collisionEvent:null,components:s,properties:r}),h},t.DeepCopyProperties=function(t,i,r,u){var f,e,s,o,h;for(f in t)if(("_"!==f[0]||u&&u.indexOf(f)!==-1)&&(!r||r.indexOf(f)===-1)&&(e=t[f],s=typeof e,"function"!==s))if("object"===s)if(e instanceof Array){if(i[f]=[],e.length>0)if("object"==typeof e[0])for(o=0;o<e.length;o++)h=n.SceneManager.CloneValue(e[o],i),i[f].indexOf(h)===-1&&i[f].push(h);else i[f]=e.slice(0)}else i[f]=n.SceneManager.CloneValue(e,i);else i[f]=e},t.SetWindowsLaunchMode=function(){n.SceneManager.IsWindows()&&"undefined"!=typeof Windows.UI.ViewManagement&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationView&&(Windows.UI.ViewManagement.ApplicationView.preferredLaunchWindowingMode=Windows.UI.ViewManagement.ApplicationViewWindowingMode.fullScreen)},t.QuitWindowsApplication=function(){n.SceneManager.IsWindows()&&window.close()},t.IsWebAssemblyPluginEnabled=function(){return!!window.isWebAssemblyPluginEnabled&&window.isWebAssemblyPluginEnabled()},t.LoadWebAssemblyModule=function(n,t){return fetch(n).then(function(n){return n.arrayBuffer()}).then(function(n){return window.WebAssembly.instantiate(n,t)}).then(function(n){return n.instance})},t.IsXboxLivePluginEnabled=function(){return!!window.isXboxLivePluginEnabled&&window.isXboxLivePluginEnabled()},t.IsXboxLiveUserSignedIn=function(t,i){if(void 0===t&&(t=null),void 0===i&&(i=n.PlayerNumber.One),n.SceneManager.IsXboxLivePluginEnabled()){var r=null!=t?n.SceneManager.GetXboxLiveSystemUser(t,i):n.SceneManager.GetXboxLiveUser(i);return null!=r&&1==r.isSignedIn}return!1},t.XboxLiveUserSignIn=function(t,i,r,u){void 0===t&&(t=n.PlayerNumber.One);n.SceneManager.IsXboxLivePluginEnabled()&&n.SceneManager.XboxLiveUserSilentSignIn(t,function(f){f.status===Microsoft.Xbox.Services.System.SignInStatus.userInteractionRequired?n.SceneManager.XboxLiveUserDialogSignIn(t,function(n){i&&i(n)},r,u):i&&i(f)},r,u)},t.XboxLiveUserSilentSignIn=function(t,i,r,u){return void 0===t&&(t=n.PlayerNumber.One),n.SceneManager.IsXboxLivePluginEnabled()?n.SceneManager.GetXboxLiveUser(t).signInSilentlyAsync(null).then(i,r,u):null},t.XboxLiveUserDialogSignIn=function(t,i,r,u){return void 0===t&&(t=n.PlayerNumber.One),n.SceneManager.IsXboxLivePluginEnabled()?n.SceneManager.GetXboxLiveUser(t).signInAsync(null).then(i,r,u):null},t.LoadXboxLiveUserProfile=function(t,i,r,u){return void 0===t&&(t=n.PlayerNumber.One),n.SceneManager.IsXboxLivePluginEnabled()?n.SceneManager.GetXboxLiveUserContext(t).profileService.getUserProfileAsync(n.SceneManager.GetXboxLiveUser(t).xboxUserId).then(i,r,u):null},t.GetXboxLiveUser=function(t){void 0===t&&(t=n.PlayerNumber.One);var i=null;if(n.SceneManager.IsXboxLivePluginEnabled())switch(t){case n.PlayerNumber.One:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserOne();break;case n.PlayerNumber.Two:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserTwo();break;case n.PlayerNumber.Three:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserThree();break;case n.PlayerNumber.Four:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveUserFour()}return i},t.GetXboxLiveSystemUser=function(t,i){void 0===i&&(i=n.PlayerNumber.One);var r=null;if(n.SceneManager.IsXboxLivePluginEnabled())switch(i){case n.PlayerNumber.One:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserOne(t);break;case n.PlayerNumber.Two:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserTwo(t);break;case n.PlayerNumber.Three:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserThree(t);break;case n.PlayerNumber.Four:r=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveSystemUserFour(t)}return r},t.GetXboxLiveUserContext=function(t){void 0===t&&(t=n.PlayerNumber.One);var i=null;if(n.SceneManager.IsXboxLivePluginEnabled())switch(t){case n.PlayerNumber.One:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextOne();break;case n.PlayerNumber.Two:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextTwo();break;case n.PlayerNumber.Three:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextThree();break;case n.PlayerNumber.Four:i=window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextFour()}return i},t.ResetXboxLiveUserContext=function(t){if(void 0===t&&(t=n.PlayerNumber.One),n.SceneManager.IsXboxLivePluginEnabled()&&n.SceneManager.IsXboxLivePluginEnabled())switch(t){case n.PlayerNumber.One:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextOne();break;case n.PlayerNumber.Two:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextTwo();break;case n.PlayerNumber.Three:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextThree();break;case n.PlayerNumber.Four:window.BabylonToolkit.XboxLive.Plugin.resetXboxLiveUserContextFour()}},t.GetXboxLiveContextProperty=function(t){return n.SceneManager.IsXboxLivePluginEnabled()?window.BabylonToolkit.XboxLive.Plugin.getXboxLiveContextProperty(t):null},t.SetXboxLiveContextProperty=function(t,i){n.SceneManager.IsXboxLivePluginEnabled()&&window.BabylonToolkit.XboxLive.Plugin.setXboxLiveContextProperty(t,i)},t.ResetXboxLivePropertyContexts=function(){n.SceneManager.IsXboxLivePluginEnabled()&&window.BabylonToolkit.XboxLive.Plugin.resetXboxLivePropertyContexts()},t.SetXboxLiveSignOutHandler=function(t){void 0===t&&(t=null);n.SceneManager.IsXboxLivePluginEnabled()&&(window.BabylonToolkit.XboxLive.Plugin.onusersignout=t)},t.GamepadManager=null,t.GamepadConnected=null,t.GamepadDisconnected=null,t.TempMatrix=n.Matrix.Zero(),t.TempVector2=n.Vector2.Zero(),t.TempVector3=n.Vector3.Zero(),t.AuxMatrix=n.Matrix.Zero(),t.AuxVector2=n.Vector2.Zero(),t.AuxVector3=n.Vector3.Zero(),t.me=null,t.min=Number.MIN_VALUE,t.max=Number.MAX_VALUE-100,t.keymap={},t.prefabs=null,t.wheel=0,t.clientx=0,t.clienty=0,t.mousex=0,t.mousey=0,t.vertical=0,t.horizontal=0,t.mousex2=0,t.mousey2=0,t.vertical2=0,t.horizontal2=0,t.mousex3=0,t.mousey3=0,t.vertical3=0,t.horizontal3=0,t.mousex4=0,t.mousey4=0,t.vertical4=0,t.horizontal4=0,t.x_wheel=0,t.x_mousex=0,t.x_mousey=0,t.x_vertical=0,t.x_horizontal=0,t.k_mousex=0,t.k_mousey=0,t.k_vertical=0,t.k_horizontal=0,t.j_mousex=0,t.j_mousey=0,t.j_vertical=0,t.j_horizontal=0,t.g_mousex1=0,t.g_mousey1=0,t.g_vertical1=0,t.g_horizontal1=0,t.g_mousex2=0,t.g_mousey2=0,t.g_vertical2=0,t.g_horizontal2=0,t.g_mousex3=0,t.g_mousey3=0,t.g_vertical3=0,t.g_horizontal3=0,t.g_mousex4=0,t.g_mousey4=0,t.g_vertical4=0,t.g_horizontal4=0,t.engine=null,t.orphans=null,t.multiPlayerView=!1,t.multiPlayerCount=1,t.mouseButtonPress=[],t.mouseButtonDown=[],t.mouseButtonUp=[],t.keyButtonPress=[],t.keyButtonDown=[],t.keyButtonUp=[],t.leftJoystick=null,t.rightJoystick=null,t.virtualJoystick=!1,t.showRenderStats=!1,t.sceneRenderStats=0,t.renderStatsInstance=null,t.showPhysicsImposter=!1,t.showDebugSockets=!1,t.colliderVisibility=.25,t.socketColliderSize=.125,t.staticVertexLimit=!1,t.debugLayerVisible=!1,t.previousPosition=null,t.preventDefault=!1,t.stereoCameras=!0,t.rightHanded=!0,t.pointerLocked=!1,t.enableLocking=!1,t.physicsViewer=null,t.gamepad1=null,t.gamepad1Type=n.GamepadType.None,t.gamepad1ButtonPress=[],t.gamepad1ButtonDown=[],t.gamepad1ButtonUp=[],t.gamepad1DpadPress=[],t.gamepad1DpadDown=[],t.gamepad1DpadUp=[],t.gamepad1LeftTrigger=[],t.gamepad1RightTrigger=[],t.gamepad2=null,t.gamepad2Type=n.GamepadType.None,t.gamepad2ButtonPress=[],t.gamepad2ButtonDown=[],t.gamepad2ButtonUp=[],t.gamepad2DpadPress=[],t.gamepad2DpadDown=[],t.gamepad2DpadUp=[],t.gamepad2LeftTrigger=[],t.gamepad2RightTrigger=[],t.gamepad3=null,t.gamepad3Type=n.GamepadType.None,t.gamepad3ButtonPress=[],t.gamepad3ButtonDown=[],t.gamepad3ButtonUp=[],t.gamepad3DpadPress=[],t.gamepad3DpadDown=[],t.gamepad3DpadUp=[],t.gamepad3LeftTrigger=[],t.gamepad3RightTrigger=[],t.gamepad4=null,t.gamepad4Type=n.GamepadType.None,t.gamepad4ButtonPress=[],t.gamepad4ButtonDown=[],t.gamepad4ButtonUp=[],t.gamepad4DpadPress=[],t.gamepad4DpadDown=[],t.gamepad4DpadUp=[],t.gamepad4LeftTrigger=[],t.gamepad4RightTrigger=[],t.loader=null,t.readies=[],t}();n.SceneManager=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(n){if(null==n)throw new Error("Null owner agent mesh specified.");this._mesh=n;this._info=null!=this._mesh.metadata&&null!=this._mesh.metadata.navAgent?this._mesh.metadata.navAgent:null}return Object.defineProperty(t.prototype,"mesh",{get:function(){return this._mesh},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"info",{get:function(){return this._info},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAgentInfo",{get:function(){return null!=this.info},enumerable:!0,configurable:!0}),t.prototype.setDestination=function(){this.hasAgentInfo||n.Tools.Warn("Null navigation agent metadata. Set agent destination ignored.")},t}();n.NavigationAgent=t}(BABYLON||(BABYLON={}));__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var t=function(t){function i(n,i,r,u){void 0===r&&(r=!0);void 0===u&&(u={});var f=t.call(this,n,i,r,u)||this;return f._time=0,f._auto=!1,f._mode=0,f._size=4096,f._shape=0,f._shuriken=null,f._time=0,f._auto=!1,f._shuriken=null,f.initializeParticleSystem(),f}return __extends(i,t),Object.defineProperty(i.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shape",{get:function(){return this._shape},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shuriken",{get:function(){return this._shuriken},enumerable:!0,configurable:!0}),i.prototype.start=function(){this._auto===!0&&null!=this._shuriken&&this._shuriken.start()},i.prototype.destroy=function(){null!=this._shuriken&&(this._shuriken.dispose(),this._shuriken=null)},i.prototype.initializeParticleSystem=function(){var w,h,b,c,k,l,d,g,nt,i,r,rt;this._mode=this.getProperty("systemMode",0);this._size=this.getProperty("randomSize",4096);this._auto=this.getProperty("autoStart",!1);this._shape=this.getProperty("preset",0);var f=this.getProperty("capacity",100),t=this.getProperty("particleName",null),e=this.getProperty("startSpeed",.01),ut=this.getProperty("angle",1),o=this.getProperty("radius",1),ft=this.getProperty("activeCount",1e5),a=this.getProperty("emitType",0),s=this.getProperty("duration",10),v=this.getProperty("randomizer",0);null!=t&&""!==t||(t=this.entity.name+".Particle."+n.Tools.RandomId());var y=this.getProperty("emitBurst",null),et=this.getProperty("textureMask"),ot=this.getProperty("angularSpeed"),p=n.Utilities.ParseColor4(et,new n.Color4(1,1,1,1)),u=n.Utilities.ParseVector2(ot,new n.Vector2(0,0));1===this._mode?(n.GPUParticleSystem.IsSupported&&(this._shuriken=new n.GPUShurikenParticleSystem(t,f,this.scene,this._size,s,e),this._shuriken.activeParticleCount=ft),null==this._shuriken&&(this._mode=0,this._shuriken=new n.ShurikenParticleSystem(t,f,this.scene,s,a,e,y),this._shuriken.textureMask=p,this._shuriken.minAngularSpeed=u.x,this._shuriken.maxAngularSpeed=u.y,n.Tools.Warn("Babylon.js using cpu particle system fallback for owner: "+this.entity.name))):(this._shuriken=new n.ShurikenParticleSystem(t,f,this.scene,s,a,e,y),this._shuriken.textureMask=p,this._shuriken.minAngularSpeed=u.x,this._shuriken.maxAngularSpeed=u.y);this._shuriken.emitter=this.mesh;this._shuriken.blendMode=this.getProperty("blendMode",0);this._shuriken.emitRate=this.getProperty("emitRate",100);this._shuriken.loopPlay=this.getProperty("loopPlay",!1);this._shuriken.delayTime=this.getProperty("delayTime",0);w=this.getProperty("lifeTime");h=n.Utilities.ParseVector2(w,new n.Vector2(1,1));this._shuriken.minLifeTime=h.x;this._shuriken.maxLifeTime=h.y;b=this.getProperty("emitPower");c=n.Utilities.ParseVector2(b,new n.Vector2(1,1));this._shuriken.minEmitPower=c.x;this._shuriken.maxEmitPower=c.y;k=this.getProperty("particleSize");l=n.Utilities.ParseVector2(k,new n.Vector2(1,1));this._shuriken.minSize=l.x;this._shuriken.maxSize=l.y;d=this.getProperty("color1");this._shuriken.color1=n.Utilities.ParseColor4(d,new n.Color4(1,1,1,1));g=this.getProperty("color2");this._shuriken.color2=n.Utilities.ParseColor4(g,new n.Color4(1,1,1,1));nt=this.getProperty("colorDead");this._shuriken.colorDead=n.Utilities.ParseColor4(nt,new n.Color4(0,0,0,1));var st=this.getProperty("direction1"),tt=n.Utilities.ParseVector3(st,new n.Vector3(0,1,0)),ht=this.getProperty("direction2"),it=n.Utilities.ParseVector3(ht,new n.Vector3(0,1,0)),ct=this.getProperty("minEmitBox"),lt=n.Utilities.ParseVector3(ct,new n.Vector3(0,0,0)),at=this.getProperty("maxEmitBox"),vt=n.Utilities.ParseVector3(at,new n.Vector3(0,0,0));switch(this._shape){case 0:i=new n.BoxParticleEmitter;i.direction1=tt;i.direction2=it;i.minEmitBox=lt;i.maxEmitBox=vt;this._shuriken.particleEmitterType=i;break;case 1:this._shuriken.particleEmitterType=new n.ConeParticleEmitter(o,ut,v);break;case 2:this._shuriken.particleEmitterType=new n.SphereParticleEmitter(o,v);break;case 3:this._shuriken.particleEmitterType=new n.SphereDirectedParticleEmitter(o,tt,it)}var yt=this.getProperty("gravityVector"),pt=this.getProperty("gravityMode",0),wt=this.getProperty("gravityMultiplier",0);this._shuriken.gravity=1===pt?this.scene.gravity.scale(wt):n.Utilities.ParseVector3(yt,new n.Vector3(0,0,0));r=this.getProperty("textureImage",null);rt=this.manager.getScenePath();null!=r&&r.name&&""!==r.name&&(this._shuriken.particleTexture=new n.Texture(rt+r.name,this.scene))},i}(n.MeshComponent);n.UniversalParticleSystem=t}(BABYLON||(BABYLON={}));__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var t=function(t){function i(i,r,u,f){void 0===u&&(u=!0);void 0===f&&(f={});var e=t.call(this,i,r,u,f)||this;return e.movementType=n.MovementType.DirectVelocity,e.avatarControl=0,e.avatarHeight=2,e.avatarRadius=.25,e.fallingVelocity=.1,e.slidingVelocity=.25,e.synchronizeVelocity=!0,e.onPhysicsContact=null,e._jumping=!1,e._falling=!1,e._sliding=!1,e._grounded=!0,e._threashold=.5,e._velocity=n.Vector3.Zero(),e._angularVelocity=n.Vector3.Zero(),e._jumpingVelocity=n.Vector3.Zero(),e.movementType=e.getProperty("movementType",n.MovementType.DirectVelocity),e.avatarControl=e.getProperty("avatarControl",0),e.avatarHeight=e.getProperty("avatarHeight",2),e.avatarRadius=e.getProperty("avatarRadius",.25),e.fallingVelocity=e.getProperty("fallingVelocity",.1),e.slidingVelocity=e.getProperty("slidingVelocity",.25),e}return __extends(i,t),i.prototype.isJumping=function(){return this._jumping},i.prototype.isFalling=function(){return this._falling},i.prototype.isSliding=function(){return this._sliding},i.prototype.isGrounded=function(){return this._grounded},i.prototype.getVelocity=function(){return this._velocity},i.prototype.getFriction=function(){return this.manager.getFrictionLevel(this.mesh)},i.prototype.setFriction=function(n){this.manager.applyFriction(this.mesh,n)},i.prototype.start=function(){var t=this;this._jumping=!1;this._falling=!1;this._sliding=!1;this._grounded=!0;this.updateGroundingState();this.onCollisionEvent=function(i,r){t.manager.checkCollisionContact(t.mesh,i,n.CollisionContact.Bottom,t._threashold)===!0&&(t._jumping=!1,t.updateGroundingState());null!=t.onPhysicsContact&&t.onPhysicsContact(i,r)}},i.prototype.update=function(){this.updateGroundingState()},i.prototype.after=function(){this.updateGroundingState()},i.prototype.updateGroundingState=function(){this._grounded=this._jumping===!1;this._velocity=this.movementType===n.MovementType.CheckCollision?n.Vector3.Zero():this.manager.getLinearVelocity(this.mesh);this._falling=null!=this._velocity&&this._velocity.y<-this.fallingVelocity;this._sliding=this._grounded===!0&&null!=this._velocity&&this._velocity.y<-this.slidingVelocity},i.prototype.move=function(t,i,r){void 0===i&&(i=-1);void 0===r&&(r=-1);this.movementType===n.MovementType.CheckCollision||(i>=0&&this.manager.applyFriction(this.mesh,i),this.synchronizeVelocity&&(t.y=this._velocity.y),this.movementType===n.MovementType.AppliedForces?this.manager.applyForce(this.mesh,t,this.mesh.getAbsolutePosition()):this.manager.setLinearVelocity(this.mesh,t),r>0&&(this._jumping=!0,this._jumpingVelocity.copyFromFloats(0,r,0),this.manager.applyImpulse(this.mesh,this._jumpingVelocity,this.mesh.getAbsolutePosition()),this.updateGroundingState()))},i.prototype.turn=function(t,i){void 0===i&&(i=-1);this.movementType===n.MovementType.CheckCollision||(i>=0&&this.manager.applyFriction(this.mesh,i),this._angularVelocity.copyFromFloats(0,t,0),this.manager.setAngularVelocity(this.mesh,this._angularVelocity))},i}(n.MeshComponent);n.CharacterController=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function n(n){this.loadingUIText=n;this.borderPrefix="4px solid";this.panelElement=null;this.loaderElement=null;this.statusElement=null;this.projectElement=null;this._statusColor="#0000ff"}return Object.defineProperty(n.prototype,"statusColor",{get:function(){return this._statusColor},set:function(n){this._statusColor=n;null!=this.loaderElement&&(this.loaderElement.style.borderTop=this.borderPrefix+" "+this._statusColor)},enumerable:!0,configurable:!0}),n.prototype.displayLoadingUI=function(){null!=this.panelElement&&(this.panelElement.className="");null!=this.loaderElement&&(this.loaderElement.className="");null!=this.statusElement&&(this.statusElement.className="");null!=this.projectElement&&(this.projectElement.className="");this.updateLoadingUI()},n.prototype.updateLoadingUI=function(){null!=this.statusElement&&this.statusElement.innerHTML!==this.loadingUIText&&(this.statusElement.innerHTML=this.loadingUIText)},n.prototype.hideLoadingUI=function(){null!=this.panelElement&&(this.panelElement.className="hidden");null!=this.loaderElement&&(this.loaderElement.className="hidden");null!=this.statusElement&&(this.statusElement.className="hidden");null!=this.projectElement&&(this.projectElement.className="hidden")},n}();n.ToolkitProgress=t}(BABYLON||(BABYLON={}));TimerPlugin=window;TimerPlugin.requestAnimFrame=function(){return TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame||function(n){TimerPlugin.setTimeout(n,1e3/60)}}();TimerPlugin.requestInterval=function(n,t){function r(){var f=TimerPlugin.getTimeMilliseconds(),e=f-u;e>=t&&(n.call(),u=TimerPlugin.getTimeMilliseconds());i.value=TimerPlugin.requestAnimFrame(r)}if(!(TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame&&TimerPlugin.mozCancelRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame))return TimerPlugin.setInterval(n,t);var u=TimerPlugin.getTimeMilliseconds(),i={};return i.value=TimerPlugin.requestAnimFrame(r),i};TimerPlugin.clearRequestInterval=function(n){TimerPlugin.cancelAnimationFrame?TimerPlugin.cancelAnimationFrame(n.value):TimerPlugin.webkitCancelAnimationFrame?TimerPlugin.webkitCancelAnimationFrame(n.value):TimerPlugin.webkitCancelRequestAnimationFrame?TimerPlugin.webkitCancelRequestAnimationFrame(n.value):TimerPlugin.mozCancelRequestAnimationFrame?TimerPlugin.mozCancelRequestAnimationFrame(n.value):TimerPlugin.oCancelRequestAnimationFrame?TimerPlugin.oCancelRequestAnimationFrame(n.value):TimerPlugin.msCancelRequestAnimationFrame?TimerPlugin.msCancelRequestAnimationFrame(n.value):clearInterval(n);n=null};TimerPlugin.requestTimeout=function(n,t){function r(){var f=TimerPlugin.getTimeMilliseconds(),e=f-u;e>=t?n.call():i.value=TimerPlugin.requestAnimFrame(r)}if(!(TimerPlugin.requestAnimationFrame||TimerPlugin.webkitRequestAnimationFrame||TimerPlugin.mozRequestAnimationFrame&&TimerPlugin.mozCancelRequestAnimationFrame||TimerPlugin.oRequestAnimationFrame||TimerPlugin.msRequestAnimationFrame))return TimerPlugin.setTimeout(n,t);var u=TimerPlugin.getTimeMilliseconds(),i={};return i.value=TimerPlugin.requestAnimFrame(r),i};TimerPlugin.clearRequestTimeout=function(n){TimerPlugin.cancelAnimationFrame?TimerPlugin.cancelAnimationFrame(n.value):TimerPlugin.webkitCancelAnimationFrame?TimerPlugin.webkitCancelAnimationFrame(n.value):TimerPlugin.webkitCancelRequestAnimationFrame?TimerPlugin.webkitCancelRequestAnimationFrame(n.value):TimerPlugin.mozCancelRequestAnimationFrame?TimerPlugin.mozCancelRequestAnimationFrame(n.value):TimerPlugin.oCancelRequestAnimationFrame?TimerPlugin.oCancelRequestAnimationFrame(n.value):TimerPlugin.msCancelRequestAnimationFrame?TimerPlugin.msCancelRequestAnimationFrame(n.value):clearTimeout(n);n=null};TimerPlugin.getTimeMilliseconds=function(){return BABYLON.Tools.Now};BABYLON.SceneManager.IsWindows()&&"undefined"!=typeof Windows.UI.ViewManagement&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode&&"undefined"!=typeof Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow&&Windows.UI.ViewManagement.ApplicationView.getForCurrentView().setDesiredBoundsMode(Windows.UI.ViewManagement.ApplicationViewBoundsMode.useCoreWindow);window.addEventListener("load",function(){window.ontoolkitload&&window.ontoolkitload();document.addEventListener("deviceready",function(){navigator.splashscreen&&navigator.splashscreen.hide();window.ontoolkitdevice&&window.ontoolkitdevice()},!1)},!1);__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var u=function(){function n(){this._defines={};this._defines={}}return n.prototype.getDefines=function(){return this._defines},n.prototype.resetDefines=function(){return this._defines={}},n.prototype.defineBoolean=function(n){this._defines[n]=!0},n.prototype.defineNumeric=function(n,t){this._defines[n]=t},n}(),t,i,r;n.UniversalShaderDefines=u;t=function(t){function i(n,i,r){void 0===r&&(r=!1);var u=t.call(this,n,i)||this;return u.ticking=!1,u._manager=null,u._started=!1,u._register=null,u._before=null,u._after=null,u._destroy=null,u.ticking=r,u.ticking&&u.initializeInstance(),u}return __extends(i,t),i.prototype.start=function(){},i.prototype.update=function(){},i.prototype.after=function(){},i.prototype.destroy=function(){},i.prototype.getManager=function(){return null==this._manager&&(this._manager=n.SceneManager.GetInstance()),this._manager},i.prototype.initializeInstance=function(){this._started=!1;var n=this;n._register=function(){n.registerInstance(n)};n._before=function(){n.updateInstance(n)};n._after=function(){n.afterInstance(n)};n._destroy=function(){n.destoryInstance(n)};n._register()},i.prototype.registerInstance=function(n){n.getScene().registerBeforeRender(n._before);n.getScene().registerAfterRender(n._after)},i.prototype.updateInstance=function(n){n._started?n.update():(n.start(),n._started=!0)},i.prototype.afterInstance=function(n){n._started&&n.after()},i.prototype.destoryInstance=function(n){n.getScene().unregisterBeforeRender(n._before);n.getScene().unregisterAfterRender(n._after);n.destroy();n._started=!1;n._register=null;n._before=null;n._after=null;n._destroy=null},i.prototype.dispose=function(n,i){this._destroy();t.prototype.dispose.call(this,n,i)},i}(n.PushMaterial);n.UniversalPushMaterial=t;i=function(t){function i(i,r,u){void 0===u&&(u=!1);var f=t.call(this,i,r)||this;return f.tick=!0,f.ticking=!1,f.program="default",f._locals=null,f._uniforms=[],f._samplers=[],f._textures={},f._textureArrays={},f._floats={},f._floatsArrays={},f._colors3={},f._colors4={},f._vectors2={},f._vectors3={},f._vectors4={},f._matrices={},f._matrices3x3={},f._matrices2x2={},f._vectors3Arrays={},f._manager=null,f._started=!1,f._register=null,f._before=null,f._after=null,f._destroy=null,f._locals=new n.UniversalShaderDefines,f.customShaderNameResolve=f._buildCustomShader,f.ticking=u,f.ticking&&f.initializeInstance(),f}return __extends(i,t),i.prototype.start=function(){},i.prototype.update=function(){},i.prototype.define=function(){},i.prototype.after=function(){},i.prototype.destroy=function(){},Object.defineProperty(i.prototype,"textures",{get:function(){return this._textures},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureArray",{get:function(){return this._textureArrays},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"floats",{get:function(){return this._floats},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"floatsArrays",{get:function(){return this._floatsArrays},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"colors3",{get:function(){return this._colors3},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"colors4",{get:function(){return this._colors4},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vectors2",{get:function(){return this._vectors2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vectors3",{get:function(){return this._vectors3},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vectors4",{get:function(){return this._vectors4},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrices",{get:function(){return this._matrices},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrices3x3",{get:function(){return this._matrices3x3},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"matrices2x2",{get:function(){return this._matrices2x2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vectors3Arrays",{get:function(){return this._vectors3Arrays},enumerable:!0,configurable:!0}),i.prototype.setTexture=function(n,t){return this._checkSampler(n),this._textures[n]=t,this},i.prototype.setTextureArray=function(n,t){return this._samplers.indexOf(n)===-1&&this._samplers.push(n),this._checkUniform(n),this._textureArrays[n]=t,this},i.prototype.setFloat=function(n,t){return this._checkUniform(n),this._floats[n]=t,this},i.prototype.setFloats=function(n,t){return this._checkUniform(n),this._floatsArrays[n]=t,this},i.prototype.setColor3=function(n,t){return this._checkUniform(n),this._colors3[n]=t,this},i.prototype.setColor4=function(n,t){return this._checkUniform(n),this._colors4[n]=t,this},i.prototype.setVector2=function(n,t){return this._checkUniform(n),this._vectors2[n]=t,this},i.prototype.setVector3=function(n,t){return this._checkUniform(n),this._vectors3[n]=t,this},i.prototype.setVector4=function(n,t){return this._checkUniform(n),this._vectors4[n]=t,this},i.prototype.setMatrix=function(n,t){return this._checkUniform(n),this._matrices[n]=t,this},i.prototype.setMatrix3x3=function(n,t){return this._checkUniform(n),this._matrices3x3[n]=t,this},i.prototype.setMatrix2x2=function(n,t){return this._checkUniform(n),this._matrices2x2[n]=t,this},i.prototype.setArray3=function(n,t){return this._checkUniform(n),this._vectors3Arrays[n]=t,this},i.prototype.isReadyForSubMesh=function(n,i,r){var o,l,u,f,s,h,e,c;if(this._locals.resetDefines(),this.define(this._locals),o=!1,l=this.getScene(),l.texturesEnabled){f=!0;for(u in this._textures)s=this._textures[u],s&&s.isReadyOrNotBlocking()?(o=!0,this._locals.defineBoolean(u+"Def"),this._checkUniform(u+"Infos"),this._checkUniform(u+"Scale"),this._checkUniform(u+"Matrix")):f=!1;if(!f)return!1;f=!0;for(u in this._textureArrays)for(this._locals.defineBoolean(u+"Def"),h=this._textureArrays[u],e=0;e<h.length;e++)c=h[e],c&&c.isReadyOrNotBlocking()?o=!0:f=!1;if(!f)return!1}return t.prototype.isReadyForSubMesh.call(this,n,i,r)},i.prototype.getAnimatables=function(){var i,u=t.prototype.getAnimatables.call(this),f,r,n;for(i in this._textures)n=this._textures[i],n&&u.push(n);for(i in this._textureArrays)for(f=this._textureArrays[i],r=0;r<f.length;r++)n=f[r],n&&u.push(n);return u},i.prototype.getActiveTextures=function(){var i,u=t.prototype.getActiveTextures.call(this),f,r,n;for(i in this._textures)n=this._textures[i],n&&u.push(n);for(i in this._textureArrays)for(f=this._textureArrays[i],r=0;r<f.length;r++)n=f[r],n&&u.push(n);return u},i.prototype.hasTexture=function(n){var r,i,f,e,u,o;if(t.prototype.hasTexture.call(this,n))return!0;i=!1;for(r in this._textures)if(f=this._textures[r],f&&f===n){i=!0;break}if(i===!1)for(r in this._textureArrays){for(e=this._textureArrays[r],u=0;u<e.length;u++)if(o=e[u],o&&o===n){i=!0;break}if(i===!0)break}return i},i.prototype.clone=function(t){var r=this,i=n.SerializationHelper.Clone(function(){return new n.UniversalShaderMaterial(t,r.getScene())},this);return n.UniversalShaderMaterial.CloneCustomProperties(this,i),i},i.prototype.serialize=function(){var t=n.SerializationHelper.Serialize(this);return t.customType="BABYLON.UniversalShaderMaterial",n.UniversalShaderMaterial.SerializeCustomProperties(this,t),t},i.Parse=function(t,i,r){var u=n.SerializationHelper.Parse(function(){return new n.UniversalShaderMaterial(t.name,i)},t,i,r);return n.UniversalShaderMaterial.ParseCustomProperties(u,t,i,r),u},i.CloneCustomProperties=function(n,t){var i,r;if(null!=n&&null!=t){t._textures={};for(i in n._textures)r=n._textures[i],r&&t.setTexture(i,r.clone());t._textureArrays={};for(i in n._textureArrays){t._textureArrays[i]=[];for(var f=n._textureArrays[i],e=[],u=0;u<f.length;u++)e.push(f[u].clone());t.setTextureArray(i,e)}t._floats={};for(i in n._floats)t.setFloat(i,n._floats[i]);t._floatsArrays={};for(i in n._floatsArrays)t.setFloats(i,n._floatsArrays[i]);t._colors3={};for(i in n._colors3)t.setColor3(i,n._colors3[i].clone());t._colors4={};for(i in n._colors4)t.setColor4(i,n._colors4[i].clone());t._vectors2={};for(i in n._vectors2)t.setVector2(i,n._vectors2[i].clone());t._vectors3={};for(i in n._vectors3)t.setVector3(i,n._vectors3[i].clone());t._vectors4={};for(i in n._vectors4)t.setVector4(i,n._vectors4[i].clone());t._matrices={};for(i in n._matrices)t.setMatrix(i,n._matrices[i].clone());t._matrices3x3={};for(i in n._matrices3x3)t.setMatrix3x3(i,n._matrices3x3[i]);t._matrices2x2={};for(i in n._matrices2x2)t.setMatrix2x2(i,n._matrices2x2[i]);t._vectors3Arrays={};for(i in n._vectors3Arrays)t.setArray3(i,n._vectors3Arrays[i])}},i.SerializeCustomProperties=function(n,t){var i,u,f,r;if(null!=t&&null!=n){t.textures={};for(i in n._textures)u=n._textures[i],u&&(t.textures[i]=u.serialize());t.textureArrays={};for(i in n._textureArrays)for(t.textureArrays[i]=[],f=n._textureArrays[i],r=0;r<f.length;r++)t.textureArrays[i].push(f[r].serialize());t.floats={};for(i in n._floats)t.floats[i]=n._floats[i];t.floatsArrays={};for(i in n._floatsArrays)t.floatsArrays[i]=n._floatsArrays[i];t.colors3={};for(i in n._colors3)t.colors3[i]=n._colors3[i].asArray();t.colors4={};for(i in n._colors4)t.colors4[i]=n._colors4[i].asArray();t.vectors2={};for(i in n._vectors2)t.vectors2[i]=n._vectors2[i].asArray();t.vectors3={};for(i in n._vectors3)t.vectors3[i]=n._vectors3[i].asArray();t.vectors4={};for(i in n._vectors4)t.vectors4[i]=n._vectors4[i].asArray();t.matrices={};for(i in n._matrices)t.matrices[i]=n._matrices[i].asArray();t.matrices3x3={};for(i in n._matrices3x3)t.matrices3x3[i]=n._matrices3x3[i];t.matrices2x2={};for(i in n._matrices2x2)t.matrices2x2[i]=n._matrices2x2[i];t.vectors3Arrays={};for(i in n._vectors3Arrays)t.vectors3Arrays[i]=n._vectors3Arrays[i]}},i.ParseCustomProperties=function(t,i,r,u){var f,e;if(null!=i&&null!=t){for(f in i.textures)e=i.textures[f],e&&t.setTexture(f,n.Texture.Parse(e,r,u));for(f in i.textureArrays){for(var s=i.textureArrays[f],h=[],o=0;o<s.length;o++)h.push(n.Texture.Parse(s[o],r,u));t.setTextureArray(f,h)}for(f in i.floats)t.setFloat(f,i.floats[f]);for(f in i.floatsArrays)t.setFloats(f,i.floatsArrays[f]);for(f in i.colors3)t.setColor3(f,n.Color3.FromArray(i.colors3[f]));for(f in i.colors4)t.setColor4(f,n.Color4.FromArray(i.colors4[f]));for(f in i.vectors2)t.setVector2(f,n.Vector2.FromArray(i.vectors2[f]));for(f in i.vectors3)t.setVector3(f,n.Vector3.FromArray(i.vectors3[f]));for(f in i.vectors4)t.setVector4(f,n.Vector4.FromArray(i.vectors4[f]));for(f in i.matrices)t.setMatrix(f,n.Matrix.FromArray(i.matrices[f]));for(f in i.matrices3x3)t.setMatrix3x3(f,i.matrices3x3[f]);for(f in i.matrices2x2)t.setMatrix2x2(f,i.matrices2x2[f]);for(f in i.vectors3Arrays)t.setArray3(f,i.vectors3Arrays[f])}},i.prototype.getManager=function(){return null==this._manager&&(this._manager=n.SceneManager.GetInstance()),this._manager},i.prototype._checkUniform=function(n){this._uniforms.indexOf(n)===-1&&this._uniforms.push(n)},i.prototype._checkSampler=function(n){this._samplers.indexOf(n)===-1&&this._samplers.push(n)},i.prototype._buildCustomShader=function(n,t,i,r,u){var a=this,e,o,h,f,c;if(null!=this.program&&""!==this.program||(this.program="default"),e=this._locals.getDefines(),null!=e&&(o=Object.keys(e),null!=o&&o.length>0)){for(var v=u,s=0,l=o;s<l.length;s++)h=l[s],v[h]=e[h];u.rebuild()}if(f=0,null!=this._uniforms&&this._uniforms.length>0)for(f=0;f<this._uniforms.length;f++)t.push(this._uniforms[f]);if(f=0,null!=this._samplers&&this._samplers.length>0)for(f=0;f<this._samplers.length;f++)r.push(this._samplers[f]);return c=this._afterBind,this._afterBind=function(n,t){if(a._attachAfterBind(n,t),c)try{c(n,t)}catch(i){}},this.program},i.prototype._attachAfterBind=function(n,t){var i,f=this.getScene(),r,u;if(f.texturesEnabled)for(i in this._textures)r=this._textures[i],r&&(t.setTexture(i,r),t.setFloat2(i+"Infos",r.coordinatesIndex,r.level),t.setFloat2(i+"Scale",r.uScale,r.vScale),t.setMatrix(i+"Matrix",r.getTextureMatrix()));if(f.texturesEnabled)for(i in this._textureArrays)t.setTextureArray(i,this._textureArrays[i]);for(i in this._floats)t.setFloat(i,this._floats[i]);for(i in this._floatsArrays)t.setArray(i,this._floatsArrays[i]);for(i in this._colors3)t.setColor3(i,this._colors3[i]);for(i in this._colors4)u=this._colors4[i],t.setFloat4(i,u.r,u.g,u.b,u.a);for(i in this._vectors2)t.setVector2(i,this._vectors2[i]);for(i in this._vectors3)t.setVector3(i,this._vectors3[i]);for(i in this._vectors4)t.setVector4(i,this._vectors4[i]);for(i in this._matrices)t.setMatrix(i,this._matrices[i]);for(i in this._matrices3x3)t.setMatrix3x3(i,this._matrices3x3[i]);for(i in this._matrices2x2)t.setMatrix2x2(i,this._matrices2x2[i]);for(i in this._vectors3Arrays)t.setArray3(i,this._vectors3Arrays[i])},i.prototype.initializeInstance=function(){this._started=!1;var n=this;n._register=function(){n.registerInstance(n)};n._before=function(){n.updateInstance(n)};n._after=function(){n.afterInstance(n)};n._destroy=function(){n.destoryInstance(n)};n._register()},i.prototype.registerInstance=function(n){n.getScene().registerBeforeRender(n._before);n.getScene().registerAfterRender(n._after)},i.prototype.updateInstance=function(n){n._started?n.update():(n.start(),n._started=!0)},i.prototype.afterInstance=function(n){n._started&&n.after()},i.prototype.destoryInstance=function(n){n.getScene().unregisterBeforeRender(n._before);n.getScene().unregisterAfterRender(n._after);n.destroy();n._started=!1;n._register=null;n._before=null;n._after=null;n._destroy=null},i.prototype.dispose=function(n,i){var r,f,e,u;if(i){for(r in this._textures)f=this._textures[r],f&&f.dispose(),this._textures[r]=null;for(r in this._textureArrays)for(e=this._textureArrays[r],u=0;u<e.length;u++)e[u].dispose()}this._textures={};this._destroy();t.prototype.dispose.call(this,n,i)},i}(n.StandardMaterial);n.UniversalShaderMaterial=i;r=function(t){function i(n,i,r){var u,f,e;return void 0===r&&(r=!0),u=t.call(this,n,i,r)||this,u._totalTexturesLoaded=0,u._maxTexturesImageUnits=0,u.program="splatmap",f=i.getEngine(),e=f.getCaps(),u._totalTexturesLoaded=0,u._maxTexturesImageUnits=e.maxTexturesImageUnits,u}return __extends(i,t),Object.defineProperty(i.prototype,"totalTexturesLoaded",{get:function(){return this._totalTexturesLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTexturesImageUnits",{get:function(){return this._maxTexturesImageUnits},enumerable:!0,configurable:!0}),i.prototype.start=function(){var u=this,t,r,i;this._totalTexturesLoaded=0;this.diffuseTexture&&this._totalTexturesLoaded++;this.bumpTexture&&this._totalTexturesLoaded++;this.lightmapTexture&&this._totalTexturesLoaded++;this.reflectionTexture&&this._totalTexturesLoaded++;this.emissiveTexture&&this._totalTexturesLoaded++;this.specularTexture&&this._totalTexturesLoaded++;this.ambientTexture&&this._totalTexturesLoaded++;this.opacityTexture&&this._totalTexturesLoaded++;this.refractionTexture&&this._totalTexturesLoaded++;this.cameraColorGradingTexture&&this._totalTexturesLoaded++;for(t in this.textures)r=this.textures[t],r&&this._totalTexturesLoaded++;for(t in this.textureArray)i=this.textureArray[t],i&&i.forEach(function(n){n&&u._totalTexturesLoaded++});this.totalTexturesLoaded>this.maxTexturesImageUnits&&n.Tools.Warn("Babylon.js max terrain texture units exceeded ("+this.totalTexturesLoaded.toString()+" of "+this.maxTexturesImageUnits.toString()+")")},i.prototype.define=function(n){n.defineNumeric("TOTAL_TEXTURES_LOADED",this.totalTexturesLoaded);n.defineNumeric("MAX_TEXTURE_IMAGE_UNITS",this.maxTexturesImageUnits);this.totalTexturesLoaded<=this.maxTexturesImageUnits&&n.defineBoolean("SPLATMAPS_ENABLED")},i.prototype.clone=function(t){var r=this,i=n.SerializationHelper.Clone(function(){return new n.UniversalTerrainMaterial(t,r.getScene())},this);return n.UniversalShaderMaterial.CloneCustomProperties(this,i),i},i.prototype.serialize=function(){var t=n.SerializationHelper.Serialize(this);return t.customType="BABYLON.UniversalTerrainMaterial",n.UniversalShaderMaterial.SerializeCustomProperties(this,t),t},i.Parse=function(t,i,r){var u=n.SerializationHelper.Parse(function(){return new n.UniversalTerrainMaterial(t.name,i)},t,i,r);return n.UniversalShaderMaterial.ParseCustomProperties(u,t,i,r),u},i}(n.UniversalShaderMaterial);n.UniversalTerrainMaterial=r}(BABYLON||(BABYLON={}));__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var i=function(t){function i(n,r,u,f,e,o,s){void 0===f&&(f=0);void 0===e&&(e=i.EMISSION_RATE);void 0===o&&(o=.01);void 0===s&&(s=null);var h=t.call(this,n,r,u)||this;return h.emitType=i.EMISSION_RATE,h.loopPlay=!1,h.delayTime=0,h._self=null,h._duration=0,h._startSpeed=-1,h._emissionBurst=null,h._self=h,h._duration=f,h._startSpeed=o,h._emissionBurst=s,h.delayTime=0,h.loopPlay=!1,h.emitType=e,h.updateSpeed=o,h.targetStopDuration=0,h.updateFunction=h.defaultUpdateFunctionHandler,h.manualEmitCount=h.emitType===i.EMISSION_BURST?0:-1,h}return __extends(i,t),Object.defineProperty(i,"EMISSION_RATE",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(i,"EMISSION_BURST",{get:function(){return 1},enumerable:!0,configurable:!0}),i.prototype.getDuration=function(){return this._duration},i.prototype.start=function(){var t=this,r;(this.internalStop(!1),this.updateSpeed=this._startSpeed,this.targetStopDuration=0,this.emitType===i.EMISSION_BURST?null!=this._emissionBurst&&this._emissionBurst.length>0&&this._emissionBurst.forEach(function(n){t.internalPlay(t.delayTime+n.time,n.minCount,n.maxCount)}):this.internalPlay(this.delayTime),this._duration>0)&&(r=this.delayTime+this._duration,n.SceneManager.GetInstance().delay(function(){t.internalCycle()},1e3*r))},i.prototype.stop=function(){this.internalStop(!0)},i.prototype.dispose=function(){this.internalStop(!0);this._emissionBurst=null;t.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"internalScene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),i.prototype.internalPlay=function(t,i,r){var u=this;void 0===t&&(t=0);void 0===i&&(i=-1);void 0===r&&(r=-1);t>0?n.SceneManager.GetInstance().delay(function(){u.internalStart(i,r)},1e3*t):this.internalStart(i,r)},i.prototype.internalCycle=function(){this.stop();this.loopPlay===!0&&this.start()},i.prototype.internalStart=function(r,u){var f=this.emitType===i.EMISSION_BURST?0:-1;this.emitType===i.EMISSION_BURST&&r>=1&&u>=1&&(f=n.Scalar.RandomRange(r,u));this.manualEmitCount=f;t.prototype.start.call(this)},i.prototype.internalStop=function(n){if(void 0===n&&(n=!1),n===!1){var i=this;null!=i&&i._started&&!i._stopped&&t.prototype.stop.call(this)}else t.prototype.stop.call(this)},i.prototype.getParticles=function(){return this.particles},i.prototype.defaultUpdateFunctionHandler=function(n){var i,t;if(null!=this._self)for(i=0;i<n.length;i++)t=n[i],t.age+=this._self._scaledUpdateSpeed,t.age>=t.lifeTime?(this._self._emitFromParticle(t),this._self.recycleParticle(t),i--):(t.colorStep.scaleToRef(this._self._scaledUpdateSpeed,this._self._scaledColorStep),t.color.addInPlace(this._self._scaledColorStep),t.color.a<0&&(t.color.a=0),t.angle+=t.angularSpeed*this._self._scaledUpdateSpeed,t.direction.scaleToRef(this._self._scaledUpdateSpeed,this._self._scaledDirection),t.position.addInPlace(this._self._scaledDirection),this._self.gravity.scaleToRef(this._self._scaledUpdateSpeed,this._self._scaledGravity),t.direction.addInPlace(this._self._scaledGravity),this._self._isAnimationSheetEnabled&&t.updateCellIndex())},i}(n.ParticleSystem),t;n.ShurikenParticleSystem=i;t=function(t){function i(n,i,r,u,f,e){void 0===u&&(u=4096);void 0===f&&(f=0);void 0===e&&(e=.01);var o=t.call(this,n,{capacity:i,randomTextureSize:u},r)||this;return o.loopPlay=!1,o.delayTime=0,o._self=null,o._duration=0,o._startSpeed=-1,o._self=o,o._duration=f,o._startSpeed=e,o.delayTime=0,o.loopPlay=!1,o.updateSpeed=e,o.targetStopDuration=0,o}return __extends(i,t),i.prototype.getDuration=function(){return this._duration},i.prototype.start=function(){var i=this,t;(this.internalStop(!1),this.updateSpeed=this._startSpeed,this.targetStopDuration=0,this.internalPlay(this.delayTime),this._duration>0)&&(t=this.delayTime+this._duration,n.SceneManager.GetInstance().delay(function(){i.internalCycle()},1e3*t))},i.prototype.stop=function(){this.internalStop(!0)},i.prototype.dispose=function(){this.internalStop(!0);t.prototype.dispose.call(this)},i.prototype.internalPlay=function(t,i,r){var u=this;void 0===t&&(t=0);void 0===i&&(i=-1);void 0===r&&(r=-1);t>0?n.SceneManager.GetInstance().delay(function(){u.internalStart(i,r)},1e3*t):this.internalStart(i,r)},i.prototype.internalCycle=function(){this.stop();this.loopPlay===!0&&this.start()},i.prototype.internalStart=function(){t.prototype.start.call(this)},i.prototype.internalStop=function(n){if(void 0===n&&(n=!1),n===!1){var i=this;null!=i&&i._started&&!i._stopped&&t.prototype.stop.call(this)}else t.prototype.stop.call(this)},i}(n.GPUParticleSystem);n.GPUShurikenParticleSystem=t}(BABYLON||(BABYLON={}));__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var t=function(t){function i(i,r,u,f){var e,s,o;return void 0===u&&(u=!0),void 0===f&&(f={}),e=t.call(this,i,r,u,f)||this,(e._fps=30,e._legacy=!1,e._targets=null,e._machine=null,e._skeletal=!1,e._executed=!1,e._autoplay=!0,e._checkers=new n.TransitionCheck,e._boneAnim=null,e._boneWeight=0,e._boneMatrix=n.Matrix.Zero(),e._sampleMatrix=n.Matrix.Zero(),e._inputPosition=n.Vector2.Zero(),e._childPosition=n.Vector2.Zero(),e._onAnimationFrameHandler=null,e._onAnimationEventHandlers=null,e._onAnimationBehaveHandlers=null,e.enabled=!1,e.speedRatio=1,e.autoTicking=!0,e.enableTransitions=!0,e.directBlendSpeed=1,e._targets=null,e._machine=null,e._legacy=!1,e._executed=!1,e._autoplay=!0,e._onAnimationFrameHandler=null,e._onAnimationEventHandlers={},e._onAnimationBehaveHandlers={},e.directBlendSpeed=1,e.speedRatio=1,e._fps=e.getProperty("timelineStep",30),e._skeletal=2===e.getProperty("controlType",0),e.enabled=e.getProperty("enableStateMachine",!1),e.enableTransitions=e.getProperty("enableTransitions",!0),null!=e.entity.metadata)&&((e.entity.metadata.state={},e.entity.metadata.state.data={},e.entity.metadata.state.clips={},e.entity.metadata.state.floats={},e.entity.metadata.state.booleans={},e.entity.metadata.state.triggers={},e.entity.metadata.state.parameters={},null!=e.entity.metadata.properties&&null!=e.entity.metadata.properties.stateMachineInfo)?(e._machine=e.entity.metadata.properties.stateMachineInfo,e._legacy=e._machine.legacy,e._legacy===!0&&(e._autoplay=e._machine.auto),null!=e._machine.speed&&(e.speedRatio=e._machine.speed),null!=e._machine.parameters&&e._machine.parameters.length>0)&&(s=e._machine.parameters,s.forEach(function(t){var i=t.name,r=t.type,u=(t.curve,t.defaultFloat),f=t.defaultBool,o=t.defaultInt;e.entity.metadata.state.parameters[i]=r;r===n.AnimatorParameterType.Bool?e.setBool(i,f):r===n.AnimatorParameterType.Float?e.setFloat(i,u):r===n.AnimatorParameterType.Int?e.setInteger(i,o):r===n.AnimatorParameterType.Trigger&&e.resetTrigger(i)})):n.Tools.Warn("Babylon.js cannot locate owner animation state machine info metadata for: "+e.entity.name)),null!=e._machine.layers&&e._machine.layers.length>0&&(e._machine.layers.sort(function(n,t){return n.index<t.index?-1:n.index>t.index?1:0}),e._machine.layers.forEach(function(t){t.animationNormalize=n.AnimationState.TIMER;t.animationReference=n.AnimationState.TIMER*e._fps;t.animationBlendMatrix=n.Matrix.Zero()})),(e._targets=e.manager.getAnimationTargets(e.entity),e._skeletal===!0)&&(o=e.getTargetSkeletons(),null!=o&&o.length>0&&o.forEach(function(n){var i=n,t;(null==i.metadata&&(i.metadata={}),i.metadata.resetBlending=!1,null!=n.bones&&n.bones.length>0)&&(t=0,n.bones.forEach(function(n){null==n.metadata&&(n.metadata={});n.metadata.index=t;n.metadata.blendingFactor=0;n.metadata.originalBlendValue=null;null!=n.metadata.transformPath&&""!==n.metadata.transformPath&&null!=e._machine.layers&&e._machine.layers.length>0&&e._machine.layers.forEach(function(i){null!=i.avatarMask&&null!=i.avatarMask.transformPaths&&i.avatarMask.transformPaths.length>0&&e.checkBoneTransformPath(i,n.metadata.transformPath)&&(null==i.avatarMask.transformIndexs&&(i.avatarMask.transformIndexs=[]),i.avatarMask.transformIndexs.push(t))});t++}))})),e}return __extends(i,t),Object.defineProperty(i.prototype,"fps",{get:function(){return this._fps},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"legacy",{get:function(){return this._legacy},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skeletal",{get:function(){return this._skeletal},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"executing",{get:function(){return this._executed},enumerable:!0,configurable:!0}),i.prototype.start=function(){this.startStateMachine()},i.prototype.update=function(){this.autoTicking===!0&&this.updateStateMachine()},i.prototype.destroy=function(){this._targets=null;this._machine=null;this._checkers=null;this._boneAnim=null;this._boneWeight=0;this._boneMatrix=null;this._inputPosition=null;this._childPosition=null;this._onAnimationFrameHandler=null;this._onAnimationEventHandlers=null;this._onAnimationBehaveHandlers=null;null!=this.entity.metadata&&null!=this.entity.metadata.state&&(this.entity.metadata.state=null)},i.prototype.play=function(t,i,r){void 0===i&&(i=0);void 0===r&&(r=0);this.enabled===!0&&null!=this._machine.layers&&this._machine.layers.length>r&&this.setCurrentAnimationState(this._machine.layers[r],t,n.Utilities.ComputeBlendingSpeed(this._fps,i))},i.prototype.getBool=function(n){var t=!1;return null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.booleans&&null!=this.entity.metadata.state.booleans[n]&&(t=this.entity.metadata.state.booleans[n]),t},i.prototype.setBool=function(n,t){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.booleans&&(this.entity.metadata.state.booleans[n]=t)},i.prototype.getFloat=function(n){var t=0;return null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.floats&&null!=this.entity.metadata.state.floats[n]&&(t=this.entity.metadata.state.floats[n]),t},i.prototype.setFloat=function(n,t){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.floats&&(this.entity.metadata.state.floats[n]=t)},i.prototype.getInteger=function(n){var t=0;return null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.floats&&null!=this.entity.metadata.state.floats[n]&&(t=this.entity.metadata.state.floats[n]),t},i.prototype.setInteger=function(n,t){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.floats&&(this.entity.metadata.state.floats[n]=t)},i.prototype.getTrigger=function(n){var t=!1;return null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.triggers&&null!=this.entity.metadata.state.triggers[n]&&(t=this.entity.metadata.state.triggers[n]),t},i.prototype.setTrigger=function(n){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.triggers&&(this.entity.metadata.state.triggers[n]=!0)},i.prototype.resetTrigger=function(n){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.triggers&&(this.entity.metadata.state.triggers[n]=!1)},i.prototype.tickStateMachine=function(){this.autoTicking===!1?this.updateStateMachine():n.Tools.Warn("Manual tick request ignored. Auto ticking is enabled for animator: "+this.entity.name)},i.prototype.getCurrentState=function(n){return null!=this._machine.layers&&this._machine.layers.length>n?this._machine.layers[n].animationStateMachine:null},i.prototype.getTargetSkeletons=function(){var t=null;return this._skeletal===!0&&null!=this._targets&&this._targets.length>0&&this._targets.forEach(function(i){if(i instanceof n.AbstractMesh){var r=i;null!=r.skeleton&&(null==t&&(t=[]),t.push(r.skeleton))}}),t},i.prototype.onAnimationBehaviour=function(n,t){null!=n&&""!==n&&(this._onAnimationBehaveHandlers[n.toLowerCase()]=t)},i.prototype.onAnimationTrackEvent=function(n,t){null!=n&&""!==n&&(this._onAnimationEventHandlers[n.toLowerCase()]=t)},i.prototype.onAnimationFrameUpdate=function(n){this._onAnimationFrameHandler=n},i.prototype.getMachineState=function(n){var t=null;return null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.data&&null!=this.entity.metadata.state.data[n]&&(t=this.entity.metadata.state.data[n]),t},i.prototype.setMachineState=function(n,t){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.data&&(this.entity.metadata.state.data[n]=t)},i.prototype.getAnimationClip=function(n){var t=null;return null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.clips&&null!=this.entity.metadata.state.clips[n]&&(t=this.entity.metadata.state.clips[n]),t},i.prototype.setAnimationClip=function(n,t){null!=this.entity.metadata&&null!=this.entity.metadata.state&&null!=this.entity.metadata.state.clips&&(this.entity.metadata.state.clips[n]=t)},i.prototype.getDenormalizedFrame=function(n,t){return null==n?0:n.start+(n.stop-n.start)*t},i.prototype.getAnimationFrames=function(n){return null==n?0:n.stop-n.start+1},i.prototype.setTreeBranches=function(t){var i=this;null!=t&&null!=t.children&&t.children.length>0&&t.children.forEach(function(t){t.type===n.MotionType.Tree?i.setTreeBranches(t.subtree):t.type===n.MotionType.Clip&&null!=t.motion&&""!==t.motion&&(t.track=i.getAnimationClip(t.motion))})},i.prototype.blendBoneMatrix=function(t,i){if(void 0===i&&(i=1),null!=t&&i>0&&null!=this._boneMatrix){var r=n.Scalar.Clamp(i,0,1);0===this._boneWeight?this._boneMatrix.copyFrom(t):n.Utilities.FastMatrixSlerp(this._boneMatrix,t,r,this._boneMatrix);this._boneWeight+=r}},i.prototype.updateBoneMatrix=function(t,i,r){void 0===i&&(i=!1);void 0===r&&(r=0);null!=this._boneMatrix&&null!=t&&(i===!0&&r>0&&null!=t.metadata&&(t.metadata.blendingFactor<=1&&null==t.metadata.originalBlendValue&&(t.metadata.originalBlendValue=t._matrix.clone()),t.metadata.blendingFactor<=1&&null!=t.metadata.originalBlendValue&&(n.Utilities.FastMatrixSlerp(t.metadata.originalBlendValue,this._boneMatrix,t.metadata.blendingFactor,this._boneMatrix),t.metadata.blendingFactor+=r)),t._matrix.copyFrom(this._boneMatrix),t.markAsDirty())},i.prototype.startStateMachine=function(){var n=this,t=this.manager.getAnimationClips(this.entity);null!=t&&t.length>0&&t.forEach(function(t){null!=t&&null!=t.name&&n.setAnimationClip(t.name,t)});null!=this._machine&&null!=this._machine.states&&this._machine.states.length>0&&this._machine.states.forEach(function(t){null!=t&&null!=t.name&&(n.setTreeBranches(t.blendtree),n.setMachineState(t.name,t))});this._executed===!1&&(this._executed=!0,this.enabled===!0&&this._autoplay===!0&&(this._legacy===!0?this.manager.playAnimationClip(null,this.entity):null!=this._machine.layers&&this._machine.layers.length>0&&(1==this._skeletal?this._machine.layers.forEach(function(t){n.setCurrentAnimationState(t,t.entry,0)}):this.setCurrentAnimationState(this._machine.layers[0],this._machine.layers[0].entry,0))))},i.prototype.updateStateMachine=function(){var t=this,n;this.enabled===!0&&(this.updateAnimationCurves(),n=this.manager.deltaTime,null!=this._machine.layers&&this._machine.layers.length>0&&(1==this._skeletal?this._machine.layers.forEach(function(i){null!=i&&t.processStateMachine(i,n)}):null!=this._machine.layers[0]&&this.processStateMachine(this._machine.layers[0],n)),this.updateAnimationTargets(),null!=this._onAnimationFrameHandler&&this._onAnimationFrameHandler())},i.prototype.updateAnimationCurves=function(){},i.prototype.updateAnimationTargets=function(){var t=this;this._skeletal===!0&&null!=this._targets&&this._targets.length>0&&this._targets.forEach(function(i){var r,u,f;null!=i&&i instanceof n.AbstractMesh&&(r=i,null!=r&&null!=r.skeleton&&null!=r.skeleton.bones&&r.skeleton.bones.length>0&&(u=r.skeleton,f=null!=u.metadata&&u.metadata.resetBlending,r.skeleton.bones.forEach(function(i){var e,o,u;if(t._boneAnim=null,t._boneWeight=0,t._boneMatrix.reset(),f===!0&&(null==i.metadata&&(i.metadata={}),i.metadata.blendingFactor=0,i.metadata.originalBlendValue=null),null!=i.animations&&i.animations.length>0){for(e=0;e<i.animations.length;e++)if(o=i.animations[e],"skeleton:"===o.name.substr(0,9)&&o.dataType===n.Animation.ANIMATIONTYPE_MATRIX){t._boneAnim=o;break}null!=t._boneAnim&&(u=r.skeleton.animationPropertiesOverride?r.skeleton.animationPropertiesOverride.blendingSpeed:t._boneAnim.blendingSpeed,null!=t._machine.layers&&t._machine.layers.length>0&&t._machine.layers.forEach(function(r){null!=r.animationStateMachine&&(r.animationBlendWeight=0,r.animationBlendMatrix.reset(),(0===r.index||r.defaultWeight>0)&&(0===r.index||null==r.avatarMask||null==r.avatarMask.transformIndexs||t.filterBoneTransformIndex(r,i))&&(r.animationStateMachine.type===n.MotionType.Tree||r.animationStateMachine.type===n.MotionType.Clip&&r.animationBlendFrame>=0&&(r.animationBlendFirst||r.animationBlendLoop<2))&&null!=r.animationBlendBuffer&&r.animationBlendBuffer.length>0&&r.animationBlendBuffer.forEach(function(i){null!=i.track&&(t._sampleMatrix.reset(),n.Utilities.SampleAnimationMatrix(t._boneAnim,i.frame,n.Scalar.Clamp(i.track.behavior,0,1),t._sampleMatrix),i.mirror===!0,t.blendAnimationMatrix(r,t._sampleMatrix,i.weight))}),r.animationBlendWeight>0&&(r.animationBlendSpeed>u&&(u=r.animationBlendSpeed),t.blendBoneMatrix(r.animationBlendMatrix,0===r.index?1:r.defaultWeight)))}),t._boneWeight>0&&t.updateBoneMatrix(i,u>0,u))}}),null==u.metadata&&(u.metadata={}),u.metadata.resetBlending=!1))})},i.prototype.processStateMachine=function(t,i){var r=this;t.animationTime+=i*t.animationRatio*this.speedRatio*n.Statics.SpeedCompensator;t.animationTime>t.animationNormalize&&(t.animationTime=0);t.animationFrame=n.Scalar.Normalize(t.animationTime,0,t.animationNormalize);t.animationBlendLoop=-1;t.animationBlendFrame=-1;t.animationBlendFirst=!1;t.animationBlendBuffer=null;this._checkers.result=null;this._checkers.offest=0;this._checkers.blending=0;this._checkers.triggered=[];null!=t.animationStateMachine&&(this.checkStateTransitions(t,t.animationStateMachine.transitions,t.animationStateMachine.time,t.animationStateMachine.length,t.animationStateMachine.rate),null==this._checkers.result&&null!=this._machine.transitions&&this.checkStateTransitions(t,this._machine.transitions,t.animationStateMachine.time,t.animationStateMachine.length,t.animationStateMachine.rate));null!=this._checkers.triggered&&this._checkers.triggered.length>0&&(this._checkers.triggered.forEach(function(n){r.resetTrigger(n)}),this._checkers.triggered=null);null!=this._checkers.result&&(this._checkers.offest>0?this.manager.delay(function(){r.setCurrentAnimationState(t,r._checkers.result,r._checkers.blending)},1e3*this._checkers.offest):this.setCurrentAnimationState(t,this._checkers.result,this._checkers.blending));this.parseSkeletalAnimationTrackLayer(t);this.parseAnimationStateMachineEvents(t)},i.prototype.parseAnimationStateMachineEvents=function(){},i.prototype.setCurrentAnimationState=function(t,i,r){if(null!=i&&""!==i&&i!==n.AnimationState.EXIT&&(null==t.animationStateMachine||t.animationStateMachine.name!==i)){var u=this.getMachineState(i);null!=u&&u.layerIndex===t.index&&(u.time=0,u.played=0,u.interrupted=!1,t.animationTime=0,t.animationFrame=0,t.animationRatio=1,t.animationAnimatables=null,t.animationBlendLoop=-1,t.animationBlendFrame=-1,t.animationBlendFirst=!1,t.animationBlendSpeed=r,t.animationBlendWeight=0,t.animationBlendBuffer=null,t.animationStateMachine=u,t.animationStateMachine.time=this.manager.time,t.animationAnimatables=this.setupBaseAnimationState(t,r,t.animationStateMachine.speed))}},i.prototype.setupBaseAnimationState=function(n,t,i){var r=this,u;return void 0===t&&(t=0),void 0===i&&(i=1),u=null,0===n.index&&null!=this._targets&&this._targets.length>0&&this._targets.forEach(function(f){var e,o;null!=f&&(r._skeletal===!0?(null!=f.skeleton&&(null==f.skeleton.metadata&&(f.skeleton.metadata={}),f.skeleton.metadata.resetBlending=!0),r.scene.stopAnimation(f),r.manager.setAnimationProperties(f,1,t)):(r.scene.stopAnimation(f),e=n.animationStateMachine&&null!=n.animationStateMachine.blendtree&&null!=n.animationStateMachine.blendtree.children&&n.animationStateMachine.blendtree.children.length>0?n.animationStateMachine.blendtree.children[0].track:null,null!=e&&(r.manager.setAnimationProperties(f,e.behavior,t),o=r.scene.beginAnimation(f,e.start,e.stop,e.behavior<2,i),null!=o&&(null==u&&(u=[]),u.push(o)))))}),u},i.prototype.checkStateTransitions=function(t,i,r,u,f){var o=this,e,h,c,s,l;if(this.enableTransitions===!0&&null!=i&&i.length>0){for(e=0,h=-1,e=0;e<i.length;e++)if(i[e].solo===!0&&i[e].mute===!1){h=e;break}for(c=function(){var c=i[e],l,y;if(c.layerIndex!==t.index||c.mute===!0||h>=0&&h!==e)return"continue";var a=!1,p=n.Scalar.Denormalize(c.exitTime,0,u),v=s.manager.time-r>=p;if(c.hasExitTime===!0&&c.intSource==n.InterruptionSource.None&&v===!1)return"continue";if(null!=c.conditions&&c.conditions.length>0?(l=0,y=c.conditions.length,c.conditions.forEach(function(t){var i,r,u,f;null!=o.entity.metadata.state.parameters[t.parameter]&&(i=o.entity.metadata.state.parameters[t.parameter],i==n.AnimatorParameterType.Float||i==n.AnimatorParameterType.Int?(r=parseFloat(o.getFloat(t.parameter).toFixed(2)),t.mode===n.ConditionMode.Greater&&r>t.threshold?l++:t.mode===n.ConditionMode.Less&&r<t.threshold?l++:t.mode===n.ConditionMode.Equals&&r===t.threshold?l++:t.mode===n.ConditionMode.NotEqual&&r!==t.threshold&&l++):i==n.AnimatorParameterType.Bool?(u=o.getBool(t.parameter),t.mode===n.ConditionMode.If&&u===!0?l++:t.mode===n.ConditionMode.IfNot&&u===!1&&l++):i==n.AnimatorParameterType.Trigger&&(f=o.getTrigger(t.parameter),f===!0&&(l++,o._checkers.triggered.indexOf(t.parameter)<0&&o._checkers.triggered.push(t.parameter))))}),a=c.hasExitTime===!0?v===!0&&l===y:l===y):a=c.hasExitTime===!0&&v===!0,a===!0){var w=c.isExit===!1?c.destination:n.AnimationState.EXIT,b=n.Scalar.Denormalize(c.offset,0,u),k=n.Scalar.Denormalize(c.duration,0,u),d=n.Utilities.ComputeBlendingSpeed(f,k);return s._checkers.result=w,s._checkers.offest=b,s._checkers.blending=d,"break"}},s=this,e=0;e<i.length;e++)if(l=c(),"break"===l)break}},i.prototype.computeSpeedRatio=function(t,i,r,u,f){var e,o,s;return void 0===r&&(r=null),void 0===u&&(u=1),void 0===f&&(f=1),e=1,null!=i&&null!=r?(o=t.animationReference/this.getAnimationFrames(i),s=t.animationReference/this.getAnimationFrames(r),e=n.Scalar.Lerp(o,s,u)):null!=i&&null==r?e=t.animationReference/this.getAnimationFrames(i):null!=r&&null==i&&(e=t.animationReference/this.getAnimationFrames(r)),e*f},i.prototype.blendAnimationMatrix=function(t,i,r){if(void 0===r&&(r=1),null!=i&&r>0&&null!=t.animationBlendMatrix){var u=n.Scalar.Clamp(r,0,1);0===t.animationBlendWeight?t.animationBlendMatrix.copyFrom(i):n.Utilities.FastMatrixSlerp(t.animationBlendMatrix,i,u,t.animationBlendMatrix);t.animationBlendWeight+=u}},i.prototype.checkBoneTransformPath=function(n,t){var i=!1;return null!=n.avatarMask&&null!=n.avatarMask.transformPaths&&n.avatarMask.transformPaths.length>0&&n.avatarMask.transformPaths.indexOf(t)>=0&&(i=!0),i},i.prototype.filterBoneTransformIndex=function(n,t){var i=!1;return null!=n.avatarMask&&null!=n.avatarMask.transformIndexs&&n.avatarMask.transformIndexs.length>0&&null!=t.metadata&&null!=t.metadata.index&&n.avatarMask.transformIndexs.indexOf(t.metadata.index)>=0&&(i=!0),i},i.prototype.sortBlendingBuffer=function(n){null!=n.animationBlendBuffer&&n.animationBlendBuffer.length>0&&n.animationBlendBuffer.sort(function(n,t){return n.weight<t.weight?1:n.weight>t.weight?-1:0})},i.prototype.resetTreeBranches=function(t,i){var r=this;i.directBlendMaster=null;i.simpleThresholdEqual=null;i.simpleThresholdLower=null;i.simpleThresholdUpper=null;i.simpleThresholdDelta=1;i.valueParameterX=parseFloat(this.getFloat(i.blendParameterX).toFixed(2));i.valueParameterY=parseFloat(this.getFloat(i.blendParameterY).toFixed(2));null!=i.children&&i.children.length>0&&(i.children.forEach(function(u){u.input=-1;u.frame=-1;u.weight=-1;u.indexs=null!=t.avatarMask&&null!=t.avatarMask.transformIndexs&&t.avatarMask.transformIndexs.length>0?t.avatarMask.transformIndexs:null;r.resetInputDistanceWeight(i,u);u.type===n.MotionType.Tree&&r.resetTreeBranches(t,u.subtree)}),this.resetInputDistanceThreasholds(i))},i.prototype.resetInputDistanceWeight=function(t,i){switch(this._childPosition.x=i.positionX,this._childPosition.y=i.positionY,this._inputPosition.x=t.valueParameterX,this._inputPosition.y=t.valueParameterY,t.blendType){case n.BlendTreeType.Simple1D:null==t.simpleThresholdEqual&&(t.valueParameterX===i.threshold?(t.simpleThresholdEqual=i,t.simpleThresholdLower=null,t.simpleThresholdUpper=null):t.valueParameterX>i.threshold?null==t.simpleThresholdLower?t.simpleThresholdLower=i:i.threshold>t.simpleThresholdLower.threshold&&(t.simpleThresholdLower=i):t.valueParameterX<i.threshold&&(null==t.simpleThresholdUpper?t.simpleThresholdUpper=i:i.threshold<t.simpleThresholdUpper.threshold&&(t.simpleThresholdUpper=i)));break;case n.BlendTreeType.SimpleDirectional2D:i.input=this.computeSimpleDirectionalWeight(t,this._inputPosition,this._childPosition);break;case n.BlendTreeType.FreeformDirectional2D:i.input=this.computeFreeformDirectionalWeight(t,this._inputPosition,this._childPosition);break;case n.BlendTreeType.FreeformCartesian2D:i.input=this.computeFreeformCartesianWeight(t,this._inputPosition,this._childPosition)}},i.prototype.resetInputDistanceThreasholds=function(t){t.blendType===n.BlendTreeType.Simple1D&&(null==t.simpleThresholdEqual&&(null!=t.simpleThresholdLower&&null==t.simpleThresholdUpper?(t.simpleThresholdEqual=t.simpleThresholdLower,t.simpleThresholdLower=null,t.simpleThresholdUpper=null):null!=t.simpleThresholdUpper&&null==t.simpleThresholdLower&&(t.simpleThresholdEqual=t.simpleThresholdUpper,t.simpleThresholdLower=null,t.simpleThresholdUpper=null)),t.simpleThresholdDelta=null!=t.simpleThresholdLower&&null!=t.simpleThresholdUpper?parseFloat(n.Scalar.Normalize(t.valueParameterX,t.simpleThresholdLower.threshold,t.simpleThresholdUpper.threshold).toFixed(2)):1)},i.prototype.parseTreeBranches=function(t,i,r){var u=this;null!=i&&null!=i.children&&i.children.length>0&&i.children.forEach(function(f){switch(i.blendType){case n.BlendTreeType.Clip:u.parseClipTreeItem(t,i,f,r);break;case n.BlendTreeType.Direct:u.parseDirectTreeItem(t,i,f,r);break;case n.BlendTreeType.Simple1D:u.parseSimpleTreeItem(t,i,f,r);break;case n.BlendTreeType.SimpleDirectional2D:u.parseSimpleDirectionalTreeItem(t,i,f,r);break;case n.BlendTreeType.FreeformDirectional2D:u.parseFreeformDirectionalTreeItem(t,i,f,r);break;case n.BlendTreeType.FreeformCartesian2D:u.parseFreeformCartesianTreeItem(t,i,f,r)}f.weight>0&&(null==t.animationBlendBuffer&&(t.animationBlendBuffer=[]),t.animationBlendBuffer.push(f))})},i.prototype.parseClipTreeItem=function(n,t,i){null!=i&&null!=t&&null!=i.track&&null!=n.animationStateMachine&&(n.animationBlendLoop=i.track.behavior,n.animationBlendFirst=n.animationStateMachine.played!==-1&&n.animationStateMachine.played<=i.track.frames,n.animationBlendFirst===!1&&n.animationStateMachine.played!==-1&&(n.animationStateMachine.played=-1),n.animationBlendFrame=this.getDenormalizedFrame(i.track,n.animationFrame),i.frame=n.animationBlendFrame,i.weight=1)},i.prototype.parseDirectTreeItem=function(t,i,r,u){null!=r&&null!=i&&(r.type===n.MotionType.Tree?this.parseTreeBranches(t,r.subtree,u):r.type===n.MotionType.Clip&&null!=r.track&&null!=t.animationStateMachine&&(r.frame=this.getDenormalizedFrame(r.track,u),r.weight=this.getFloat(r.directBlendParameter),(null==i.directBlendMaster||r.weight>i.directBlendMaster.weight)&&(i.directBlendMaster=r)))},i.prototype.parseSimpleTreeItem=function(t,i,r,u){null!=r&&null!=i&&(null!=i.simpleThresholdEqual&&r.threshold===i.simpleThresholdEqual.threshold?r.type===n.MotionType.Tree?this.parseTreeBranches(t,r.subtree,u):r.type===n.MotionType.Clip&&null!=r.track&&null!=t.animationStateMachine&&(r.frame=this.getDenormalizedFrame(r.track,u),r.weight=1):null!=i.simpleThresholdLower&&null!=i.simpleThresholdUpper&&r.threshold>=i.simpleThresholdLower.threshold&&r.threshold<=i.simpleThresholdUpper.threshold&&(r.type===n.MotionType.Tree?this.parseTreeBranches(t,r.subtree,u):r.type===n.MotionType.Clip&&null!=r.track&&null!=t.animationStateMachine&&(r.frame=this.getDenormalizedFrame(r.track,u),r.weight=1)))},i.prototype.parseSimpleDirectionalTreeItem=function(t,i,r,u){null!=r&&null!=i&&(r.type===n.MotionType.Tree?this.parseTreeBranches(t,r.subtree,u):r.type===n.MotionType.Clip&&null!=r.track&&null!=t.animationStateMachine&&(r.frame=this.getDenormalizedFrame(r.track,u),r.weight=0))},i.prototype.parseFreeformDirectionalTreeItem=function(t,i,r,u){null!=r&&null!=i&&(r.type===n.MotionType.Tree?this.parseTreeBranches(t,r.subtree,u):r.type===n.MotionType.Clip&&null!=r.track&&null!=t.animationStateMachine&&(r.frame=this.getDenormalizedFrame(r.track,u),r.weight=0))},i.prototype.parseFreeformCartesianTreeItem=function(t,i,r,u){null!=r&&null!=i&&(r.type===n.MotionType.Tree?this.parseTreeBranches(t,r.subtree,u):r.type===n.MotionType.Clip&&null!=r.track&&null!=t.animationStateMachine&&(r.frame=this.getDenormalizedFrame(r.track,u),r.weight=0))},i.prototype.parseSkeletalAnimationTrackLayer=function(t){if(this._skeletal===!0&&null!=t.animationStateMachine&&null!=t.animationStateMachine.blendtree&&(t.animationStateMachine.type===n.MotionType.Clip&&t.animationStateMachine.played!==-1&&(t.animationStateMachine.played+=this.manager.deltaTime*this._fps),this.resetTreeBranches(t,t.animationStateMachine.blendtree),this.parseTreeBranches(t,t.animationStateMachine.blendtree,t.animationFrame),null!=t.animationBlendBuffer&&t.animationBlendBuffer.length>0))if(t.animationStateMachine.type===n.MotionType.Clip)t.animationRatio=this.computeSpeedRatio(t,t.animationBlendBuffer[0].track,null,1,t.animationStateMachine.speed);else if(t.animationStateMachine.type===n.MotionType.Tree)switch(t.animationStateMachine.blendtree.blendType){case n.BlendTreeType.Direct:this.sortBlendingBuffer(t);null!=t.animationStateMachine.blendtree.directBlendMaster&&(t.animationRatio=this.computeSpeedRatio(t,t.animationStateMachine.blendtree.directBlendMaster.track,null,1,t.animationStateMachine.blendtree.directBlendMaster.timescale)*this.directBlendSpeed);break;case n.BlendTreeType.Simple1D:1===t.animationBlendBuffer.length?t.animationRatio=this.computeSpeedRatio(t,t.animationBlendBuffer[0].track,null,1,t.animationBlendBuffer[0].timescale):(t.animationBlendBuffer[0].weight=1,t.animationBlendBuffer[1].weight=t.animationStateMachine.blendtree.simpleThresholdDelta,t.animationRatio=this.computeSpeedRatio(t,t.animationBlendBuffer[0].track,t.animationBlendBuffer[1].track,t.animationStateMachine.blendtree.simpleThresholdDelta,t.animationBlendBuffer[1].timescale));break;case n.BlendTreeType.SimpleDirectional2D:this.sortBlendingBuffer(t);break;case n.BlendTreeType.FreeformDirectional2D:this.sortBlendingBuffer(t);break;case n.BlendTreeType.FreeformCartesian2D:this.sortBlendingBuffer(t)}},i.prototype.computeSimpleDirectionalWeight=function(n,t,i){return t.subtract(i).lengthSquared(),0},i.prototype.computeFreeformDirectionalWeight=function(n,t,i){return t.subtract(i).lengthSquared(),0},i.prototype.computeFreeformCartesianWeight=function(n,t,i){return t.subtract(i).lengthSquared(),0},i.EXIT="[EXIT]",i.TIMER=3,i}(n.SceneComponent);n.AnimationState=t}(BABYLON||(BABYLON={}));!function(n){var t=function(){function t(){}return t.Angle=function(t,i){return 57.29578*Math.acos(n.Scalar.Clamp(n.Vector3.Dot(t.normalize(),i.normalize()),-1,1))},t.ClampAngle=function(t,i,r){var u=t;do u<-360&&(u+=360),u>360&&(u-=360);while(u<-360||u>360);return n.Scalar.Clamp(u,i,r)},t.Deg2Rad=function(t){return t*n.Statics.Deg2Rad},t.Rad2Deg=function(t){return t*n.Statics.Rad2Deg},t.Euler=function(t,i,r){return n.Quaternion.RotationYawPitchRoll(i,t,r)},t.EulerToRef=function(t,i,r,u){n.Quaternion.RotationYawPitchRollToRef(i,t,r,u)},t.Matrix=function(t,i,r){return n.Matrix.RotationYawPitchRoll(i,t,r)},t.MatrixToRef=function(t,i,r,u){n.Matrix.RotationYawPitchRollToRef(i,t,r,u)},t.RotateVector=function(t,i){var r=2*(i.y*t.z-i.z*t.y),u=2*(i.z*t.x-i.x*t.z),f=2*(i.x*t.y-i.y*t.x);return new n.Vector3(t.x+i.w*r+(i.y*f-i.z*u),t.y+i.w*u+(i.z*r-i.x*f),t.z+i.w*f+(i.x*u-i.y*r))},t.RotateVectorToRef=function(n,t,i){var r=2*(t.y*n.z-t.z*n.y),u=2*(t.z*n.x-t.x*n.z),f=2*(t.x*n.y-t.y*n.x);i.x=n.x+t.w*r+(t.y*f-t.z*u);i.y=n.y+t.w*u+(t.z*r-t.x*f);i.z=n.z+t.w*f+(t.x*u-t.y*r)},t.LookRotation=function(t){var i=n.Quaternion.Zero();return n.Utilities.LookRotationToRef(t,i),i},t.LookRotationToRef=function(t,i){n.Utilities.TempMatrix.reset();n.Matrix.LookAtLHToRef(n.Utilities.ZeroVector,t,n.Utilities.UpVector,n.Utilities.TempMatrix);n.Utilities.TempMatrix.invert();n.Quaternion.FromRotationMatrixToRef(n.Utilities.TempMatrix,i)},t.ResetPhysicsPosition=function(t,i){var r=i;r.position&&t.addInPlace(r.position);null!=r.parent&&n.Utilities.ResetPhysicsPosition(t,r.parent)},t.PrintToScreen=function(t,i){if(void 0===i&&(i="white"),n.Utilities.PrintElement=document.getElementById("print"),null==n.Utilities.PrintElement){var r=document.createElement("div");r.id="print";r.style.position="absolute";r.style.left="6px";r.style.bottom="3px";r.style.fontSize="12px";r.style.zIndex="10000";r.style.color="#0c0";document.body.appendChild(r);n.Utilities.PrintElement=r}null!=n.Utilities.PrintElement&&n.Utilities.PrintElement.innerHTML!==t&&(n.Utilities.PrintElement.style.color!==i&&(n.Utilities.PrintElement.style.color=i),n.Utilities.PrintElement.innerHTML=t)},t.TransformPosition=function(t,i){return n.Vector3.TransformCoordinates(i,t.getWorldMatrix())},t.TransformPositionToRef=function(t,i,r){return n.Vector3.TransformCoordinatesToRef(i,t.getWorldMatrix(),r)},t.TransformDirection=function(t,i){return n.Vector3.TransformNormal(i,t.getWorldMatrix())},t.TransformDirectionToRef=function(t,i,r){return n.Vector3.TransformNormalToRef(i,t.getWorldMatrix(),r)},t.RecomputePivotPoint=function(t){var i=t.getBoundingInfo().boundingSphere.center;t.setPivotMatrix(n.Matrix.Translation(-i.x,-i.y,-i.z))},t.GetDirectionVector=function(n,t){return n.getDirection(t)},t.GetDirectionVectorToRef=function(n,t,i){n.getDirectionToRef(t,i)},t.GetForwardVector=function(t){return t.getDirection(n.Vector3.Forward())},t.GetForwardVectorToRef=function(t,i){t.getDirectionToRef(n.Vector3.Forward(),i)},t.GetRightVector=function(t){return t.getDirection(n.Vector3.Right())},t.GetRightVectorToRef=function(t,i){t.getDirectionToRef(n.Vector3.Right(),i)},t.GetUpVector=function(t){return t.getDirection(n.Vector3.Up())},t.GetUpVectorToRef=function(t,i){t.getDirectionToRef(n.Vector3.Up(),i)},t.ParseColor3=function(t,i){void 0===i&&(i=null);return null!=t&&null!=t.r&&null!=t.g&&null!=t.b?new n.Color3(t.r,t.g,t.b):i},t.ParseColor4=function(t,i){void 0===i&&(i=null);return null!=t&&null!=t.r&&null!=t.g&&null!=t.b&&null!=t.a?new n.Color4(t.r,t.g,t.b,t.a):i},t.ParseVector2=function(t,i){void 0===i&&(i=null);return null!=t&&null!=t.x&&null!=t.y?new n.Vector2(t.x,t.y):i},t.ParseVector3=function(t,i){void 0===i&&(i=null);return null!=t&&null!=t.x&&null!=t.y&&null!=t.z?new n.Vector3(t.x,t.y,t.z):i},t.ParseVector4=function(t,i){void 0===i&&(i=null);return null!=t&&null!=t.x&&null!=t.y&&null!=t.z&&null!=t.w?new n.Vector4(t.x,t.y,t.z,t.w):i},t.ParseTransform=function(n,t){return void 0===t&&(t=null),null},t.StartsWith=function(n,t){return 0===n.lastIndexOf(t,0)},t.EndsWith=function(n,t){return n.indexOf(t,n.length-t.length)!==-1},t.ReplaceAll=function(n,t,i){return n.replace(new RegExp(t,"g"),i)},t.SampleAnimationMatrix=function(t,i,r,u){if(null!=t&&t.dataType===n.Animation.ANIMATIONTYPE_MATRIX){var f=t.getKeys();i<f[0].frame?i=f[0].frame:i>f[f.length-1].frame&&(i=f[f.length-1].frame);n.Utilities.FastMatrixInterpolate(t,i,r,u)}},t.SampleAnimationFloat=function(t,i,r,u,f,e){var s,o;return void 0===f&&(f=null),void 0===e&&(e=null),s=0,null!=t&&t.dataType===n.Animation.ANIMATIONTYPE_FLOAT&&(o=t.getKeys(),i<o[0].frame?i=o[0].frame:i>o[o.length-1].frame&&(i=o[o.length-1].frame),s=n.Utilities.FastFloatInterpolate(t,i,r,u,f,e)),s},t.FastMatrixLerp=function(t,i,r,u){n.Matrix.LerpToRef(t,i,r,u)},t.FastMatrixSlerp=function(t,i,r,u){n.Matrix.DecomposeLerpToRef(t,i,r,u)},t.FastMatrixInterpolate=function(t,i,r,u){var f=t.getKeys(),o=Math.max(0,Math.min(f.length-1,Math.floor(f.length*(i-f[0].frame)/(f[f.length-1].frame-f[0].frame))-1)),s,h,e,c;if(f[o].frame>=i)for(;o-1>=0&&f[o].frame>=i;)o--;for(s=o;s<f.length;s++)if(h=f[s+1],h.frame>=i){if(e=f[s],c=e.value,e.interpolation===n.AnimationKeyInterpolation.STEP)return void u.copyFrom(c);var v=h.value,y=(void 0!==e.outTangent&&void 0!==h.inTangent,h.frame-e.frame),l=(i-e.frame)/y,a=t.getEasingFunction();switch(null!=a&&(l=a.ease(l)),r){case n.Animation.ANIMATIONLOOPMODE_CYCLE:case n.Animation.ANIMATIONLOOPMODE_CONSTANT:return void n.Utilities.FastMatrixSlerp(c,v,l,u);case n.Animation.ANIMATIONLOOPMODE_RELATIVE:return void u.copyFrom(c)}break}u.copyFrom(f[f.length-1].value)},t.FastFloatInterpolate=function(t,i,r,u,f,e){var o,h,l,c,s,a,p;if(void 0===f&&(f=null),void 0===e&&(e=null),u===n.Animation.ANIMATIONLOOPMODE_CONSTANT&&r>0)return e.clone?e.clone():e;if(o=t.getKeys(),h=Math.max(0,Math.min(o.length-1,Math.floor(o.length*(i-o[0].frame)/(o[o.length-1].frame-o[0].frame))-1)),o[h].frame>=i)for(;h-1>=0&&o[h].frame>=i;)h--;for(l=h;l<o.length;l++)if(c=o[l+1],c.frame>=i){if(s=o[l],a=s.value,s.interpolation===n.AnimationKeyInterpolation.STEP)return a;var w=c.value,k=void 0!==s.outTangent&&void 0!==c.inTangent,y=c.frame-s.frame,v=(i-s.frame)/y,b=t.getEasingFunction();null!=b&&(v=b.ease(v));p=k?t.floatInterpolateFunctionWithTangents(a,s.outTangent*y,w,c.inTangent*y,v):t.floatInterpolateFunction(a,w,v);switch(u){case n.Animation.ANIMATIONLOOPMODE_CYCLE:case n.Animation.ANIMATIONLOOPMODE_CONSTANT:return p;case n.Animation.ANIMATIONLOOPMODE_RELATIVE:return f*r+p}break}return o[o.length-1].value},t.ComputeBlendingSpeed=function(n,t){return 1/(n*t)},t.RegisterSceneComponent=function(t,i,r,u){var f,e,o;if(void 0===r&&(r=!0),void 0===u&&(u={}),f=t.entity,null==f)throw new Error("Null owner scene object attached");null!=f.metadata&&f.metadata.api||(e={api:!0,type:"Babylon",parsed:!1,prefab:!1,state:{},objectName:"Scene Component",objectId:"0",tagName:"Untagged",layerIndex:0,layerName:"Default",areaIndex:-1,navAgent:null,meshLink:null,meshObstacle:null,shadowCastingMode:0,socketList:[],animationClips:[],animationEvents:[],collisionEvent:null,components:[],properties:{}},f.metadata=e);null!=f.metadata&&f.metadata.api?(e=f.metadata,(null==e.components&&(e.components=[]),null!=e.components)?(o={order:1e3,name:"EditorScriptComponent",klass:i,update:r,properties:u,instance:t,tag:{}},e.components.push(o),t.register(),null!=t.ready?t.ready():n.Tools.Error("No component ready function detected.")):n.Tools.Error("Failed to parse metadata components")):n.Tools.Error("Null owner object metadata")},t.RegisterSceneManager=function(t){var i=t;return null!=i.manager&&(i.manager.dispose(),i.manager=null),i.manager=new n.SceneManager(t),i.manager},t.ParseSceneMetadata=function(t){var i=t;null!=i.manager?i.manager._parseSceneMetadata():n.Tools.Warn("Babylon.js no scene manager instance detected. Failed to parse scene metadata.")},t.ParseImportMetadata=function(t,i){var u=i,r;null!=u.manager?(r=(u.manager,[]),n.SceneManager.parseSceneMeshes(t,i,r),r.length>0&&(r.sort(function(n,t){return n.order<t.order?-1:n.order>t.order?1:0}),r.forEach(function(n){n.instance.register()}))):n.Tools.Warn("Babylon.js no scene manager instance detected. Failed to parse scene metadata.")},t.ExecuteSceneReady=function(t){var i=t;null!=i.manager?i.manager._executeWhenReady():n.Tools.Warn("Babylon.js no scene manager instance detected. Failed to execute scene ready.")},t.InstantiateClass=function(n){for(var r=n.split("."),t=window||this,i=0,u=r.length;i<u;i++)t=t[r[i]];return"function"==typeof t?t:null},t.UpVector=n.Vector3.Up(),t.ZeroVector=n.Vector3.Zero(),t.TempMatrix=n.Matrix.Zero(),t.TempVector2=n.Vector2.Zero(),t.TempVector3=n.Vector3.Zero(),t.PrintElement=null,t}();n.Utilities=t}(BABYLON||(BABYLON={}));__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var t=function(t){function i(n,i,r,u){void 0===r&&(r=!0);void 0===u&&(u={});var f=t.call(this,n,i,r,u)||this;return f.autoInput=!0,f.cameraInput=0,f.cameraSpeed=1,f.cameraMoveSpeed=1,f.cameraRotateSpeed=.005,f.movementKeys=!0,f.multiPlayerView=!1,f.multiPlayerStart=1,f.preventDefaultEvents=!0,f.playerOneCamera=null,f.playerTwoCamera=null,f.playerThreeCamera=null,f.playerFourCamera=null,f}return __extends(i,t),i.prototype.ready=function(){var i,t;(this.cameraInput=this.getProperty("cameraInput",0),this.cameraSpeed=this.getProperty("cameraSpeed",1),this.movementKeys=this.getProperty("movementKeys",!0),this.cameraMoveSpeed=this.getProperty("inputMoveSpeed",1),this.cameraRotateSpeed=this.getProperty("inputRotateSpeed",.005),this.preventDefaultEvents=this.getProperty("preventDefaultEvents",!0),this.multiPlayerStart=this.getProperty("multiPlayerStartup",1),this.multiPlayerView=n.SceneManager.IsMultiPlayerView(),this.cameraInput===n.UniversalCameraRig.AUTO_INPUT)?(this.playerOneCamera=this.manager.getMainCamera(n.PlayerNumber.One),this.multiPlayerView===!0&&(this.playerTwoCamera=this.manager.getMainCamera(n.PlayerNumber.Two),this.playerThreeCamera=this.manager.getMainCamera(n.PlayerNumber.Three),this.playerFourCamera=this.manager.getMainCamera(n.PlayerNumber.Four),this.multiPlayerStart>1&&this.manager.setMultiPlayerViewLayout(this.multiPlayerStart))):this.cameraInput===n.UniversalCameraRig.RENDER_CANVAS&&(i=this.manager.getMainCamera(n.PlayerNumber.One),(i.attachControl(this.engine.getRenderingCanvas(),this.preventDefaultEvents),i instanceof n.FreeCamera)&&(t=i,this.movementKeys===!0&&(t.keysUp.push("w".charCodeAt(0)),t.keysUp.push("W".charCodeAt(0)),t.keysDown.push("s".charCodeAt(0)),t.keysDown.push("S".charCodeAt(0)),t.keysRight.push("d".charCodeAt(0)),t.keysRight.push("D".charCodeAt(0)),t.keysLeft.push("a".charCodeAt(0)),t.keysLeft.push("A".charCodeAt(0)))))},i.prototype.update=function(){if(this.autoInput===!0&&this.cameraInput===n.UniversalCameraRig.AUTO_INPUT&&(null!=this.playerOneCamera&&this.manager.updateCameraInput(this.playerOneCamera,this.cameraMoveSpeed,this.cameraRotateSpeed,n.PlayerNumber.One),this.multiPlayerView===!0)){var t=n.SceneManager.GetMultiPlayerCount();t>=2&&null!=this.playerTwoCamera&&this.manager.updateCameraInput(this.playerTwoCamera,this.cameraMoveSpeed,this.cameraRotateSpeed,n.PlayerNumber.Two);t>=3&&null!=this.playerThreeCamera&&this.manager.updateCameraInput(this.playerThreeCamera,this.cameraMoveSpeed,this.cameraRotateSpeed,n.PlayerNumber.Three);t>=4&&null!=this.playerFourCamera&&this.manager.updateCameraInput(this.playerFourCamera,this.cameraMoveSpeed,this.cameraRotateSpeed,n.PlayerNumber.Four)}},i.prototype.destroy=function(){this.playerOneCamera=null;this.playerTwoCamera=null;this.playerThreeCamera=null;this.playerFourCamera=null},i.AUTO_INPUT=1,i.RENDER_CANVAS=2,i}(n.CameraComponent);n.UniversalCameraRig=t}(BABYLON||(BABYLON={}));__extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(n){var t=function(n){function t(t,i,r,u){return void 0===r&&(r=!0),void 0===u&&(u={}),n.call(this,t,i,r,u)||this}return __extends(t,n),t.prototype.ready=function(){},t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.after=function(){},t.prototype.destroy=function(){},t}(n.MeshComponent);n.ActionManagerComponent=t}(BABYLON||(BABYLON={}));window.terrain=!0;BABYLON.Effect.ShadersStore.splatmapVertexShader=window.atob("I2luY2x1ZGU8X19kZWNsX19kZWZhdWx0VmVydGV4Pg0KLy8gQXR0cmlidXRlcw0KYXR0cmlidXRlIHZlYzMgcG9zaXRpb247DQojaWZkZWYgTk9STUFMDQphdHRyaWJ1dGUgdmVjMyBub3JtYWw7DQojZW5kaWYNCiNpZmRlZiBUQU5HRU5UDQphdHRyaWJ1dGUgdmVjNCB0YW5nZW50Ow0KI2VuZGlmDQojaWZkZWYgVVYxDQphdHRyaWJ1dGUgdmVjMiB1djsNCiNlbmRpZg0KI2lmZGVmIFVWMg0KYXR0cmlidXRlIHZlYzIgdXYyOw0KI2VuZGlmDQojaWZkZWYgVkVSVEVYQ09MT1INCmF0dHJpYnV0ZSB2ZWM0IGNvbG9yOw0KI2VuZGlmDQoNCiNpbmNsdWRlPGJvbmVzRGVjbGFyYXRpb24+DQoNCi8vIFNwbGF0bWFwcw0KI2lmZGVmIHNwbGF0bWFwRGVmDQp2YXJ5aW5nIHZlYzIgc3BsYXRtYXBVVjsNCnVuaWZvcm0gdmVjMiBzcGxhdG1hcEluZm9zOw0KdW5pZm9ybSBtYXQ0IHNwbGF0bWFwTWF0cml4Ow0KI2VuZGlmDQojaWZkZWYgYXRsYXNUZXh0dXJlMURlZg0KdmFyeWluZyB2ZWMyIGF0bGFzVGV4dHVyZTFVVjsNCnVuaWZvcm0gdmVjMiBhdGxhc1RleHR1cmUxSW5mb3M7DQp1bmlmb3JtIG1hdDQgYXRsYXNUZXh0dXJlMU1hdHJpeDsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTJEZWYNCnZhcnlpbmcgdmVjMiBhdGxhc1RleHR1cmUyVVY7DQp1bmlmb3JtIHZlYzIgYXRsYXNUZXh0dXJlMkluZm9zOw0KdW5pZm9ybSBtYXQ0IGF0bGFzVGV4dHVyZTJNYXRyaXg7DQojZW5kaWYNCiNpZmRlZiBhdGxhc1RleHR1cmUzRGVmDQp2YXJ5aW5nIHZlYzIgYXRsYXNUZXh0dXJlM1VWOw0KdW5pZm9ybSB2ZWMyIGF0bGFzVGV4dHVyZTNJbmZvczsNCnVuaWZvcm0gbWF0NCBhdGxhc1RleHR1cmUzTWF0cml4Ow0KI2VuZGlmDQojaWZkZWYgYXRsYXNUZXh0dXJlNERlZg0KdmFyeWluZyB2ZWMyIGF0bGFzVGV4dHVyZTRVVjsNCnVuaWZvcm0gdmVjMiBhdGxhc1RleHR1cmU0SW5mb3M7DQp1bmlmb3JtIG1hdDQgYXRsYXNUZXh0dXJlNE1hdHJpeDsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTVEZWYNCnZhcnlpbmcgdmVjMiBhdGxhc1RleHR1cmU1VVY7DQp1bmlmb3JtIHZlYzIgYXRsYXNUZXh0dXJlNUluZm9zOw0KdW5pZm9ybSBtYXQ0IGF0bGFzVGV4dHVyZTVNYXRyaXg7DQojZW5kaWYNCiNpZmRlZiBidW1wVGV4dHVyZTFEZWYNCnZhcnlpbmcgdmVjMiBidW1wVGV4dHVyZTFVVjsNCnVuaWZvcm0gdmVjMiBidW1wVGV4dHVyZTFJbmZvczsNCnVuaWZvcm0gbWF0NCBidW1wVGV4dHVyZTFNYXRyaXg7DQojZW5kaWYNCiNpZmRlZiBidW1wVGV4dHVyZTJEZWYNCnZhcnlpbmcgdmVjMiBidW1wVGV4dHVyZTJVVjsNCnVuaWZvcm0gdmVjMiBidW1wVGV4dHVyZTJJbmZvczsNCnVuaWZvcm0gbWF0NCBidW1wVGV4dHVyZTJNYXRyaXg7DQojZW5kaWYNCiNpZmRlZiBidW1wVGV4dHVyZTNEZWYNCnZhcnlpbmcgdmVjMiBidW1wVGV4dHVyZTNVVjsNCnVuaWZvcm0gdmVjMiBidW1wVGV4dHVyZTNJbmZvczsNCnVuaWZvcm0gbWF0NCBidW1wVGV4dHVyZTNNYXRyaXg7DQojZW5kaWYNCiNpZmRlZiBidW1wVGV4dHVyZTREZWYNCnZhcnlpbmcgdmVjMiBidW1wVGV4dHVyZTRVVjsNCnVuaWZvcm0gdmVjMiBidW1wVGV4dHVyZTRJbmZvczsNCnVuaWZvcm0gbWF0NCBidW1wVGV4dHVyZTRNYXRyaXg7DQojZW5kaWYNCiNpZmRlZiBidW1wVGV4dHVyZTVEZWYNCnZhcnlpbmcgdmVjMiBidW1wVGV4dHVyZTVVVjsNCnVuaWZvcm0gdmVjMiBidW1wVGV4dHVyZTVJbmZvczsNCnVuaWZvcm0gbWF0NCBidW1wVGV4dHVyZTVNYXRyaXg7DQojZW5kaWYNCg0KLy8gVW5pZm9ybXMNCiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPg0KDQojaWZkZWYgTUFJTlVWMQ0KCXZhcnlpbmcgdmVjMiB2TWFpblVWMTsNCiNlbmRpZg0KDQojaWZkZWYgTUFJTlVWMg0KCXZhcnlpbmcgdmVjMiB2TWFpblVWMjsNCiNlbmRpZg0KDQojaWYgZGVmaW5lZChESUZGVVNFKSAmJiBESUZGVVNFRElSRUNUVVYgPT0gMA0KdmFyeWluZyB2ZWMyIHZEaWZmdXNlVVY7DQojZW5kaWYNCg0KI2lmIGRlZmluZWQoQU1CSUVOVCkgJiYgQU1CSUVOVERJUkVDVFVWID09IDANCnZhcnlpbmcgdmVjMiB2QW1iaWVudFVWOw0KI2VuZGlmDQoNCiNpZiBkZWZpbmVkKE9QQUNJVFkpICYmIE9QQUNJVFlESVJFQ1RVViA9PSAwDQp2YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjsNCiNlbmRpZg0KDQojaWYgZGVmaW5lZChFTUlTU0lWRSkgJiYgRU1JU1NJVkVESVJFQ1RVViA9PSAwDQp2YXJ5aW5nIHZlYzIgdkVtaXNzaXZlVVY7DQojZW5kaWYNCg0KI2lmIGRlZmluZWQoTElHSFRNQVApICYmIExJR0hUTUFQRElSRUNUVVYgPT0gMA0KdmFyeWluZyB2ZWMyIHZMaWdodG1hcFVWOw0KI2VuZGlmDQoNCiNpZiBkZWZpbmVkKFNQRUNVTEFSKSAmJiBkZWZpbmVkKFNQRUNVTEFSVEVSTSkgJiYgU1BFQ1VMQVJESVJFQ1RVViA9PSAwDQp2YXJ5aW5nIHZlYzIgdlNwZWN1bGFyVVY7DQojZW5kaWYNCg0KI2lmIGRlZmluZWQoQlVNUCkgJiYgQlVNUERJUkVDVFVWID09IDANCnZhcnlpbmcgdmVjMiB2QnVtcFVWOw0KI2VuZGlmDQoNCi8vIE91dHB1dA0KdmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7DQojaWZkZWYgTk9STUFMDQp2YXJ5aW5nIHZlYzMgdk5vcm1hbFc7DQojZW5kaWYNCg0KI2lmZGVmIFZFUlRFWENPTE9SDQp2YXJ5aW5nIHZlYzQgdkNvbG9yOw0KI2VuZGlmDQoNCiNpbmNsdWRlPGJ1bXBWZXJ0ZXhEZWNsYXJhdGlvbj4NCg0KI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4RGVjbGFyYXRpb24+DQoNCiNpbmNsdWRlPGZvZ1ZlcnRleERlY2xhcmF0aW9uPg0KI2luY2x1ZGU8X19kZWNsX19saWdodEZyYWdtZW50PlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdDQoNCiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbERlY2xhcmF0aW9uPg0KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10NCg0KI2lmZGVmIFJFRkxFQ1RJT05NQVBfU0tZQk9YDQp2YXJ5aW5nIHZlYzMgdlBvc2l0aW9uVVZXOw0KI2VuZGlmDQoNCiNpZiBkZWZpbmVkKFJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKSB8fCBkZWZpbmVkKFJFRkxFQ1RJT05NQVBfTUlSUk9SRURFUVVJUkVDVEFOR1VMQVJfRklYRUQpDQp2YXJ5aW5nIHZlYzMgdkRpcmVjdGlvblc7DQojZW5kaWYNCg0KI2luY2x1ZGU8bG9nRGVwdGhEZWNsYXJhdGlvbj4NCg0Kdm9pZCBtYWluKHZvaWQpIHsNCgl2ZWMzIHBvc2l0aW9uVXBkYXRlZCA9IHBvc2l0aW9uOw0KI2lmZGVmIE5PUk1BTAkNCgl2ZWMzIG5vcm1hbFVwZGF0ZWQgPSBub3JtYWw7DQojZW5kaWYNCiNpZmRlZiBUQU5HRU5UDQoJdmVjNCB0YW5nZW50VXBkYXRlZCA9IHRhbmdlbnQ7DQojZW5kaWYNCg0KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4PlswLi5tYXhTaW11bHRhbmVvdXNNb3JwaFRhcmdldHNdDQoNCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWA0KCXZQb3NpdGlvblVWVyA9IHBvc2l0aW9uVXBkYXRlZDsNCiNlbmRpZiANCg0KI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4Pg0KI2luY2x1ZGU8Ym9uZXNWZXJ0ZXg+DQoNCglnbF9Qb3NpdGlvbiA9IHZpZXdQcm9qZWN0aW9uICogZmluYWxXb3JsZCAqIHZlYzQocG9zaXRpb25VcGRhdGVkLCAxLjApOw0KDQoJdmVjNCB3b3JsZFBvcyA9IGZpbmFsV29ybGQgKiB2ZWM0KHBvc2l0aW9uVXBkYXRlZCwgMS4wKTsNCgl2UG9zaXRpb25XID0gdmVjMyh3b3JsZFBvcyk7DQoNCiNpZmRlZiBOT1JNQUwNCgl2Tm9ybWFsVyA9IG5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQgKiB2ZWM0KG5vcm1hbFVwZGF0ZWQsIDAuMCkpKTsNCiNlbmRpZg0KDQojaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKQ0KCXZEaXJlY3Rpb25XID0gbm9ybWFsaXplKHZlYzMoZmluYWxXb3JsZCAqIHZlYzQocG9zaXRpb25VcGRhdGVkLCAwLjApKSk7DQojZW5kaWYNCg0KCS8vIFVWIGNvb3JkaW5hdGVzDQojaWZuZGVmIFVWMQ0KCXZlYzIgdXYgPSB2ZWMyKDAuLCAwLik7DQojZW5kaWYNCiNpZm5kZWYgVVYyDQoJdmVjMiB1djIgPSB2ZWMyKDAuLCAwLik7DQojZW5kaWYNCg0KCS8vIE1haW4gY29vcmRpbmF0ZXMNCiNpZmRlZiBNQUlOVVYxDQoJdk1haW5VVjEgPSB1djsNCiNlbmRpZg0KDQojaWZkZWYgTUFJTlVWMg0KCXZNYWluVVYyID0gdXYyOw0KI2VuZGlmDQoNCgkvLyBTcGxhdG1hcCBjb29yZGluYXRlcw0KI2lmZGVmIHNwbGF0bWFwRGVmDQoJaWYgKHNwbGF0bWFwSW5mb3MueCA9PSAwLikNCgl7DQoJCXNwbGF0bWFwVVYgPSB2ZWMyKHNwbGF0bWFwTWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJc3BsYXRtYXBVViA9IHZlYzIoc3BsYXRtYXBNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KI2lmZGVmIGF0bGFzVGV4dHVyZTFEZWYNCglpZiAoYXRsYXNUZXh0dXJlMUluZm9zLnggPT0gMC4pDQoJew0KCQlhdGxhc1RleHR1cmUxVVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTFNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQlhdGxhc1RleHR1cmUxVVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTFNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KI2lmZGVmIGF0bGFzVGV4dHVyZTJEZWYNCglpZiAoYXRsYXNUZXh0dXJlMkluZm9zLnggPT0gMC4pDQoJew0KCQlhdGxhc1RleHR1cmUyVVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTJNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQlhdGxhc1RleHR1cmUyVVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTJNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KI2lmZGVmIGF0bGFzVGV4dHVyZTNEZWYNCglpZiAoYXRsYXNUZXh0dXJlM0luZm9zLnggPT0gMC4pDQoJew0KCQlhdGxhc1RleHR1cmUzVVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTNNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQlhdGxhc1RleHR1cmUzVVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTNNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KI2lmZGVmIGF0bGFzVGV4dHVyZTREZWYNCglpZiAoYXRsYXNUZXh0dXJlNEluZm9zLnggPT0gMC4pDQoJew0KCQlhdGxhc1RleHR1cmU0VVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTRNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQlhdGxhc1RleHR1cmU0VVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTRNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KI2lmZGVmIGF0bGFzVGV4dHVyZTVEZWYNCglpZiAoYXRsYXNUZXh0dXJlNUluZm9zLnggPT0gMC4pDQoJew0KCQlhdGxhc1RleHR1cmU1VVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTVNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQlhdGxhc1RleHR1cmU1VVYgPSB2ZWMyKGF0bGFzVGV4dHVyZTVNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KCS8vIFRleHR1cmUgY29vcmRpbmF0ZXMNCiNpZiBkZWZpbmVkKERJRkZVU0UpICYmIERJRkZVU0VESVJFQ1RVViA9PSAwDQoJaWYgKHZEaWZmdXNlSW5mb3MueCA9PSAwLikNCgl7DQoJCXZEaWZmdXNlVVYgPSB2ZWMyKGRpZmZ1c2VNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQl2RGlmZnVzZVVWID0gdmVjMihkaWZmdXNlTWF0cml4ICogdmVjNCh1djIsIDEuMCwgMC4wKSk7DQoJfQ0KI2VuZGlmDQoNCiNpZiBkZWZpbmVkKEFNQklFTlQpICYmIEFNQklFTlRESVJFQ1RVViA9PSAwDQoJaWYgKHZBbWJpZW50SW5mb3MueCA9PSAwLikNCgl7DQoJCXZBbWJpZW50VVYgPSB2ZWMyKGFtYmllbnRNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQl2QW1iaWVudFVWID0gdmVjMihhbWJpZW50TWF0cml4ICogdmVjNCh1djIsIDEuMCwgMC4wKSk7DQoJfQ0KI2VuZGlmDQoNCiNpZiBkZWZpbmVkKE9QQUNJVFkpICYmIE9QQUNJVFlESVJFQ1RVViA9PSAwDQoJaWYgKHZPcGFjaXR5SW5mb3MueCA9PSAwLikNCgl7DQoJCXZPcGFjaXR5VVYgPSB2ZWMyKG9wYWNpdHlNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQl2T3BhY2l0eVVWID0gdmVjMihvcGFjaXR5TWF0cml4ICogdmVjNCh1djIsIDEuMCwgMC4wKSk7DQoJfQ0KI2VuZGlmDQoNCiNpZiBkZWZpbmVkKEVNSVNTSVZFKSAmJiBFTUlTU0lWRURJUkVDVFVWID09IDANCglpZiAodkVtaXNzaXZlSW5mb3MueCA9PSAwLikNCgl7DQoJCXZFbWlzc2l2ZVVWID0gdmVjMihlbWlzc2l2ZU1hdHJpeCAqIHZlYzQodXYsIDEuMCwgMC4wKSk7DQoJfQ0KCWVsc2UNCgl7DQoJCXZFbWlzc2l2ZVVWID0gdmVjMihlbWlzc2l2ZU1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWYgZGVmaW5lZChMSUdIVE1BUCkgJiYgTElHSFRNQVBESVJFQ1RVViA9PSAwDQoJaWYgKHZMaWdodG1hcEluZm9zLnggPT0gMC4pDQoJew0KCQl2TGlnaHRtYXBVViA9IHZlYzIobGlnaHRtYXBNYXRyaXggKiB2ZWM0KHV2LCAxLjAsIDAuMCkpOw0KCX0NCgllbHNlDQoJew0KCQl2TGlnaHRtYXBVViA9IHZlYzIobGlnaHRtYXBNYXRyaXggKiB2ZWM0KHV2MiwgMS4wLCAwLjApKTsNCgl9DQojZW5kaWYNCg0KI2lmIGRlZmluZWQoU1BFQ1VMQVIpICYmIGRlZmluZWQoU1BFQ1VMQVJURVJNKSAmJiBTUEVDVUxBUkRJUkVDVFVWID09IDANCglpZiAodlNwZWN1bGFySW5mb3MueCA9PSAwLikNCgl7DQoJCXZTcGVjdWxhclVWID0gdmVjMihzcGVjdWxhck1hdHJpeCAqIHZlYzQodXYsIDEuMCwgMC4wKSk7DQoJfQ0KCWVsc2UNCgl7DQoJCXZTcGVjdWxhclVWID0gdmVjMihzcGVjdWxhck1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWYgZGVmaW5lZChCVU1QKSAmJiBCVU1QRElSRUNUVVYgPT0gMA0KCWlmICh2QnVtcEluZm9zLnggPT0gMC4pDQoJew0KCQl2QnVtcFVWID0gdmVjMihidW1wTWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJdkJ1bXBVViA9IHZlYzIoYnVtcE1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWZkZWYgYnVtcFRleHR1cmUxRGVmDQoJaWYgKGJ1bXBUZXh0dXJlMUluZm9zLnggPT0gMC4pDQoJew0KCQlidW1wVGV4dHVyZTFVViA9IHZlYzIoYnVtcFRleHR1cmUxTWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJYnVtcFRleHR1cmUxVVYgPSB2ZWMyKGJ1bXBUZXh0dXJlMU1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWZkZWYgYnVtcFRleHR1cmUyRGVmDQoJaWYgKGJ1bXBUZXh0dXJlMkluZm9zLnggPT0gMC4pDQoJew0KCQlidW1wVGV4dHVyZTJVViA9IHZlYzIoYnVtcFRleHR1cmUyTWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJYnVtcFRleHR1cmUyVVYgPSB2ZWMyKGJ1bXBUZXh0dXJlMk1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWZkZWYgYnVtcFRleHR1cmUzRGVmDQoJaWYgKGJ1bXBUZXh0dXJlM0luZm9zLnggPT0gMC4pDQoJew0KCQlidW1wVGV4dHVyZTNVViA9IHZlYzIoYnVtcFRleHR1cmUzTWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJYnVtcFRleHR1cmUzVVYgPSB2ZWMyKGJ1bXBUZXh0dXJlM01hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWZkZWYgYnVtcFRleHR1cmU0RGVmDQoJaWYgKGJ1bXBUZXh0dXJlNEluZm9zLnggPT0gMC4pDQoJew0KCQlidW1wVGV4dHVyZTRVViA9IHZlYzIoYnVtcFRleHR1cmU0TWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJYnVtcFRleHR1cmU0VVYgPSB2ZWMyKGJ1bXBUZXh0dXJlNE1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaWZkZWYgYnVtcFRleHR1cmU1RGVmDQoJaWYgKGJ1bXBUZXh0dXJlNUluZm9zLnggPT0gMC4pDQoJew0KCQlidW1wVGV4dHVyZTVVViA9IHZlYzIoYnVtcFRleHR1cmU1TWF0cml4ICogdmVjNCh1diwgMS4wLCAwLjApKTsNCgl9DQoJZWxzZQ0KCXsNCgkJYnVtcFRleHR1cmU1VVYgPSB2ZWMyKGJ1bXBUZXh0dXJlNU1hdHJpeCAqIHZlYzQodXYyLCAxLjAsIDAuMCkpOw0KCX0NCiNlbmRpZg0KDQojaW5jbHVkZTxidW1wVmVydGV4Pg0KI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4Pg0KI2luY2x1ZGU8Zm9nVmVydGV4Pg0KI2luY2x1ZGU8c2hhZG93c1ZlcnRleD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQ0KDQojaWZkZWYgVkVSVEVYQ09MT1INCgkvLyBWZXJ0ZXggY29sb3INCgl2Q29sb3IgPSBjb2xvcjsNCiNlbmRpZg0KDQojaW5jbHVkZTxwb2ludENsb3VkVmVydGV4Pg0KI2luY2x1ZGU8bG9nRGVwdGhWZXJ0ZXg+DQoNCn0=");BABYLON.Effect.ShadersStore.splatmapPixelShader=window.atob("I2luY2x1ZGU8X19kZWNsX19kZWZhdWx0RnJhZ21lbnQ+DQoNCiNpZiBkZWZpbmVkKEJVTVApIHx8ICFkZWZpbmVkKE5PUk1BTCkNCiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlDQojZW5kaWYNCg0KI2lmZGVmIExPR0FSSVRITUlDREVQVEgNCiNleHRlbnNpb24gR0xfRVhUX2ZyYWdfZGVwdGggOiBlbmFibGUNCiNlbmRpZg0KDQovLyBDb25zdGFudHMNCiNkZWZpbmUgUkVDSVBST0NBTF9QSTIgMC4xNTkxNTQ5NA0KDQp1bmlmb3JtIHZlYzMgdkV5ZVBvc2l0aW9uOw0KdW5pZm9ybSB2ZWMzIHZBbWJpZW50Q29sb3I7DQoNCi8vIElucHV0DQp2YXJ5aW5nIHZlYzMgdlBvc2l0aW9uVzsNCg0KI2lmZGVmIE5PUk1BTA0KdmFyeWluZyB2ZWMzIHZOb3JtYWxXOw0KI2VuZGlmDQoNCiNpZmRlZiBWRVJURVhDT0xPUg0KdmFyeWluZyB2ZWM0IHZDb2xvcjsNCiNlbmRpZg0KDQojaWZkZWYgTUFJTlVWMQ0KCXZhcnlpbmcgdmVjMiB2TWFpblVWMTsNCiNlbmRpZg0KDQojaWZkZWYgTUFJTlVWMg0KCXZhcnlpbmcgdmVjMiB2TWFpblVWMjsNCiNlbmRpZg0KDQovLyBIZWxwZXIgZnVuY3Rpb25zDQojaW5jbHVkZTxoZWxwZXJGdW5jdGlvbnM+DQoNCi8vIExpZ2h0cw0KI2luY2x1ZGU8X19kZWNsX19saWdodEZyYWdtZW50PlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdDQoNCiNpbmNsdWRlPGxpZ2h0c0ZyYWdtZW50RnVuY3Rpb25zPg0KI2luY2x1ZGU8c2hhZG93c0ZyYWdtZW50RnVuY3Rpb25zPg0KDQovLyBTcGxhdG1hcHMNCiNpZmRlZiBzcGxhdG1hcERlZg0KdW5pZm9ybSBzYW1wbGVyMkQgc3BsYXRtYXA7DQp2YXJ5aW5nIHZlYzIgc3BsYXRtYXBVVjsNCnVuaWZvcm0gdmVjMiBzcGxhdG1hcEluZm9zOw0KdW5pZm9ybSBmbG9hdCBzcGxhdG1hcFJlY3RzOw0KdW5pZm9ybSB2ZWM0IHNwbGF0bWFwUmVjdDE7DQp1bmlmb3JtIHZlYzQgc3BsYXRtYXBSZWN0MjsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTFEZWYNCnVuaWZvcm0gc2FtcGxlcjJEIGF0bGFzVGV4dHVyZTE7DQp2YXJ5aW5nIHZlYzIgYXRsYXNUZXh0dXJlMVVWOw0KdW5pZm9ybSB2ZWMyIGF0bGFzVGV4dHVyZTFJbmZvczsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTJEZWYNCnVuaWZvcm0gc2FtcGxlcjJEIGF0bGFzVGV4dHVyZTI7DQp2YXJ5aW5nIHZlYzIgYXRsYXNUZXh0dXJlMlVWOw0KdW5pZm9ybSB2ZWMyIGF0bGFzVGV4dHVyZTJJbmZvczsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTNEZWYNCnVuaWZvcm0gc2FtcGxlcjJEIGF0bGFzVGV4dHVyZTM7DQp2YXJ5aW5nIHZlYzIgYXRsYXNUZXh0dXJlM1VWOw0KdW5pZm9ybSB2ZWMyIGF0bGFzVGV4dHVyZTNJbmZvczsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTREZWYNCnVuaWZvcm0gc2FtcGxlcjJEIGF0bGFzVGV4dHVyZTQ7DQp2YXJ5aW5nIHZlYzIgYXRsYXNUZXh0dXJlNFVWOw0KdW5pZm9ybSB2ZWMyIGF0bGFzVGV4dHVyZTRJbmZvczsNCiNlbmRpZg0KI2lmZGVmIGF0bGFzVGV4dHVyZTVEZWYNCnVuaWZvcm0gc2FtcGxlcjJEIGF0bGFzVGV4dHVyZTU7DQp2YXJ5aW5nIHZlYzIgYXRsYXNUZXh0dXJlNVVWOw0KdW5pZm9ybSB2ZWMyIGF0bGFzVGV4dHVyZTVJbmZvczsNCiNlbmRpZg0KI2lmZGVmIGJ1bXBUZXh0dXJlMURlZg0KdW5pZm9ybSBzYW1wbGVyMkQgYnVtcFRleHR1cmUxOw0KdmFyeWluZyB2ZWMyIGJ1bXBUZXh0dXJlMVVWOw0KdW5pZm9ybSB2ZWMyIGJ1bXBUZXh0dXJlMUluZm9zOw0KI2VuZGlmDQojaWZkZWYgYnVtcFRleHR1cmUyRGVmDQp1bmlmb3JtIHNhbXBsZXIyRCBidW1wVGV4dHVyZTI7DQp2YXJ5aW5nIHZlYzIgYnVtcFRleHR1cmUyVVY7DQp1bmlmb3JtIHZlYzIgYnVtcFRleHR1cmUySW5mb3M7DQojZW5kaWYNCiNpZmRlZiBidW1wVGV4dHVyZTNEZWYNCnVuaWZvcm0gc2FtcGxlcjJEIGJ1bXBUZXh0dXJlMzsNCnZhcnlpbmcgdmVjMiBidW1wVGV4dHVyZTNVVjsNCnVuaWZvcm0gdmVjMiBidW1wVGV4dHVyZTNJbmZvczsNCiNlbmRpZg0KI2lmZGVmIGJ1bXBUZXh0dXJlNERlZg0KdW5pZm9ybSBzYW1wbGVyMkQgYnVtcFRleHR1cmU0Ow0KdmFyeWluZyB2ZWMyIGJ1bXBUZXh0dXJlNFVWOw0KdW5pZm9ybSB2ZWMyIGJ1bXBUZXh0dXJlNEluZm9zOw0KI2VuZGlmDQojaWZkZWYgYnVtcFRleHR1cmU1RGVmDQp1bmlmb3JtIHNhbXBsZXIyRCBidW1wVGV4dHVyZTU7DQp2YXJ5aW5nIHZlYzIgYnVtcFRleHR1cmU1VVY7DQp1bmlmb3JtIHZlYzIgYnVtcFRleHR1cmU1SW5mb3M7DQojZW5kaWYNCg0KLy8gU2FtcGxlcnMNCiNpZmRlZiBESUZGVVNFDQoJI2lmIERJRkZVU0VESVJFQ1RVViA9PSAxDQoJCSNkZWZpbmUgdkRpZmZ1c2VVViB2TWFpblVWMQ0KCSNlbGlmIERJRkZVU0VESVJFQ1RVViA9PSAyDQoJCSNkZWZpbmUgdkRpZmZ1c2VVViB2TWFpblVWMg0KCSNlbHNlDQoJCXZhcnlpbmcgdmVjMiB2RGlmZnVzZVVWOw0KCSNlbmRpZg0KCXVuaWZvcm0gc2FtcGxlcjJEIGRpZmZ1c2VTYW1wbGVyOw0KI2VuZGlmDQoNCiNpZmRlZiBBTUJJRU5UDQoJI2lmIEFNQklFTlRESVJFQ1RVViA9PSAxDQoJCSNkZWZpbmUgdkFtYmllbnRVViB2TWFpblVWMQ0KCSNlbGlmIEFNQklFTlRESVJFQ1RVViA9PSAyDQoJCSNkZWZpbmUgdkFtYmllbnRVViB2TWFpblVWMg0KCSNlbHNlDQoJCXZhcnlpbmcgdmVjMiB2QW1iaWVudFVWOw0KCSNlbmRpZg0KCXVuaWZvcm0gc2FtcGxlcjJEIGFtYmllbnRTYW1wbGVyOw0KI2VuZGlmDQoNCiNpZmRlZiBPUEFDSVRZCQ0KCSNpZiBPUEFDSVRZRElSRUNUVVYgPT0gMQ0KCQkjZGVmaW5lIHZPcGFjaXR5VVYgdk1haW5VVjENCgkjZWxpZiBPUEFDSVRZRElSRUNUVVYgPT0gMg0KCQkjZGVmaW5lIHZPcGFjaXR5VVYgdk1haW5VVjINCgkjZWxzZQ0KCQl2YXJ5aW5nIHZlYzIgdk9wYWNpdHlVVjsNCgkjZW5kaWYNCgl1bmlmb3JtIHNhbXBsZXIyRCBvcGFjaXR5U2FtcGxlcjsNCiNlbmRpZg0KDQojaWZkZWYgRU1JU1NJVkUNCgkjaWYgRU1JU1NJVkVESVJFQ1RVViA9PSAxDQoJCSNkZWZpbmUgdkVtaXNzaXZlVVYgdk1haW5VVjENCgkjZWxpZiBFTUlTU0lWRURJUkVDVFVWID09IDINCgkJI2RlZmluZSB2RW1pc3NpdmVVViB2TWFpblVWMg0KCSNlbHNlDQoJCXZhcnlpbmcgdmVjMiB2RW1pc3NpdmVVVjsNCgkjZW5kaWYNCgl1bmlmb3JtIHNhbXBsZXIyRCBlbWlzc2l2ZVNhbXBsZXI7DQojZW5kaWYNCg0KI2lmZGVmIExJR0hUTUFQDQoJI2lmIExJR0hUTUFQRElSRUNUVVYgPT0gMQ0KCQkjZGVmaW5lIHZMaWdodG1hcFVWIHZNYWluVVYxDQoJI2VsaWYgTElHSFRNQVBESVJFQ1RVViA9PSAyDQoJCSNkZWZpbmUgdkxpZ2h0bWFwVVYgdk1haW5VVjINCgkjZWxzZQ0KCQl2YXJ5aW5nIHZlYzIgdkxpZ2h0bWFwVVY7DQoJI2VuZGlmDQoJdW5pZm9ybSBzYW1wbGVyMkQgbGlnaHRtYXBTYW1wbGVyOw0KI2VuZGlmDQoNCiNpZmRlZiBSRUZSQUNUSU9ODQoNCiNpZmRlZiBSRUZSQUNUSU9OTUFQXzNEDQp1bmlmb3JtIHNhbXBsZXJDdWJlIHJlZnJhY3Rpb25DdWJlU2FtcGxlcjsNCiNlbHNlDQp1bmlmb3JtIHNhbXBsZXIyRCByZWZyYWN0aW9uMkRTYW1wbGVyOw0KI2VuZGlmDQoNCiNlbmRpZg0KDQojaWYgZGVmaW5lZChTUEVDVUxBUikgJiYgZGVmaW5lZChTUEVDVUxBUlRFUk0pDQoJI2lmIFNQRUNVTEFSRElSRUNUVVYgPT0gMQ0KCQkjZGVmaW5lIHZTcGVjdWxhclVWIHZNYWluVVYxDQoJI2VsaWYgU1BFQ1VMQVJESVJFQ1RVViA9PSAyDQoJCSNkZWZpbmUgdlNwZWN1bGFyVVYgdk1haW5VVjINCgkjZWxzZQ0KCQl2YXJ5aW5nIHZlYzIgdlNwZWN1bGFyVVY7DQoJI2VuZGlmDQoJdW5pZm9ybSBzYW1wbGVyMkQgc3BlY3VsYXJTYW1wbGVyOw0KI2VuZGlmDQoNCi8vIEZyZXNuZWwNCiNpbmNsdWRlPGZyZXNuZWxGdW5jdGlvbj4NCg0KLy8gUmVmbGVjdGlvbg0KI2lmZGVmIFJFRkxFQ1RJT04NCiNpZmRlZiBSRUZMRUNUSU9OTUFQXzNEDQp1bmlmb3JtIHNhbXBsZXJDdWJlIHJlZmxlY3Rpb25DdWJlU2FtcGxlcjsNCiNlbHNlDQp1bmlmb3JtIHNhbXBsZXIyRCByZWZsZWN0aW9uMkRTYW1wbGVyOw0KI2VuZGlmDQoNCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWA0KdmFyeWluZyB2ZWMzIHZQb3NpdGlvblVWVzsNCiNlbHNlDQojaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKQ0KdmFyeWluZyB2ZWMzIHZEaXJlY3Rpb25XOw0KI2VuZGlmDQoNCiNlbmRpZg0KDQojaW5jbHVkZTxyZWZsZWN0aW9uRnVuY3Rpb24+DQoNCiNlbmRpZg0KDQojaW5jbHVkZTxpbWFnZVByb2Nlc3NpbmdEZWNsYXJhdGlvbj4NCg0KI2luY2x1ZGU8aW1hZ2VQcm9jZXNzaW5nRnVuY3Rpb25zPg0KDQojaW5jbHVkZTxidW1wRnJhZ21lbnRGdW5jdGlvbnM+DQojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudERlY2xhcmF0aW9uPg0KI2luY2x1ZGU8bG9nRGVwdGhEZWNsYXJhdGlvbj4NCiNpbmNsdWRlPGZvZ0ZyYWdtZW50RGVjbGFyYXRpb24+DQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBUZXh0dXJlIEF0bGFzIFN1cHBvcnQNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQp2ZWM0IHRleHR1cmVGcmFjdDJEKHNhbXBsZXIyRCBhdGxhcywgdmVjNCByZWN0LCB2ZWMyIHNpemUsIHZlYzIgc2NhbGUsIHZlYzIgdXYsIHZlYzIgb2Zmc2V0KSB7DQoJdmVjMiBmcmFjdFVWID0gZnJhY3QodXYgKiBzY2FsZSk7DQoJdmVjMiBhdGxhc1VWID0gdmVjMigoZnJhY3RVVi54ICogcmVjdC53KSArIHJlY3QueCwgKGZyYWN0VVYueSAqIHJlY3QueikgKyByZWN0LnkpOw0KCXZlYzIgdGlsZWRVViA9IGF0bGFzVVYgKyBvZmZzZXQ7DQoJcmV0dXJuIHRleHR1cmUyRChhdGxhcywgdGlsZWRVVik7DQp9DQp2ZWM0IHRleHR1cmVBdGxhczJEKHNhbXBsZXIyRCBhdGxhcywgdmVjNCByZWN0LCB2ZWMyIHV2LCB2ZWMyIG9mZnNldCkgew0KCXZlYzIgYXRsYXNVViA9IHZlYzIoKHV2LnggKiByZWN0LncpICsgcmVjdC54LCAodXYueSAqIHJlY3QueikgKyByZWN0LnkpOw0KCXZlYzIgdGlsZWRVViA9IGF0bGFzVVYgKyBvZmZzZXQ7DQoJcmV0dXJuIHRleHR1cmUyRChhdGxhcywgdGlsZWRVVik7DQp9DQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQp2b2lkIG1haW4odm9pZCkgew0KI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnQ+DQoJdmVjMyB2aWV3RGlyZWN0aW9uVyA9IG5vcm1hbGl6ZSh2RXllUG9zaXRpb24gLSB2UG9zaXRpb25XKTsNCg0KCS8vIEJhc2UgY29sb3INCgl2ZWM0IGJhc2VDb2xvciA9IHZlYzQoMS4wLCAxLjAsIDEuMCwgMS4wKTsNCgl2ZWMzIGRpZmZ1c2VDb2xvciA9IHZEaWZmdXNlQ29sb3IucmdiOw0KDQoJLy8gQWxwaGENCglmbG9hdCBhbHBoYSA9IHZEaWZmdXNlQ29sb3IuYTsNCg0KCS8vIEJ1bXANCgkjaWZkZWYgTk9STUFMDQoJCXZlYzMgbm9ybWFsVyA9IG5vcm1hbGl6ZSh2Tm9ybWFsVyk7DQoJI2Vsc2UNCgkJdmVjMyBub3JtYWxXID0gbm9ybWFsaXplKC1jcm9zcyhkRmR4KHZQb3NpdGlvblcpLCBkRmR5KHZQb3NpdGlvblcpKSk7DQoJI2VuZGlmDQoNCiNpZmRlZiBzcGxhdG1hcERlZg0KCXZlYzIgdXZPZmZzZXQgPSB2ZWMyKDAuMCwgMC4wKTsNCgkjaWYgZGVmaW5lZChCVU1QKSB8fCBkZWZpbmVkKFBBUkFMTEFYKQ0KCQkjaWZkZWYgTk9STUFMWFlTQ0FMRQ0KCQkJZmxvYXQgbm9ybWFsU2NhbGUgPSAxLjA7DQoJCSNlbHNlCQkNCgkJCWZsb2F0IG5vcm1hbFNjYWxlID0gdkJ1bXBJbmZvcy55Ow0KCQkjZW5kaWYNCg0KCQkjaWYgZGVmaW5lZChUQU5HRU5UKSAmJiBkZWZpbmVkKE5PUk1BTCkNCgkJCW1hdDMgVEJOID0gdlRCTjsNCgkJI2Vsc2UNCgkJCW1hdDMgVEJOID0gY290YW5nZW50X2ZyYW1lKG5vcm1hbFcgKiBub3JtYWxTY2FsZSwgdlBvc2l0aW9uVywgdkJ1bXBVVik7DQoJCSNlbmRpZg0KCSNlbmRpZg0KDQoJI2lmZGVmIFBBUkFMTEFYDQoJCW1hdDMgaW52VEJOID0gdHJhbnNwb3NlTWF0MyhUQk4pOw0KDQoJCSNpZmRlZiBQQVJBTExBWE9DQ0xVU0lPTg0KCQkJdXZPZmZzZXQgPSBwYXJhbGxheE9jY2x1c2lvbihpbnZUQk4gKiAtdmlld0RpcmVjdGlvblcsIGludlRCTiAqIG5vcm1hbFcsIHZCdW1wVVYsIHZCdW1wSW5mb3Mueik7DQoJCSNlbHNlDQoJCQl1dk9mZnNldCA9IHBhcmFsbGF4T2Zmc2V0KGludlRCTiAqIHZpZXdEaXJlY3Rpb25XLCB2QnVtcEluZm9zLnopOw0KCQkjZW5kaWYNCgkjZW5kaWYNCiNlbHNlDQoJI2luY2x1ZGU8YnVtcEZyYWdtZW50Pg0KCSNpZmRlZiBUV09TSURFRExJR0hUSU5HDQoJCW5vcm1hbFcgPSBnbF9Gcm9udEZhY2luZyA/IG5vcm1hbFcgOiAtbm9ybWFsVzsNCgkjZW5kaWYNCiNlbmRpZg0KDQojaWZkZWYgRElGRlVTRQ0KCS8vIFNwbGF0bWFwcw0KCSNpZiBkZWZpbmVkKFNQTEFUTUFQU19FTkFCTEVEKSAmJiBkZWZpbmVkKHNwbGF0bWFwRGVmKQ0KCQl2ZWM0IGJhc2VDb2xvcjEgPSB2ZWM0KDAuMCwgMC4wLCAwLjAsIDAuMCk7DQoJCXZlYzQgYmFzZUNvbG9yMiA9IHZlYzQoMC4wLCAwLjAsIDAuMCwgMC4wKTsNCgkJLy8gQmFzZSBzcGxhdCBjb2xvcnMNCgkJaWYgKHNwbGF0bWFwUmVjdHMgPiAwLjApIHsNCgkJCWJhc2VDb2xvcjEgPSB0ZXh0dXJlQXRsYXMyRChzcGxhdG1hcCwgc3BsYXRtYXBSZWN0MSwgc3BsYXRtYXBVViwgdXZPZmZzZXQpOw0KCQl9DQoJCWlmIChzcGxhdG1hcFJlY3RzID4gMS4wKSB7DQoJCQliYXNlQ29sb3IyID0gdGV4dHVyZUF0bGFzMkQoc3BsYXRtYXAsIHNwbGF0bWFwUmVjdDIsIHNwbGF0bWFwVVYsIHV2T2Zmc2V0KTsNCgkJfQ0KCQkvLyBQcmltYXJ5IHNwbGF0IGNvbG9ycw0KCQliYXNlQ29sb3IgPSB0ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsIHZEaWZmdXNlVVYgKyB1dk9mZnNldCkgKiBiYXNlQ29sb3IxLnI7DQoJCSNpZmRlZiBhdGxhc1RleHR1cmUxRGVmDQoJCQliYXNlQ29sb3IgKz0gdGV4dHVyZTJEKGF0bGFzVGV4dHVyZTEsIGF0bGFzVGV4dHVyZTFVViArIHV2T2Zmc2V0KSAqIGJhc2VDb2xvcjEuZzsNCgkJI2VuZGlmDQoJCSNpZmRlZiBhdGxhc1RleHR1cmUyRGVmDQoJCQliYXNlQ29sb3IgKz0gdGV4dHVyZTJEKGF0bGFzVGV4dHVyZTIsIGF0bGFzVGV4dHVyZTJVViArIHV2T2Zmc2V0KSAqIGJhc2VDb2xvcjEuYjsNCgkJI2VuZGlmDQoJCS8vIFNlY29uZCBzcGxhdCBjb2xvcnMNCgkJI2lmZGVmIGF0bGFzVGV4dHVyZTNEZWYNCgkJCWJhc2VDb2xvciArPSB0ZXh0dXJlMkQoYXRsYXNUZXh0dXJlMywgYXRsYXNUZXh0dXJlM1VWICsgdXZPZmZzZXQpICogYmFzZUNvbG9yMi5yOw0KCQkjZW5kaWYNCgkJI2lmZGVmIGF0bGFzVGV4dHVyZTREZWYNCgkJCWJhc2VDb2xvciArPSB0ZXh0dXJlMkQoYXRsYXNUZXh0dXJlNCwgYXRsYXNUZXh0dXJlNFVWICsgdXZPZmZzZXQpICogYmFzZUNvbG9yMi5nOw0KCQkjZW5kaWYNCgkJI2lmZGVmIGF0bGFzVGV4dHVyZTVEZWYNCgkJCWJhc2VDb2xvciArPSB0ZXh0dXJlMkQoYXRsYXNUZXh0dXJlNSwgYXRsYXNUZXh0dXJlNVVWICsgdXZPZmZzZXQpICogYmFzZUNvbG9yMi5iOw0KCQkjZW5kaWYNCgkjZWxzZQ0KCQliYXNlQ29sb3IgPSB0ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsIHZEaWZmdXNlVVYgKyB1dk9mZnNldCk7DQoJI2VuZGlmDQoNCgkjaWZkZWYgQUxQSEFURVNUDQoJCWlmIChiYXNlQ29sb3IuYSA8IDAuNCkNCgkJCWRpc2NhcmQ7DQoJI2VuZGlmDQoNCgkjaWZkZWYgQUxQSEFGUk9NRElGRlVTRQ0KCQlhbHBoYSAqPSBiYXNlQ29sb3IuYTsNCgkjZW5kaWYNCg0KCWJhc2VDb2xvci5yZ2IgKj0gdkRpZmZ1c2VJbmZvcy55Ow0KDQojaWZkZWYgc3BsYXRtYXBEZWYNCgkjaWZkZWYgQlVNUA0KCQkvL25vcm1hbFcgPSBwZXJ0dXJiTm9ybWFsKFRCTiwgdkJ1bXBVViArIHV2T2Zmc2V0KTsNCgkjZW5kaWYNCg0KCSNpZmRlZiBUV09TSURFRExJR0hUSU5HDQoJCW5vcm1hbFcgPSBnbF9Gcm9udEZhY2luZyA/IG5vcm1hbFcgOiAtbm9ybWFsVzsNCgkjZW5kaWYNCiNlbmRpZg0KCQ0KI2VuZGlmDQoNCiNpbmNsdWRlPGRlcHRoUHJlUGFzcz4NCg0KI2lmZGVmIFZFUlRFWENPTE9SDQoJYmFzZUNvbG9yLnJnYiAqPSB2Q29sb3IucmdiOw0KI2VuZGlmDQoNCgkvLyBBbWJpZW50IGNvbG9yDQoJdmVjMyBiYXNlQW1iaWVudENvbG9yID0gdmVjMygxLiwgMS4sIDEuKTsNCg0KI2lmZGVmIEFNQklFTlQNCgliYXNlQW1iaWVudENvbG9yID0gdGV4dHVyZTJEKGFtYmllbnRTYW1wbGVyLCB2QW1iaWVudFVWICsgdXZPZmZzZXQpLnJnYiAqIHZBbWJpZW50SW5mb3MueTsNCiNlbmRpZg0KDQoJLy8gU3BlY3VsYXIgbWFwDQojaWZkZWYgU1BFQ1VMQVJURVJNDQoJZmxvYXQgZ2xvc3NpbmVzcyA9IHZTcGVjdWxhckNvbG9yLmE7DQoJdmVjMyBzcGVjdWxhckNvbG9yID0gdlNwZWN1bGFyQ29sb3IucmdiOw0KDQojaWZkZWYgU1BFQ1VMQVINCgl2ZWM0IHNwZWN1bGFyTWFwQ29sb3IgPSB0ZXh0dXJlMkQoc3BlY3VsYXJTYW1wbGVyLCB2U3BlY3VsYXJVViArIHV2T2Zmc2V0KTsNCglzcGVjdWxhckNvbG9yID0gc3BlY3VsYXJNYXBDb2xvci5yZ2I7DQojaWZkZWYgR0xPU1NJTkVTUw0KCWdsb3NzaW5lc3MgPSBnbG9zc2luZXNzICogc3BlY3VsYXJNYXBDb2xvci5hOw0KI2VuZGlmDQojZW5kaWYNCiNlbHNlDQoJZmxvYXQgZ2xvc3NpbmVzcyA9IDAuOw0KI2VuZGlmDQoNCgkvLyBMaWdodGluZw0KCXZlYzMgZGlmZnVzZUJhc2UgPSB2ZWMzKDAuLCAwLiwgMC4pOw0KCWxpZ2h0aW5nSW5mbyBpbmZvOw0KI2lmZGVmIFNQRUNVTEFSVEVSTQ0KCXZlYzMgc3BlY3VsYXJCYXNlID0gdmVjMygwLiwgMC4sIDAuKTsNCiNlbmRpZg0KCWZsb2F0IHNoYWRvdyA9IDEuOw0KDQojaWZkZWYgTElHSFRNQVANCgl2ZWMzIGxpZ2h0bWFwQ29sb3IgPSB0ZXh0dXJlMkQobGlnaHRtYXBTYW1wbGVyLCB2TGlnaHRtYXBVViArIHV2T2Zmc2V0KS5yZ2IgKiB2TGlnaHRtYXBJbmZvcy55Ow0KI2VuZGlmDQoNCiNpbmNsdWRlPGxpZ2h0RnJhZ21lbnQ+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c10NCg0KCS8vIFJlZnJhY3Rpb24NCgl2ZWMzIHJlZnJhY3Rpb25Db2xvciA9IHZlYzMoMC4sIDAuLCAwLik7DQoNCiNpZmRlZiBSRUZSQUNUSU9ODQoJdmVjMyByZWZyYWN0aW9uVmVjdG9yID0gbm9ybWFsaXplKHJlZnJhY3QoLXZpZXdEaXJlY3Rpb25XLCBub3JtYWxXLCB2UmVmcmFjdGlvbkluZm9zLnkpKTsNCiNpZmRlZiBSRUZSQUNUSU9OTUFQXzNEDQoNCglyZWZyYWN0aW9uVmVjdG9yLnkgPSByZWZyYWN0aW9uVmVjdG9yLnkgKiB2UmVmcmFjdGlvbkluZm9zLnc7DQoNCglpZiAoZG90KHJlZnJhY3Rpb25WZWN0b3IsIHZpZXdEaXJlY3Rpb25XKSA8IDEuMCkNCgl7DQoJCXJlZnJhY3Rpb25Db2xvciA9IHRleHR1cmVDdWJlKHJlZnJhY3Rpb25DdWJlU2FtcGxlciwgcmVmcmFjdGlvblZlY3RvcikucmdiICogdlJlZnJhY3Rpb25JbmZvcy54Ow0KCX0NCiNlbHNlDQoJdmVjMyB2UmVmcmFjdGlvblVWVyA9IHZlYzMocmVmcmFjdGlvbk1hdHJpeCAqICh2aWV3ICogdmVjNCh2UG9zaXRpb25XICsgcmVmcmFjdGlvblZlY3RvciAqIHZSZWZyYWN0aW9uSW5mb3MueiwgMS4wKSkpOw0KDQoJdmVjMiByZWZyYWN0aW9uQ29vcmRzID0gdlJlZnJhY3Rpb25VVlcueHkgLyB2UmVmcmFjdGlvblVWVy56Ow0KDQoJcmVmcmFjdGlvbkNvb3Jkcy55ID0gMS4wIC0gcmVmcmFjdGlvbkNvb3Jkcy55Ow0KDQoJcmVmcmFjdGlvbkNvbG9yID0gdGV4dHVyZTJEKHJlZnJhY3Rpb24yRFNhbXBsZXIsIHJlZnJhY3Rpb25Db29yZHMpLnJnYiAqIHZSZWZyYWN0aW9uSW5mb3MueDsNCiNlbmRpZg0KI2VuZGlmDQoNCgkvLyBSZWZsZWN0aW9uDQoJdmVjMyByZWZsZWN0aW9uQ29sb3IgPSB2ZWMzKDAuLCAwLiwgMC4pOw0KDQojaWZkZWYgUkVGTEVDVElPTg0KCXZlYzMgdlJlZmxlY3Rpb25VVlcgPSBjb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0KHZQb3NpdGlvblcsIDEuMCksIG5vcm1hbFcpOw0KDQojaWZkZWYgUkVGTEVDVElPTk1BUF8zRA0KI2lmZGVmIFJPVUdITkVTUw0KCWZsb2F0IGJpYXMgPSB2UmVmbGVjdGlvbkluZm9zLnk7DQoNCiNpZmRlZiBTUEVDVUxBUlRFUk0NCgkjaWZkZWYgU1BFQ1VMQVINCgkJI2lmZGVmIEdMT1NTSU5FU1MNCgkJCWJpYXMgKj0gKDEuMCAtIHNwZWN1bGFyTWFwQ29sb3IuYSk7DQoJCSNlbmRpZg0KCSNlbmRpZg0KI2VuZGlmDQoNCglyZWZsZWN0aW9uQ29sb3IgPSB0ZXh0dXJlQ3ViZShyZWZsZWN0aW9uQ3ViZVNhbXBsZXIsIHZSZWZsZWN0aW9uVVZXLCBiaWFzKS5yZ2IgKiB2UmVmbGVjdGlvbkluZm9zLng7DQojZWxzZQ0KCXJlZmxlY3Rpb25Db2xvciA9IHRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlciwgdlJlZmxlY3Rpb25VVlcpLnJnYiAqIHZSZWZsZWN0aW9uSW5mb3MueDsNCiNlbmRpZg0KDQojZWxzZQ0KCXZlYzIgY29vcmRzID0gdlJlZmxlY3Rpb25VVlcueHk7DQoNCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT04NCgljb29yZHMgLz0gdlJlZmxlY3Rpb25VVlcuejsNCiNlbmRpZg0KDQoJY29vcmRzLnkgPSAxLjAgLSBjb29yZHMueTsNCg0KCXJlZmxlY3Rpb25Db2xvciA9IHRleHR1cmUyRChyZWZsZWN0aW9uMkRTYW1wbGVyLCBjb29yZHMpLnJnYiAqIHZSZWZsZWN0aW9uSW5mb3MueDsNCiNlbmRpZg0KDQojaWZkZWYgUkVGTEVDVElPTkZSRVNORUwNCglmbG9hdCByZWZsZWN0aW9uRnJlc25lbFRlcm0gPSBjb21wdXRlRnJlc25lbFRlcm0odmlld0RpcmVjdGlvblcsIG5vcm1hbFcsIHJlZmxlY3Rpb25SaWdodENvbG9yLmEsIHJlZmxlY3Rpb25MZWZ0Q29sb3IuYSk7DQoNCiNpZmRlZiBSRUZMRUNUSU9ORlJFU05FTEZST01TUEVDVUxBUg0KI2lmZGVmIFNQRUNVTEFSVEVSTQ0KCXJlZmxlY3Rpb25Db2xvciAqPSBzcGVjdWxhckNvbG9yLnJnYiAqICgxLjAgLSByZWZsZWN0aW9uRnJlc25lbFRlcm0pICsgcmVmbGVjdGlvbkZyZXNuZWxUZXJtICogcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiOw0KI2Vsc2UNCglyZWZsZWN0aW9uQ29sb3IgKj0gcmVmbGVjdGlvbkxlZnRDb2xvci5yZ2IgKiAoMS4wIC0gcmVmbGVjdGlvbkZyZXNuZWxUZXJtKSArIHJlZmxlY3Rpb25GcmVzbmVsVGVybSAqIHJlZmxlY3Rpb25SaWdodENvbG9yLnJnYjsNCiNlbmRpZg0KI2Vsc2UNCglyZWZsZWN0aW9uQ29sb3IgKj0gcmVmbGVjdGlvbkxlZnRDb2xvci5yZ2IgKiAoMS4wIC0gcmVmbGVjdGlvbkZyZXNuZWxUZXJtKSArIHJlZmxlY3Rpb25GcmVzbmVsVGVybSAqIHJlZmxlY3Rpb25SaWdodENvbG9yLnJnYjsNCiNlbmRpZg0KI2VuZGlmDQojZW5kaWYNCg0KI2lmZGVmIFJFRlJBQ1RJT05GUkVTTkVMDQoJZmxvYXQgcmVmcmFjdGlvbkZyZXNuZWxUZXJtID0gY29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLCBub3JtYWxXLCByZWZyYWN0aW9uUmlnaHRDb2xvci5hLCByZWZyYWN0aW9uTGVmdENvbG9yLmEpOw0KDQoJcmVmcmFjdGlvbkNvbG9yICo9IHJlZnJhY3Rpb25MZWZ0Q29sb3IucmdiICogKDEuMCAtIHJlZnJhY3Rpb25GcmVzbmVsVGVybSkgKyByZWZyYWN0aW9uRnJlc25lbFRlcm0gKiByZWZyYWN0aW9uUmlnaHRDb2xvci5yZ2I7DQojZW5kaWYNCg0KI2lmZGVmIE9QQUNJVFkNCgl2ZWM0IG9wYWNpdHlNYXAgPSB0ZXh0dXJlMkQob3BhY2l0eVNhbXBsZXIsIHZPcGFjaXR5VVYgKyB1dk9mZnNldCk7DQoNCiNpZmRlZiBPUEFDSVRZUkdCDQoJb3BhY2l0eU1hcC5yZ2IgPSBvcGFjaXR5TWFwLnJnYiAqIHZlYzMoMC4zLCAwLjU5LCAwLjExKTsNCglhbHBoYSAqPSAob3BhY2l0eU1hcC54ICsgb3BhY2l0eU1hcC55ICsgb3BhY2l0eU1hcC56KSogdk9wYWNpdHlJbmZvcy55Ow0KI2Vsc2UNCglhbHBoYSAqPSBvcGFjaXR5TWFwLmEgKiB2T3BhY2l0eUluZm9zLnk7DQojZW5kaWYNCg0KI2VuZGlmDQoNCiNpZmRlZiBWRVJURVhBTFBIQQ0KCWFscGhhICo9IHZDb2xvci5hOw0KI2VuZGlmDQoNCiNpZmRlZiBPUEFDSVRZRlJFU05FTA0KCWZsb2F0IG9wYWNpdHlGcmVzbmVsVGVybSA9IGNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVywgbm9ybWFsVywgb3BhY2l0eVBhcnRzLnosIG9wYWNpdHlQYXJ0cy53KTsNCg0KCWFscGhhICs9IG9wYWNpdHlQYXJ0cy54ICogKDEuMCAtIG9wYWNpdHlGcmVzbmVsVGVybSkgKyBvcGFjaXR5RnJlc25lbFRlcm0gKiBvcGFjaXR5UGFydHMueTsNCiNlbmRpZg0KDQoJLy8gRW1pc3NpdmUNCgl2ZWMzIGVtaXNzaXZlQ29sb3IgPSB2RW1pc3NpdmVDb2xvcjsNCiNpZmRlZiBFTUlTU0lWRQ0KCWVtaXNzaXZlQ29sb3IgKz0gdGV4dHVyZTJEKGVtaXNzaXZlU2FtcGxlciwgdkVtaXNzaXZlVVYgKyB1dk9mZnNldCkucmdiICogdkVtaXNzaXZlSW5mb3MueTsNCiNlbmRpZg0KDQojaWZkZWYgRU1JU1NJVkVGUkVTTkVMDQoJZmxvYXQgZW1pc3NpdmVGcmVzbmVsVGVybSA9IGNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVywgbm9ybWFsVywgZW1pc3NpdmVSaWdodENvbG9yLmEsIGVtaXNzaXZlTGVmdENvbG9yLmEpOw0KDQoJZW1pc3NpdmVDb2xvciAqPSBlbWlzc2l2ZUxlZnRDb2xvci5yZ2IgKiAoMS4wIC0gZW1pc3NpdmVGcmVzbmVsVGVybSkgKyBlbWlzc2l2ZUZyZXNuZWxUZXJtICogZW1pc3NpdmVSaWdodENvbG9yLnJnYjsNCiNlbmRpZg0KDQoJLy8gRnJlc25lbA0KI2lmZGVmIERJRkZVU0VGUkVTTkVMDQoJZmxvYXQgZGlmZnVzZUZyZXNuZWxUZXJtID0gY29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLCBub3JtYWxXLCBkaWZmdXNlUmlnaHRDb2xvci5hLCBkaWZmdXNlTGVmdENvbG9yLmEpOw0KDQoJZGlmZnVzZUJhc2UgKj0gZGlmZnVzZUxlZnRDb2xvci5yZ2IgKiAoMS4wIC0gZGlmZnVzZUZyZXNuZWxUZXJtKSArIGRpZmZ1c2VGcmVzbmVsVGVybSAqIGRpZmZ1c2VSaWdodENvbG9yLnJnYjsNCiNlbmRpZg0KDQoJLy8gQ29tcG9zaXRpb24NCiNpZmRlZiBFTUlTU0lWRUFTSUxMVU1JTkFUSU9ODQoJdmVjMyBmaW5hbERpZmZ1c2UgPSBjbGFtcChkaWZmdXNlQmFzZSAqIGRpZmZ1c2VDb2xvciArIHZBbWJpZW50Q29sb3IsIDAuMCwgMS4wKSAqIGJhc2VDb2xvci5yZ2I7DQojZWxzZQ0KI2lmZGVmIExJTktFTUlTU0lWRVdJVEhESUZGVVNFDQoJdmVjMyBmaW5hbERpZmZ1c2UgPSBjbGFtcCgoZGlmZnVzZUJhc2UgKyBlbWlzc2l2ZUNvbG9yKSAqIGRpZmZ1c2VDb2xvciArIHZBbWJpZW50Q29sb3IsIDAuMCwgMS4wKSAqIGJhc2VDb2xvci5yZ2I7DQojZWxzZQ0KCXZlYzMgZmluYWxEaWZmdXNlID0gY2xhbXAoZGlmZnVzZUJhc2UgKiBkaWZmdXNlQ29sb3IgKyBlbWlzc2l2ZUNvbG9yICsgdkFtYmllbnRDb2xvciwgMC4wLCAxLjApICogYmFzZUNvbG9yLnJnYjsNCiNlbmRpZg0KI2VuZGlmDQoNCiNpZmRlZiBTUEVDVUxBUlRFUk0NCgl2ZWMzIGZpbmFsU3BlY3VsYXIgPSBzcGVjdWxhckJhc2UgKiBzcGVjdWxhckNvbG9yOw0KCSNpZmRlZiBTUEVDVUxBUk9WRVJBTFBIQQ0KCQlhbHBoYSA9IGNsYW1wKGFscGhhICsgZG90KGZpbmFsU3BlY3VsYXIsIHZlYzMoMC4zLCAwLjU5LCAwLjExKSksIDAuLCAxLik7DQoJI2VuZGlmDQojZWxzZQ0KCXZlYzMgZmluYWxTcGVjdWxhciA9IHZlYzMoMC4wKTsNCiNlbmRpZg0KDQojaWZkZWYgUkVGTEVDVElPTk9WRVJBTFBIQQ0KCWFscGhhID0gY2xhbXAoYWxwaGEgKyBkb3QocmVmbGVjdGlvbkNvbG9yLCB2ZWMzKDAuMywgMC41OSwgMC4xMSkpLCAwLiwgMS4pOw0KI2VuZGlmDQoNCgkvLyBDb21wb3NpdGlvbg0KI2lmZGVmIEVNSVNTSVZFQVNJTExVTUlOQVRJT04NCgl2ZWM0IGNvbG9yID0gdmVjNChjbGFtcChmaW5hbERpZmZ1c2UgKiBiYXNlQW1iaWVudENvbG9yICsgZmluYWxTcGVjdWxhciArIHJlZmxlY3Rpb25Db2xvciArIGVtaXNzaXZlQ29sb3IgKyByZWZyYWN0aW9uQ29sb3IsIDAuMCwgMS4wKSwgYWxwaGEpOw0KI2Vsc2UNCgl2ZWM0IGNvbG9yID0gdmVjNChmaW5hbERpZmZ1c2UgKiBiYXNlQW1iaWVudENvbG9yICsgZmluYWxTcGVjdWxhciArIHJlZmxlY3Rpb25Db2xvciArIHJlZnJhY3Rpb25Db2xvciwgYWxwaGEpOw0KI2VuZGlmDQoNCi8vT2xkIGxpZ2h0bWFwIGNhbGN1bGF0aW9uIG1ldGhvZA0KI2lmZGVmIExJR0hUTUFQDQogICAgI2lmbmRlZiBMSUdIVE1BUEVYQ0xVREVEDQogICAgICAgICNpZmRlZiBVU0VMSUdIVE1BUEFTU0hBRE9XTUFQDQogICAgICAgICAgICBjb2xvci5yZ2IgKj0gbGlnaHRtYXBDb2xvcjsNCiAgICAgICAgI2Vsc2UNCiAgICAgICAgICAgIGNvbG9yLnJnYiArPSBsaWdodG1hcENvbG9yOw0KICAgICAgICAjZW5kaWYNCiAgICAjZW5kaWYNCiNlbmRpZg0KDQojaW5jbHVkZTxsb2dEZXB0aEZyYWdtZW50Pg0KI2luY2x1ZGU8Zm9nRnJhZ21lbnQ+DQoNCi8vIEFwcGx5IGltYWdlIHByb2Nlc3NpbmcgaWYgcmVsZXZhbnQuIEFzIHRoaXMgYXBwbGllcyBpbiBsaW5lYXIgc3BhY2UsIA0KLy8gV2UgZmlyc3QgbW92ZSBmcm9tIGdhbW1hIHRvIGxpbmVhci4NCiNpZmRlZiBJTUFHRVBST0NFU1NJTkdQT1NUUFJPQ0VTUw0KCWNvbG9yLnJnYiA9IHRvTGluZWFyU3BhY2UoY29sb3IucmdiKTsNCiNlbHNlDQoJI2lmZGVmIElNQUdFUFJPQ0VTU0lORw0KCQljb2xvci5yZ2IgPSB0b0xpbmVhclNwYWNlKGNvbG9yLnJnYik7DQoJCWNvbG9yID0gYXBwbHlJbWFnZVByb2Nlc3NpbmcoY29sb3IpOw0KCSNlbmRpZg0KI2VuZGlmDQoNCglnbF9GcmFnQ29sb3IgPSBjb2xvcjsNCn0=")
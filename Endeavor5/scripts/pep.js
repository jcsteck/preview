/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):n.PointerEventsPolyfill=t()})(this,function(){"use strict";function f(n,t){var i,r,u,f;for(t=t||Object.create(null),i=document.createEvent("Event"),i.initEvent(n,t.bubbles||!1,t.cancelable||!1),r=2;r<w.length;r++)u=w[r],i[u]=t[u]||lt[r];return i.buttons=t.buttons||0,f=0,f=t.pressure&&i.buttons?t.pressure:i.buttons?.5:0,i.x=i.clientX,i.y=i.clientY,i.pointerId=t.pointerId||0,i.width=t.width||0,i.height=t.height||0,i.pressure=f,i.tiltX=t.tiltX||0,i.tiltY=t.tiltY||0,i.twist=t.twist||0,i.tangentialPressure=t.tangentialPressure||0,i.pointerType=t.pointerType||"",i.hwTimestamp=t.hwTimestamp||0,i.isPrimary=t.isPrimary||!1,i}function k(){this.array=[];this.size=0}function c(n,t,i,r){this.addCallback=n.bind(r);this.removeCallback=t.bind(r);this.changedCallback=i.bind(r);g&&(this.observer=new g(this.mutationWatcher.bind(this)))}function nt(n){return"body /shadow-deep/ "+l(n)}function l(n){return'[touch-action="'+n+'"]'}function s(n){return"{ -ms-touch-action: "+n+"; touch-action: "+n+"; }"}function ri(){if(ii){ti.forEach(function(n){String(n)===n?(e+=l(n)+s(n)+"\n",tt&&(e+=nt(n)+s(n)+"\n")):(e+=n.selectors.map(l)+s(n.rule)+"\n",tt&&(e+=n.selectors.map(nt)+s(n.rule)+"\n"))});var n=document.createElement("style");n.textContent=e;document.head.appendChild(n)}}function ci(){if(!window.PointerEvent){if(window.PointerEvent=f,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0});n.registerSource("ms",hi)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),n.registerSource("mouse",rt),window.ontouchstart!==undefined&&n.registerSource("touch",o);n.register(document)}}function h(t){if(!n.pointermap.has(t)){var i=new Error("InvalidPointerId");i.name="InvalidPointerId";throw i;}}function ht(n){for(var t=n.parentNode,i;t&&t!==n.ownerDocument;)t=t.parentNode;if(!t){i=new Error("InvalidStateError");i.name="InvalidStateError";throw i;}}function ct(t){var i=n.pointermap.get(t);return i.buttons!==0}function li(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:y},releasePointerCapture:{value:p},hasPointerCapture:{value:st}})}var w=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],lt=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],at=window.Map&&window.Map.prototype.forEach,b=at?Map:k,ot,y,p,st;k.prototype={set:function(n,t){if(t===undefined)return this.delete(n);this.has(n)||this.size++;this.array[n]=t},has:function(n){return this.array[n]!==undefined},"delete":function(n){this.has(n)&&(delete this.array[n],this.size--)},get:function(n){return this.array[n]},clear:function(){this.array.length=0;this.size=0},forEach:function(n,t){return this.array.forEach(function(i,r){n.call(t,i,r,this)},this)}};var d=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],vt=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],yt={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},pt=typeof SVGElementInstance!="undefined",n={pointermap:new b,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(n,t){var i=t,r=i.events;r&&(r.forEach(function(n){i[n]&&(this.eventMap[n]=i[n].bind(i))},this),this.eventSources[n]=i,this.eventSourceList.push(i))},register:function(n){for(var r=this.eventSourceList.length,t=0,i;t<r&&(i=this.eventSourceList[t]);t++)i.register.call(i,n)},unregister:function(n){for(var r=this.eventSourceList.length,t=0,i;t<r&&(i=this.eventSourceList[t]);t++)i.unregister.call(i,n)},contains:function(n,t){try{return n.contains(t)}catch(i){return!1}},down:function(n){n.bubbles=!0;this.fireEvent("pointerdown",n)},move:function(n){n.bubbles=!0;this.fireEvent("pointermove",n)},up:function(n){n.bubbles=!0;this.fireEvent("pointerup",n)},enter:function(n){n.bubbles=!1;this.fireEvent("pointerenter",n)},leave:function(n){n.bubbles=!1;this.fireEvent("pointerleave",n)},over:function(n){n.bubbles=!0;this.fireEvent("pointerover",n)},out:function(n){n.bubbles=!0;this.fireEvent("pointerout",n)},cancel:function(n){n.bubbles=!0;this.fireEvent("pointercancel",n)},leaveOut:function(n){this.out(n);this.propagate(n,this.leave,!1)},enterOver:function(n){this.over(n);this.propagate(n,this.enter,!0)},eventHandler:function(n){if(!n._handledByPE){var i=n.type,t=this.eventMap&&this.eventMap[i];t&&t(n);n._handledByPE=!0}},listen:function(n,t){t.forEach(function(t){this.addEvent(n,t)},this)},unlisten:function(n,t){t.forEach(function(t){this.removeEvent(n,t)},this)},addEvent:function(n,t){n.addEventListener(t,this.boundHandler)},removeEvent:function(n,t){n.removeEventListener(t,this.boundHandler)},makeEvent:function(n,t){this.captureInfo[t.pointerId]&&(t.relatedTarget=null);var i=new f(n,t);return t.preventDefault&&(i.preventDefault=t.preventDefault),i._target=i._target||t.target,i},fireEvent:function(n,t){var i=this.makeEvent(n,t);return this.dispatchEvent(i)},cloneEvent:function(n){for(var i=Object.create(null),t,r=0;r<d.length;r++)t=d[r],i[t]=n[t]||vt[r],pt&&(t==="target"||t==="relatedTarget")&&i[t]instanceof SVGElementInstance&&(i[t]=i[t].correspondingUseElement);return n.preventDefault&&(i.preventDefault=function(){n.preventDefault()}),i},getTarget:function(n){var t=this.captureInfo[n.pointerId];return t?n._target===t||!(n.type in yt)?t:void 0:n._target},propagate:function(n,t,i){for(var r=n.target,u=[];r!==document&&!r.contains(n.relatedTarget);)if(u.push(r),r=r.parentNode,!r)return;i&&u.reverse();u.forEach(function(i){n.target=i;t.call(this,n)},this)},setCapture:function(n,t,i){this.captureInfo[n]&&this.releaseCapture(n,i);this.captureInfo[n]=t;this.implicitRelease=this.releaseCapture.bind(this,n,i);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var r=new f("gotpointercapture");r.pointerId=n;r._target=t;i||this.asyncDispatchEvent(r)},releaseCapture:function(n,t){var r=this.captureInfo[n],i;r&&(this.captureInfo[n]=undefined,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),i=new f("lostpointercapture"),i.pointerId=n,i._target=r,t||this.asyncDispatchEvent(i))},dispatchEvent:function(n){var t=this.getTarget(n);if(t)return t.dispatchEvent(n)},asyncDispatchEvent:function(n){requestAnimationFrame(this.dispatchEvent.bind(this,n))}};n.boundHandler=n.eventHandler.bind(n);var r={shadow:function(n){if(n)return n.shadowRoot||n.webkitShadowRoot},canTarget:function(n){return n&&Boolean(n.elementFromPoint)},targetingShadow:function(n){var t=this.shadow(n);if(this.canTarget(t))return t},olderShadow:function(n){var t=n.olderShadowRoot,i;return t||(i=n.querySelector("shadow"),i&&(t=i.olderShadowRoot)),t},allShadows:function(n){for(var i=[],t=this.shadow(n);t;)i.push(t),t=this.olderShadow(t);return i},searchRoot:function(n,t,i){var f,u,r,e;if(n){for(f=n.elementFromPoint(t,i),r=this.targetingShadow(f);r;){if(u=r.elementFromPoint(t,i),u)return e=this.targetingShadow(u),this.searchRoot(e,t,i)||u;r=this.olderShadow(r)}return f}},owner:function(n){for(var t=n;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(n){var i=n.clientX,r=n.clientY,t=this.owner(n.target);return t.elementFromPoint(i,r)||(t=document),this.searchRoot(t,i,r)}},wt=Array.prototype.forEach.call.bind(Array.prototype.forEach),bt=Array.prototype.map.call.bind(Array.prototype.map),kt=Array.prototype.slice.call.bind(Array.prototype.slice),dt=Array.prototype.filter.call.bind(Array.prototype.filter),g=window.MutationObserver||window.WebKitMutationObserver,gt="[touch-action]",ni={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(n){this.observer&&r.canTarget(n)&&this.observer.observe(n,ni)},enableOnSubtree:function(n){this.watchSubtree(n);n===document&&document.readyState!=="complete"?this.installOnLoad():this.installNewSubtree(n)},installNewSubtree:function(n){wt(this.findElements(n),this.addElement,this)},findElements:function(n){return n.querySelectorAll?n.querySelectorAll(gt):[]},removeElement:function(n){this.removeCallback(n)},addElement:function(n){this.addCallback(n)},elementChanged:function(n,t){this.changedCallback(n,t)},concatLists:function(n,t){return n.concat(kt(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){document.readyState==="complete"&&this.installNewSubtree(document)}.bind(this))},isElement:function(n){return n.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(n){var t=bt(n,this.findElements,this);return t.push(dt(n,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(n){n.forEach(this.mutationHandler,this)},mutationHandler:function(n){var t,i;n.type==="childList"?(t=this.flattenMutationTree(n.addedNodes),t.forEach(this.addElement,this),i=this.flattenMutationTree(n.removedNodes),i.forEach(this.removeElement,this)):n.type==="attributes"&&this.elementChanged(n.target,n.oldValue)}};var ti=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],e="",ii=window.PointerEvent||window.MSPointerEvent,tt=!window.ShadowDOMPolyfill&&document.head.createShadowRoot;var t=n.pointermap,it=25,a=[1,4,2,8,16],u=!1;try{u=new MouseEvent("test",{buttons:1}).buttons===1}catch(ai){}var rt={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){n.listen(t,this.events)},unregister:function(t){n.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(n){for(var u,f,r=this.lastTouches,e=n.clientX,o=n.clientY,t=0,s=r.length,i;t<s&&(i=r[t]);t++)if(u=Math.abs(e-i.x),f=Math.abs(o-i.y),u<=it&&f<=it)return!0},prepareEvent:function(t){var i=n.cloneEvent(t),r=i.preventDefault;return i.preventDefault=function(){t.preventDefault();r()},i.pointerId=this.POINTER_ID,i.isPrimary=!0,i.pointerType=this.POINTER_TYPE,i},prepareButtonsForMove:function(n,i){var r=t.get(this.POINTER_ID);n.buttons=i.which!==0&&r?r.buttons:0;i.buttons=n.buttons},mousedown:function(i){if(!this.isEventSimulatedFromTouch(i)){var f=t.get(this.POINTER_ID),r=this.prepareEvent(i);u||(r.buttons=a[r.button],f&&(r.buttons|=f.buttons),i.buttons=r.buttons);t.set(this.POINTER_ID,i);f&&f.buttons!==0?n.move(r):n.down(r)}},mousemove:function(i){if(!this.isEventSimulatedFromTouch(i)){var r=this.prepareEvent(i);u||this.prepareButtonsForMove(r,i);r.button=-1;t.set(this.POINTER_ID,i);n.move(r)}},mouseup:function(i){var f,r,e;this.isEventSimulatedFromTouch(i)||(f=t.get(this.POINTER_ID),r=this.prepareEvent(i),u||(e=a[r.button],r.buttons=f?f.buttons&~e:0,i.buttons=r.buttons),t.set(this.POINTER_ID,i),r.buttons&=~a[r.button],r.buttons===0?n.up(r):n.move(r))},mouseover:function(i){if(!this.isEventSimulatedFromTouch(i)){var r=this.prepareEvent(i);u||this.prepareButtonsForMove(r,i);r.button=-1;t.set(this.POINTER_ID,i);n.enterOver(r)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var i=this.prepareEvent(t);u||this.prepareButtonsForMove(i,t);i.button=-1;n.leaveOut(i)}},cancel:function(t){var i=this.prepareEvent(t);n.cancel(i);this.deactivateMouse()},deactivateMouse:function(){t.delete(this.POINTER_ID)}},ui=n.captureInfo,fi=r.findTarget.bind(r),v=r.allShadows.bind(r),i=n.pointermap,ei=2500,oi=200,ut="touch-action",ft,o={events:["touchstart","touchmove","touchend","touchcancel"],register:function(n){ft.enableOnSubtree(n)},unregister:function(){},elementAdded:function(t){var r=t.getAttribute(ut),i=this.touchActionToScrollType(r);i&&(t._scrollType=i,n.listen(t,this.events),v(t).forEach(function(t){t._scrollType=i;n.listen(t,this.events)},this))},elementRemoved:function(t){t._scrollType=undefined;n.unlisten(t,this.events);v(t).forEach(function(t){t._scrollType=undefined;n.unlisten(t,this.events)},this)},elementChanged:function(n,t){var u=n.getAttribute(ut),i=this.touchActionToScrollType(u),r=this.touchActionToScrollType(t);i&&r?(n._scrollType=i,v(n).forEach(function(n){n._scrollType=i},this)):r?this.elementRemoved(n):i&&this.elementAdded(n)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(n){var t=n,i=this.scrollTypes;return t==="none"?"none":t===i.XSCROLLER?"X":t===i.YSCROLLER?"Y":i.SCROLLER.exec(t)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(n){return this.firstTouch===n.identifier},setPrimaryTouch:function(n){(i.size===0||i.size===1&&i.has(1))&&(this.firstTouch=n.identifier,this.firstXY={X:n.clientX,Y:n.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(n){n.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var n=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(n,oi)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(n){var t=0;return(n==="touchstart"||n==="touchmove")&&(t=1),t},touchToPointer:function(t){var r=this.currentTouchEvent,i=n.cloneEvent(t),f=i.pointerId=t.identifier+2,u;return i.target=ui[f]||fi(i),i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount,i.button=0,i.buttons=this.typeToButtons(r.type),i.width=(t.radiusX||t.webkitRadiusX||0)*2,i.height=(t.radiusY||t.webkitRadiusY||0)*2,i.pressure=t.force||t.webkitForce||.5,i.isPrimary=this.isPrimaryTouch(t),i.pointerType=this.POINTER_TYPE,i.altKey=r.altKey,i.ctrlKey=r.ctrlKey,i.metaKey=r.metaKey,i.shiftKey=r.shiftKey,u=this,i.preventDefault=function(){u.scrolling=!1;u.firstXY=null;r.preventDefault()},i},processTouches:function(n,t){var r=n.changedTouches,i,u;for(this.currentTouchEvent=n,i=0;i<r.length;i++)u=r[i],t.call(this,this.touchToPointer(u))},shouldScroll:function(n){var i,t;if(this.firstXY){if(t=n.currentTarget._scrollType,t==="none")i=!1;else if(t==="XY")i=!0;else{var r=n.changedTouches[0],u=t,f=t==="Y"?"X":"Y",e=Math.abs(r["client"+u]-this.firstXY[u]),o=Math.abs(r["client"+f]-this.firstXY[f]);i=e>=o}return this.firstXY=null,i}},findTouch:function(n,t){for(var i=0,u=n.length,r;i<u&&(r=n[i]);i++)if(r.identifier===t)return!0},vacuumTouches:function(n){var r=n.touches,t;i.size>=r.length&&(t=[],i.forEach(function(n,i){if(i!==1&&!this.findTouch(r,i-2)){var u=n.out;t.push(u)}},this),t.forEach(this.cancelOut,this))},touchstart:function(n){this.vacuumTouches(n);this.setPrimaryTouch(n.changedTouches[0]);this.dedupSynthMouse(n);this.scrolling||(this.clickCount++,this.processTouches(n,this.overDown))},overDown:function(t){i.set(t.pointerId,{target:t.target,out:t,outTarget:t.target});n.enterOver(t);n.down(t)},touchmove:function(n){this.scrolling||(this.shouldScroll(n)?(this.scrolling=!0,this.touchcancel(n)):(n.preventDefault(),this.processTouches(n,this.moveOverOut)))},moveOverOut:function(t){var r=t,u=i.get(r.pointerId),f,e;u&&(f=u.out,e=u.outTarget,n.move(r),f&&e!==r.target&&(f.relatedTarget=r.target,r.relatedTarget=e,f.target=e,r.target?(n.leaveOut(f),n.enterOver(r)):(r.target=e,r.relatedTarget=null,this.cancelOut(r))),u.out=r,u.outTarget=r.target)},touchend:function(n){this.dedupSynthMouse(n);this.processTouches(n,this.upOut)},upOut:function(t){this.scrolling||(n.up(t),n.leaveOut(t));this.cleanUpPointer(t)},touchcancel:function(n){this.processTouches(n,this.cancelOut)},cancelOut:function(t){n.cancel(t);n.leaveOut(t);this.cleanUpPointer(t)},cleanUpPointer:function(n){i.delete(n.pointerId);this.removePrimaryPointer(n)},dedupSynthMouse:function(n){var r=rt.lastTouches,t=n.changedTouches[0],i,u;this.isPrimaryTouch(t)&&(i={x:t.clientX,y:t.clientY},r.push(i),u=function(n,t){var i=n.indexOf(t);i>-1&&n.splice(i,1)}.bind(null,r,i),setTimeout(u,ei))}};ft=new c(o.elementAdded,o.elementRemoved,o.elementChanged,o);var et=n.pointermap,si=window.MSPointerEvent&&typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE=="number",hi={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){n.listen(t,this.events)},unregister:function(t){n.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var i=t;return si&&(i=n.cloneEvent(t),i.pointerType=this.POINTER_TYPES[t.pointerType]),i},cleanup:function(n){et.delete(n)},MSPointerDown:function(t){et.set(t.pointerId,t);var i=this.prepareEvent(t);n.down(i)},MSPointerMove:function(t){var i=this.prepareEvent(t);n.move(i)},MSPointerUp:function(t){var i=this.prepareEvent(t);n.up(i);this.cleanup(t.pointerId)},MSPointerOut:function(t){var i=this.prepareEvent(t);n.leaveOut(i)},MSPointerOver:function(t){var i=this.prepareEvent(t);n.enterOver(i)},MSPointerCancel:function(t){var i=this.prepareEvent(t);n.cancel(i);this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var i=n.makeEvent("lostpointercapture",t);n.dispatchEvent(i)},MSGotPointerCapture:function(t){var i=n.makeEvent("gotpointercapture",t);n.dispatchEvent(i)}};return ot=window.navigator,ot.msPointerEnabled?(y=function(t){h(t);ht(this);ct(t)&&(n.setCapture(t,this,!0),this.msSetPointerCapture(t))},p=function(t){h(t);n.releaseCapture(t,!0);this.msReleasePointerCapture(t)}):(y=function(t){h(t);ht(this);ct(t)&&n.setCapture(t,this)},p=function(t){h(t);n.releaseCapture(t)}),st=function(t){return!!n.captureInfo[t]},ri(),ci(),li(),{dispatcher:n,Installer:c,PointerEvent:f,PointerMap:b,targetFinding:r}})